"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5307],{35307:(V,y,p)=>{p.r(y),p.d(y,{ProductFormModule:()=>so});var _=p(86019),x=p(4205),v=p(64762),b=p(82997),Z=p(50858),P=p(14246),t=p(83668),l=p(49133),g=p(85993),A=p(23449);let Y=(()=>{class o{constructor(e,i,n){this.fb=e,this.modal=i,this.globalFun=n,this.benefiArray=[],this.oldData={},this.stage=!1}ngOnInit(){}ngOnDestroy(){}save(){if(!this.dynForm.handleSubmit())return!1}saveTemp(e){return(0,v.mG)(this,void 0,void 0,function*(){let i=this.activateForm;if(i.function){let n=Object.assign(Object.assign({},e),{refId:this.oldData.refId||0});console.log(this.benefiArray);let a=this.benefiArray.length>0?this.benefiArray:this.globalFun.tempFormData[i.tableName+i.id];(yield this.globalFun[i.function]("",n,a,!0))&&this.modal.dismiss({data:e,type:"save"})}else this.modal.dismiss({data:e,type:"save"})})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(l.qu),t.Y36(g.Kz),t.Y36(A.Q))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-form-view-modal"]],viewQuery:function(e,i){if(1&e&&t.Gf(P.r,5),2&e){let n;t.iGM(n=t.CRH())&&(i.dynForm=n.first)}},decls:12,vars:4,consts:[[1,"modal-content"],[1,"modal-header"],["id","example-modal-sizes-title-lg",1,"modal-title","h4","left-border-image"],[1,"overlay","overlay-block","cursor-default","modal-body"],[3,"config","tempData","editStage","submit"],["dynForm",""],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-2",3,"click"],["type","submit",1,"btn","btn-primary","btn-elevate",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.qZA(),t.TgZ(4,"div",3),t.TgZ(5,"dynamic-form",4,5),t.NdJ("submit",function(a){return i.saveTemp(a)}),t.qZA(),t.qZA(),t.TgZ(7,"div",6),t.TgZ(8,"button",7),t.NdJ("click",function(){return i.modal.dismiss()}),t._uU(9,"Cancel"),t.qZA(),t.TgZ(10,"button",8),t.NdJ("click",function(){return i.save()}),t._uU(11,"Save"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(3),t.hij(" ",i.pageName," "),t.xp6(2),t.Q6J("config",i.controls)("tempData",i.oldData)("editStage",i.stage))},directives:[P.r],styles:[".active[_ngcontent-%COMP%]{background-color:#3699ff!important;color:#fff}"]}),o})();var I=p(1402),k=p(47975),Ft=p(87952),T=p(11766),C=p(6920),L=p(43329),M=p(35618),j=p(552),gt=p(60807),$=p(57842);function kt(o,c){1&o&&(t.TgZ(0,"th"),t._uU(1," Option "),t.qZA())}function St(o,c){1&o&&(t.TgZ(0,"th"),t._uU(1," Sum Insured "),t.qZA())}function Nt(o,c){1&o&&(t.TgZ(0,"th"),t._uU(1," Unit "),t.qZA())}function Ut(o,c){1&o&&(t.TgZ(0,"th"),t._uU(1," Premium "),t.qZA())}function zt(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"td"),t.TgZ(2,"input",8),t.NdJ("ngModelChange",function(n){t.CHM(e);const a=t.oxw(2).$implicit;return t.oxw(2).addOnsData[a.id].checked=n})("change",function(){t.CHM(e);const n=t.oxw(2).$implicit;return t.oxw(2).changeOption(n)}),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(2).$implicit,i=t.oxw(2);t.xp6(2),t.Q6J("ngModel",i.addOnsData[e.id].checked)}}function Rt(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"ng-select",10),t.NdJ("change",function(){t.CHM(e);const n=t.oxw(4).$implicit;return t.oxw(2).rechangeOption(n)})("ngModelChange",function(n){t.CHM(e);const a=t.oxw(4).$implicit;return t.oxw(2).addOnsData[a.id].option=n}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(4).$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("items",i.fireOptionData[e.code])("ngModel",i.addOnsData[e.id].option)("clearable",!1)}}function Jt(o,c){if(1&o&&(t.TgZ(0,"td",2),t.YNc(1,Rt,2,3,"ng-container",3),t.qZA()),2&o){const e=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngIf","BURGLARY"==e.code||"STHTC"==e.code)}}function Et(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",11),t.NdJ("ngModelChange",function(n){t.CHM(e);const a=t.oxw(4).$implicit;return t.oxw(2).addOnsData[a.id].sum=n}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(4).$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("disabled",!i.addOnsData[e.id].checked)("ngModel",i.addOnsData[e.id].sum)}}function Bt(o,c){if(1&o&&(t.ynx(0),t._uU(1),t.ALo(2,"number"),t.BQk()),2&o){const e=t.oxw(4).$implicit,i=t.oxw(2);t.xp6(1),t.hij(" ",i.addOnsData[e.id].sum>0?t.lcZ(2,1,i.addOnsData[e.id].sum):i.addOnsData[e.id].sum," ")}}function Qt(o,c){if(1&o&&(t.TgZ(0,"td"),t.YNc(1,Et,2,2,"ng-container",3),t.YNc(2,Bt,3,3,"ng-container",3),t.qZA()),2&o){const e=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngIf",!e.sumInsuredStr),t.xp6(1),t.Q6J("ngIf",e.sumInsuredStr)}}function Vt(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",11),t.NdJ("ngModelChange",function(n){t.CHM(e);const a=t.oxw(4).$implicit;return t.oxw(2).addOnsData[a.id].unit=n}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(4).$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("disabled",!i.addOnsData[e.id].checked)("ngModel",i.addOnsData[e.id].unit)}}function Yt(o,c){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=t.oxw(4).$implicit,i=t.oxw(2);t.xp6(1),t.hij(" ",i.addOnsData[e.id].unit," ")}}function Lt(o,c){if(1&o&&(t.TgZ(0,"td"),t.YNc(1,Vt,2,2,"ng-container",3),t.YNc(2,Yt,2,1,"ng-container",3),t.qZA()),2&o){const e=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngIf",!e.unitStr),t.xp6(1),t.Q6J("ngIf",e.unitStr)}}function jt(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",11),t.NdJ("ngModelChange",function(n){t.CHM(e);const a=t.oxw(4).$implicit;return t.oxw(2).addOnsData[a.id].premium=n}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(4).$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("disabled",!i.addOnsData[e.id].checked)("ngModel",i.addOnsData[e.id].premium)}}function Ht(o,c){if(1&o&&(t.ynx(0),t._uU(1),t.ALo(2,"number"),t.BQk()),2&o){const e=t.oxw(4).$implicit,i=t.oxw(2);t.xp6(1),t.hij(" ",i.addOnsData[e.id].premium>0?t.lcZ(2,1,i.addOnsData[e.id].premium):i.addOnsData[e.id].premium," ")}}function Gt(o,c){if(1&o&&(t.TgZ(0,"td"),t.YNc(1,jt,2,2,"ng-container",3),t.YNc(2,Ht,3,3,"ng-container",3),t.qZA()),2&o){const e=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngIf",!e.premiumStr),t.xp6(1),t.Q6J("ngIf",e.premiumStr)}}function $t(o,c){if(1&o&&(t.ynx(0),t.YNc(1,Jt,2,1,"td",9),t.YNc(2,Qt,3,2,"td",3),t.YNc(3,Lt,3,2,"td",3),t.YNc(4,Gt,3,2,"td",3),t.BQk()),2&o){const e=t.oxw(2).$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("ngIf","CLFR01"==i.product.code),t.xp6(1),t.Q6J("ngIf",e.sumInsured),t.xp6(1),t.Q6J("ngIf",e.unit),t.xp6(1),t.Q6J("ngIf",e.premium)}}function Wt(o,c){if(1&o&&(t.TgZ(0,"tr"),t.YNc(1,zt,3,1,"ng-container",3),t.TgZ(2,"td",2),t._uU(3),t.qZA(),t.YNc(4,$t,5,4,"ng-container",3),t.qZA()),2&o){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",i.addOnsData[e.id]),t.xp6(2),t.Oqu(e.description),t.xp6(1),t.Q6J("ngIf",i.addOnsData[e.id])}}function Kt(o,c){if(1&o&&(t.ynx(0),t.YNc(1,Wt,5,3,"tr",3),t.BQk()),2&o){const e=c.$implicit;t.xp6(1),t.Q6J("ngIf",e.show)}}function Xt(o,c){if(1&o&&(t.TgZ(0,"tbody",1),t.YNc(1,Kt,2,1,"ng-container",7),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.product.addOns)}}function te(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",12),t.TgZ(1,"div",13),t.TgZ(2,"button",14),t.NdJ("click",function(){return t.CHM(e),t.oxw().backPage()}),t._uU(3," Previous "),t.qZA(),t.qZA(),t.TgZ(4,"div",13),t.TgZ(5,"button",15),t.NdJ("click",function(){return t.CHM(e),t.oxw().nextPage()}),t._uU(6," Save & Next "),t.qZA(),t.qZA(),t.qZA()}}function ee(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",16),t.TgZ(1,"button",17),t.NdJ("click",function(){return t.CHM(e),t.oxw().nextPage()}),t._uU(2," Save "),t.qZA(),t.qZA()}}let mt=(()=>{class o{constructor(e,i,n,a,r,s,d){this.addOnQuoService=e,this.globalFun=i,this.cdRef=n,this.prodService=a,this.numberPipe=r,this.pageDataService=s,this.loadingService=d,this.actionEvent=new t.vpe,this.fireAdd=!1,this.addOns={isSum:!1,isUnit:!1,isPremium:!1},this.addOnsData={},this.unsubscribe=[],this.premiumAmt="",this.parentData={},this.isLoading=!0,this.fireAddonRate={FLOOD:.1,SUBLSLD:.1,"BURGLARY-T-C1":.25,"BURGLARY-T-C2":.5,"BURGLARY-T-C3":.75,"BURGLARY-T-C4":1,"STHTC-T-BFMGS":.2,"STHTC-T-002":.2,"STHTC-T-003":.2,"STHTC-T-004":.2,"STHTC-T-WDGS":.25,WARRISK:.1,ACD:.1,EXPLOSION:.1,IMPD:.1,RSMD:.06,SPONTCOMB:.08,EQ:.1,Fire:.1},this.addOnList=[],this.fireOptionData={STHTC:[{code:"T-BFMGS",value:"Building,Furniture,Machine,Goods/Stocks"},{code:"T-WDGS",value:"Water Damage for Goods/Stocks"}],BURGLARY:[{code:"T-C1",value:"Class 1"},{code:"T-C2",value:"Class 2"},{code:"T-C3",value:"Class 3"},{code:"T-C4",value:"Class 4"}]}}ngOnInit(){return(0,v.mG)(this,void 0,void 0,function*(){if(this.refID=this.prodService.referenceID,this.optionId=this.optionId?this.optionId:this.resourcesId,"PLMO02"==this.product.code&&(this.parentData=this.getParnet()),this.addOnList=this.product.addOns.filter(e=>"MED"!=e.code&&"CROSSBRDR"!=e.code),this.addOnList&&this.addOnList.length>0){yield this.loadingService.activate(),this.addOns={isSum:this.addOnList[0].sumInsured,isUnit:this.addOnList[0].unit,isPremium:this.addOnList[0].premium};let i={quotationNo:this.resourcesId,addOnIds:this.addOnList.map(a=>a.id),optionalKey:this.optionId},n=yield this.addOnQuoService.getAllById(i).toPromise();0==n.length&&(i.quotationNo=this.refID,i.optionalKey=this.refID,n=yield this.addOnQuoService.getAllById(i).toPromise());for(const a of this.addOnList){a.show=!0,a.validationFun&&(a.show=!this.globalFun[a.validationFun]||this.globalFun[a.validationFun](this.parentData)),"CLFR01"==this.product.code&&(a.sumInsuredStr="0",a.unitStr="0",a.premiumStr="0");let r=n.find(s=>s.addonId==a.id);this.addOnsData[a.id]={checked:!(!r||!a.show),sum:r&&r.sumInsured||0,unit:r&&r.unit||0,premium:r&&r.premium||0,option:r&&r.option||""},"STHTC"==a.code&&""==this.addOnsData[a.id].option?this.addOnsData[a.id].option="T-BFMGS":"BURGLARY"==a.code&&""==this.addOnsData[a.id].option&&(this.addOnsData[a.id].option="T-C1"),a.sumInsured&&this.getGlobalFun(a.sumInsuredStr,"addOnsData",a.id,"sum",a),a.unit&&this.getGlobalFun(a.unitStr,"addOnsData",a.id,"unit",a),a.premium&&("CROSSBRDR"==a.code&&this.addOnsData[a.id].checked||this.getGlobalFun(a.premiumStr,"addOnsData",a.id,"premium",a))}this.isLoading=!1,yield this.loadingService.deactivate(),this.cdRef.detectChanges()}else this.isLoading=!1})}getGlobalFun(e,i,n,a,r){if("PLMO02"==this.product.code&&"premium"==a)if(this.globalFun[e]){let s="PAIDDRIVER"==r.code?this.getParnet("motor_driver"):this.parentData,d=this.globalFun[e](s).subscribe(u=>{this[i][n][a]=u,this.cdRef.detectChanges()});this.unsubscribe.push(d)}else e&&(this[i][n][a]=e);else if("CLFR01"==this.product.code&&"premium"==a)this[i][n][a]=this.rateByValue(r);else if(this.globalFun[e+"Result"]){let s=this.globalFun[e+"Result"].subscribe(d=>{this[i][n][a]=d,this.cdRef.detectChanges()});this.unsubscribe.push(s)}else e&&(this[i][n][a]=e)}nextPage(){return(0,v.mG)(this,void 0,void 0,function*(){const e=this.addOnQuoService,i=this.addOnsData;yield e.deleteAll(this.resourcesId,this.optionId).toPromise(),"CLFR01"==this.product.code?this.globalFun.tempFormData["addon_1634010770155"+this.optionId]=[]:this.globalFun.tempFormData.addon_1634010770155=[];for(let n of this.addOnList)if(i[n.id].checked){let a=i[n.id].sum?i[n.id].sum+"":"",r=i[n.id].unit?i[n.id].unit+"":"",s=i[n.id].premium?i[n.id].premium+"":"",d=i[n.id].option?i[n.id].option+"":"";try{let u={addonId:n.id,quotationNo:this.resourcesId,option:d,optionalKey:this.optionId,sumInsured:a.replace(",","").replace("MMK","").replace("USD",""),unit:r.replace(",","").replace("MMK","").replace("USD",""),premium:s.replace(",","").replace("MMK","").replace("USD","")};"CLFR01"==this.product.code?this.globalFun.tempFormData["addon_1634010770155"+this.optionId].push(u):this.globalFun.tempFormData.addon_1634010770155.push(u),yield e.save(u).toPromise()}catch(u){}}"PLMO02"==this.product.code&&(yield this.savePremimun().toPromise()),this.actionEvent.emit({type:T.V.NEXT})})}backPage(){this.actionEvent.emit({type:T.V.PREV})}onCheckAddon(){}changeOption(e){if("CROSSBRDR"!=e.code&&"PLMO02"==this.product.code){let i=this.addOnList.find(n=>"CROSSBRDR"==n.code);if(this.addOnsData[i.id].checked){let n=this.calcuCross();this.addOnsData[i.id].premium=.15*n}}else if(this.addOnsData[e.id].checked&&"CROSSBRDR"==e.code){let i=this.calcuCross();this.addOnsData[e.id].premium=.15*i}else!this.addOnsData[e.id].checked&&"CROSSBRDR"==e.code&&(this.addOnsData[e.id].premium=0)}rechangeOption(e){this.addOnsData[e.id].premium=this.rateByValue(e)}calcuCross(){let e=0;for(let r of this.addOnList)this.addOnsData[r.id].checked&&"CROSSBRDR"!=r.code&&(e+=this.globalFun.calculateDecimal(this.addOnsData[r.id].premium||0));let i=this.globalFun.tempFormData.coverage_1634010995936?this.globalFun.tempFormData.coverage_1634010995936:[];for(let r of i)e+=this.globalFun.calculateDecimal(r.premium||0);let a=0;if(this.parentData){let r=this.parentData.m_excess;"T-NILEX"==r&&"MMK"==(this.parentData?this.parentData.m_currency:"MMK")?a=5e4:"TU-NILEX"==r&&(a=25)}return e+a}caluMotorPremimun(){let e=0;for(let d of this.addOnList)this.addOnsData[d.id].checked&&(e+=this.globalFun.calculateDecimal(this.addOnsData[d.id].premium||0));let i=this.globalFun.tempFormData.coverage_1634010995936?this.globalFun.tempFormData.coverage_1634010995936:[];for(let d of i)e+=this.globalFun.calculateDecimal(d.premium||0);let n=this.parentData?this.parentData.m_currency:"MMK",a=0;if(this.parentData){let d=this.parentData.m_excess,u=this.parentData.excess_discount;"T-NILEX"==d&&"MMK"==n?a=-5e4:"TU-NILEX"==d?a=-25:"T-ED"==d&&"MMK"==n&&("T-EXD1"==u?a=5e4:"T-EXD2"==u?a=7e4:"T-EXD3"==u&&(a=1e5))}let s=e-a+("MMK"==n?100:1);return this.premiumAmt=this.numberPipe.transform(s)+" "+n.toUpperCase(),this.globalFun.paPremiumResult.next(this.premiumAmt),s}caluFirePremimun(){let e=this.globalFun.tempFormData[C.nm],n="T-NM"==this.globalFun.tempFormData[C.T$].policyType?1:.75,a=0;for(let u of e)a+=this.globalFun.calculateDecimal(u.premium);const r=this.addOnsData;let s=0;for(let u of this.addOnList)r[u.id].checked&&(s+=this.globalFun.calculateDecimal(r[u.id].premium));let d=(a+s)*n;return this.premiumAmt=this.numberPipe.transform(d)+" MMK",this.globalFun.paPremiumResult.next(this.premiumAmt),d}savePremimun(){this.caluMotorPremimun();let i={premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,resourceId:this.resourcesId,type:this.prodService.viewType};return this.pageDataService.updatePremimun(i)}savePremimunFire(){this.caluFirePremimun();let i={premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,resourceId:this.resourcesId,type:this.prodService.viewType};return this.pageDataService.updatePremimun(i)}getParnet(e="m_detail"){if((0,k.cU)(this.product.config)){let i=JSON.parse(this.product.config),a=("quotation"!=this.prodService.type?i.application||[]:i.quotation||[]).find(r=>r.tableName==e);return a&&this.globalFun.tempFormData[a.tableName+a.id]||null}return null}rateByValue(e){let i=0;i="BURGLARY"==e.code||"STHTC"==e.code?this.fireAddonRate[e.code+"-"+this.addOnsData[e.id].option]||0:this.fireAddonRate[e.code]||0;let n=this.globalFun.tempFormData[C.nm],a=0;if(n){let r=n.find(s=>s.id==this.optionId);a+=r?r.riskSi:0}if(i>0&&a>0){let r=a*(i/100);return"BURGLARY"==e.code&&(r-=.1*r),r}return 0}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(L.D),t.Y36(A.Q),t.Y36(t.sBO),t.Y36(M.f),t.Y36(_.JJ),t.Y36(j.Q),t.Y36(gt.b))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-addon-page"]],inputs:{product:"product",editData:"editData",resourcesId:"resourcesId",optionId:"optionId",fireAdd:"fireAdd",premiumAmt:"premiumAmt"},outputs:{actionEvent:"actionEvent"},decls:14,vars:7,consts:[[1,"table","table-bordered"],[1,"tbody-align"],[2,"text-align","left"],[4,"ngIf"],["class","tbody-align",4,"ngIf"],["class","row",4,"ngIf"],["style","text-align: right;",4,"ngIf"],[4,"ngFor","ngForOf"],["type","checkbox",3,"ngModel","ngModelChange","change"],["style","text-align: left;",4,"ngIf"],["bindLabel","value","bindValue","code",1,"ng-custom-select",3,"items","ngModel","clearable","change","ngModelChange"],["type","text",1,"form-control","form-control-sm",3,"disabled","ngModel","ngModelChange"],[1,"row"],[1,"col-sm-6","mx-auto"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"],[2,"text-align","right"],[1,"btn","btn-primary",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"table",0),t.TgZ(1,"thead",1),t.TgZ(2,"tr"),t._UZ(3,"th"),t.TgZ(4,"th",2),t._uU(5," Base Coverage "),t.qZA(),t.YNc(6,kt,2,0,"th",3),t.YNc(7,St,2,0,"th",3),t.YNc(8,Nt,2,0,"th",3),t.YNc(9,Ut,2,0,"th",3),t.qZA(),t.qZA(),t.YNc(10,Xt,2,1,"tbody",4),t.qZA(),t._UZ(11,"hr"),t.YNc(12,te,7,0,"div",5),t.YNc(13,ee,3,0,"div",6)),2&e&&(t.xp6(6),t.Q6J("ngIf","CLFR01"==i.product.code),t.xp6(1),t.Q6J("ngIf",i.addOns.isSum),t.xp6(1),t.Q6J("ngIf",i.addOns.isUnit),t.xp6(1),t.Q6J("ngIf",i.addOns.isPremium),t.xp6(1),t.Q6J("ngIf",!i.isLoading),t.xp6(2),t.Q6J("ngIf",!i.fireAdd),t.xp6(1),t.Q6J("ngIf",i.fireAdd))},directives:[_.O5,_.sg,l.Wl,l.JJ,l.On,$.w9,l.Fj],pipes:[_.JJ],styles:[""]}),o})();var W=p(45570);function ie(o,c){1&o&&(t.TgZ(0,"th"),t._uU(1," Sum Insured "),t.qZA())}function ne(o,c){1&o&&(t.TgZ(0,"th"),t._uU(1," Unit "),t.qZA())}function oe(o,c){1&o&&(t.TgZ(0,"th"),t._uU(1," Premium "),t.qZA())}function ae(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",8),t.NdJ("ngModelChange",function(n){t.CHM(e);const a=t.oxw(4).$implicit;return t.oxw().coverageData[a.id].sum=n}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(4).$implicit,i=t.oxw();t.xp6(1),t.Q6J("ngModel",i.coverageData[e.id].sum)}}function re(o,c){if(1&o&&(t.ynx(0),t._uU(1),t.ALo(2,"number"),t.BQk()),2&o){const e=t.oxw(4).$implicit,i=t.oxw();t.xp6(1),t.hij(" ",i.coverageData[e.id].sum>0?t.lcZ(2,1,i.coverageData[e.id].sum):i.coverageData[e.id].sum," ")}}function se(o,c){if(1&o&&(t.TgZ(0,"td"),t.YNc(1,ae,2,1,"ng-container",2),t.YNc(2,re,3,3,"ng-container",2),t.qZA()),2&o){const e=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngIf",!e.sumInsuredStr),t.xp6(1),t.Q6J("ngIf",e.sumInsuredStr)}}function ce(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",8),t.NdJ("ngModelChange",function(n){t.CHM(e);const a=t.oxw(4).$implicit;return t.oxw().coverageData[a.id].unit=n}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(4).$implicit,i=t.oxw();t.xp6(1),t.Q6J("ngModel",i.coverageData[e.id].unit)}}function le(o,c){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=t.oxw(4).$implicit,i=t.oxw();t.xp6(1),t.hij(" ",i.coverageData[e.id].unit," ")}}function de(o,c){if(1&o&&(t.TgZ(0,"td"),t.YNc(1,ce,2,1,"ng-container",2),t.YNc(2,le,2,1,"ng-container",2),t.qZA()),2&o){const e=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngIf",!e.unitStr),t.xp6(1),t.Q6J("ngIf",e.unitStr)}}function ue(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",8),t.NdJ("ngModelChange",function(n){t.CHM(e);const a=t.oxw(4).$implicit;return t.oxw().coverageData[a.id].premium=n}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(4).$implicit,i=t.oxw();t.xp6(1),t.Q6J("ngModel",i.coverageData[e.id].premium)}}function pe(o,c){if(1&o&&(t.ynx(0),t._uU(1),t.ALo(2,"number"),t.BQk()),2&o){const e=t.oxw(4).$implicit,i=t.oxw();t.xp6(1),t.hij(" ",i.coverageData[e.id].premium>0?t.lcZ(2,1,i.coverageData[e.id].premium):i.coverageData[e.id].premium," ")}}function ge(o,c){if(1&o&&(t.TgZ(0,"td"),t.YNc(1,ue,2,1,"ng-container",2),t.YNc(2,pe,3,3,"ng-container",2),t.qZA()),2&o){const e=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngIf",!e.premiumStr),t.xp6(1),t.Q6J("ngIf",e.premiumStr)}}function me(o,c){if(1&o&&(t.ynx(0),t.YNc(1,se,3,2,"td",2),t.YNc(2,de,3,2,"td",2),t.YNc(3,ge,3,2,"td",2),t.BQk()),2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf",e.sumInsured),t.xp6(1),t.Q6J("ngIf",e.unit),t.xp6(1),t.Q6J("ngIf",e.premium)}}function _e(o,c){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.YNc(3,me,4,3,"ng-container",2),t.qZA()),2&o){const e=t.oxw().$implicit,i=t.oxw();t.xp6(2),t.Oqu(e.description),t.xp6(1),t.Q6J("ngIf",i.coverageData[e.id])}}function he(o,c){if(1&o&&(t.ynx(0),t.YNc(1,_e,4,2,"tr",2),t.BQk()),2&o){const e=c.$implicit;t.xp6(1),t.Q6J("ngIf",e.show)}}let _t=(()=>{class o{constructor(e,i,n,a,r){this.coverageQuoService=e,this.globalFun=i,this.cdRef=n,this.prodService=a,this.loadingService=r,this.actionEvent=new t.vpe,this.coverage={isSum:!1,isUnit:!1,isPremium:!1},this.coverageData={},this.unsubscribe=[],this.parentData={},this.isLoading=!0}ngOnInit(){return(0,v.mG)(this,void 0,void 0,function*(){if(this.refID=this.prodService.referenceID,this.optionId=this.optionId?this.optionId:this.resourcesId,"PLMO02"==this.product.code&&(this.parentData=this.getParnet()),this.product.coverages&&this.product.coverages.length>0){yield this.loadingService.activate(),this.coverage={isSum:this.product.coverages[0].sumInsured,isUnit:this.product.coverages[0].unit,isPremium:this.product.coverages[0].premium};let e={quotationNo:this.editData.id,coverageIds:this.product.coverages.map(n=>n.id),optionalKey:this.optionId},i=yield this.coverageQuoService.getAllById(e).toPromise();0==i.length&&(e.quotationNo=this.refID,e.optionalKey=this.refID,i=yield this.coverageQuoService.getAllById(e).toPromise());for(const n of this.product.coverages){n.show=!0,n.validationFun&&(n.show=!this.globalFun[n.validationFun]||this.globalFun[n.validationFun](this.parentData));let a=i.find(r=>r.coverageId==n.id);this.coverageData[n.id]={sum:a&&a.sumInsured||0,unit:a&&a.unit||0,premium:a&&a.premium||0},n.sumInsured&&this.getGlobalFun(n.sumInsuredStr,"coverageData",n.id,"sum"),n.unit&&this.getGlobalFun(n.unitStr,"coverageData",n.id,"unit"),n.premium&&this.getGlobalFun(n.premiumStr,"coverageData",n.id,"premium")}this.isLoading=!1,yield this.loadingService.deactivate(),this.cdRef.detectChanges()}else this.isLoading=!1})}getGlobalFun(e,i,n,a){if("PLMO02"==this.product.code&&"premium"==a)if(this.globalFun[e]){let r=this.globalFun[e](this.parentData).subscribe(s=>{this[i][n][a]=s,this.cdRef.detectChanges()});this.unsubscribe.push(r)}else e&&(this[i][n][a]=e);else if(this.globalFun[e+"Result"]){let r=this.globalFun[e+"Result"].subscribe(s=>{this[i][n][a]=s,this.cdRef.detectChanges()});this.unsubscribe.push(r)}else e&&(this[i][n][a]=e)}nextPage(){return(0,v.mG)(this,void 0,void 0,function*(){const i=this.coverageData;this.globalFun.tempFormData.coverage_1634010995936=[],this.resourcesId&&this.optionId&&(yield this.coverageQuoService.deleteAll(this.resourcesId,this.optionId));for(let n of this.product.coverages)try{let a={coverageId:n.id,quotationNo:this.resourcesId,optionalKey:this.optionId,sumInsured:((i[n.id].sum||"")+"").replace(",","").replace("MMK","").replace("USD",""),unit:((i[n.id].unit||"")+"").replace(",","").replace("MMK","").replace("USD",""),premium:((i[n.id].premium||"")+"").replace(",","").replace("MMK","").replace("USD","")};this.globalFun.tempFormData.coverage_1634010995936.push(a),yield this.coverageQuoService.save(a).toPromise().catch(s=>s)}catch(a){}this.actionEvent.emit({type:T.V.NEXT})})}backPage(){this.actionEvent.emit({type:T.V.PREV})}getParnet(){if((0,k.cU)(this.product.config)){let e=JSON.parse(this.product.config),n=("quotation"!=this.prodService.type?e.application||[]:e.quotation||[]).find(a=>"m_detail"==a.tableName);return n&&this.globalFun.tempFormData[n.tableName+n.id]||null}return null}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(W.a),t.Y36(A.Q),t.Y36(t.sBO),t.Y36(M.f),t.Y36(gt.b))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-coverage-page"]],inputs:{product:"product",editData:"editData",resourcesId:"resourcesId",optionId:"optionId"},outputs:{actionEvent:"actionEvent"},decls:18,vars:4,consts:[[1,"table","table-bordered"],[1,"tbody-align"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"row"],[1,"col-sm-6","mx-auto"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"],["type","text",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"]],template:function(e,i){1&e&&(t.TgZ(0,"table",0),t.TgZ(1,"thead",1),t.TgZ(2,"tr"),t.TgZ(3,"th"),t._uU(4," Basic Coverage "),t.qZA(),t.YNc(5,ie,2,0,"th",2),t.YNc(6,ne,2,0,"th",2),t.YNc(7,oe,2,0,"th",2),t.qZA(),t.qZA(),t.TgZ(8,"tbody",1),t.YNc(9,he,2,1,"ng-container",3),t.qZA(),t.qZA(),t._UZ(10,"hr"),t.TgZ(11,"div",4),t.TgZ(12,"div",5),t.TgZ(13,"button",6),t.NdJ("click",function(){return i.backPage()}),t._uU(14," Previous "),t.qZA(),t.qZA(),t.TgZ(15,"div",5),t.TgZ(16,"button",7),t.NdJ("click",function(){return i.nextPage()}),t._uU(17," Save & Next "),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngIf",i.coverage.isSum),t.xp6(1),t.Q6J("ngIf",i.coverage.isUnit),t.xp6(1),t.Q6J("ngIf",i.coverage.isPremium),t.xp6(2),t.Q6J("ngForOf",i.product.coverages))},directives:[_.O5,_.sg,l.Fj,l.JJ,l.On],pipes:[_.JJ],styles:[""]}),o})();var fe=p(17268),w=p(60940),ve=p(75396);const Ze=["chart"];let ht=(()=>{class o{constructor(e,i){this.alertService=e,this.globalFun=i,this.actionEvent=new t.vpe,this.showDatas=[],this.chartOptions={series:[{name:"Premium Amount",data:[],color:"#005f99"}],chart:{height:450,type:"line",toolbar:{show:!1}},title:{text:"Basic Benefit Illustration",offsetX:0,offsetY:10,floating:!1,style:{fontSize:"1.1rem",fontFamily:"Roboto"}},xaxis:{type:"category",categories:["0","1 year","2 years","3 years","4 years","5 years","6 years","7 years","8 years","9 years","10 years","11 years","12 years","13 years","14 years"],labels:{style:{fontSize:"1rem",fontFamily:"Roboto"}}},yaxis:{min:0,max:1e6,tickAmount:5,labels:{style:{fontSize:"1rem",fontFamily:"Roboto"}}},legend:{position:"top",horizontalAlign:"right",floating:!0,offsetY:-25,offsetX:-5},dataLabels:{enabled:!0,textAnchor:"middle",offsetX:-10,offsetY:-5,enabledOnSeries:[0]},markers:{size:[5,0,0]}}}ngOnInit(){if(this.parentData){let e=this.parentData.map(i=>i.premiumPaid&&i.premiumPaid>0?i.premiumPaid:null);e.unshift(null),this.parentData.length>0&&(this.chartOptions.yaxis.max=parseInt(this.parentData[0].benefit)),this.chartOptions.series[0].data=e}else this.alertService.activate("This page cann't to show because there is no education life product detail data. Please add education life product detail in rodcut configuration","Warning")}getParnet(){return this.globalFun.tempFormData[C.Ft]}nextPage(){this.actionEvent.emit({type:T.V.NEXT})}backPage(){this.actionEvent.emit({type:T.V.PREV})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(w.c),t.Y36(A.Q))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-endo-grip"]],viewQuery:function(e,i){if(1&e&&t.Gf(Ze,5),2&e){let n;t.iGM(n=t.CRH())&&(i.chart=n.first)}},inputs:{product:"product",editData:"editData",resourcesId:"resourcesId",parentData:"parentData"},outputs:{actionEvent:"actionEvent"},decls:1,vars:8,consts:[[3,"series","chart","xaxis","yaxis","title","legend","dataLabels","markers"]],template:function(e,i){1&e&&t._UZ(0,"apx-chart",0),2&e&&t.Q6J("series",i.chartOptions.series)("chart",i.chartOptions.chart)("xaxis",i.chartOptions.xaxis)("yaxis",i.chartOptions.yaxis)("title",i.chartOptions.title)("legend",i.chartOptions.legend)("dataLabels",i.chartOptions.dataLabels)("markers",i.chartOptions.markers)},directives:[ve.x],styles:[""]}),o})();var O=p(92070),K=p(28100),B=p(83067),R=p(54753),X=p(85724),N=p(18260),J=p(91691),E=p(44522);const ft=`${N.N.apiUrl}/endowment/rate`;let Ce=(()=>{class o extends J.i{constructor(e){super(e,ft),this.httpClient=e}getMany(e){return this.httpClient.get(ft+"s?policyTerm="+e)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(E.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const vt=`${N.N.apiUrl}/endowment/surrender/rate`;let be=(()=>{class o extends J.i{constructor(e){super(e,vt),this.httpClient=e}getMany(e){return this.httpClient.get(vt+"?policyTerm="+e)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(E.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Te=p(61438),U=p(67198);function De(o,c){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",8),t._uU(6),t.ALo(7,"number"),t.qZA(),t.TgZ(8,"td",8),t._uU(9),t.ALo(10,"number"),t.qZA(),t.TgZ(11,"td",8),t._uU(12),t.ALo(13,"number"),t.qZA(),t.TgZ(14,"td",8),t._uU(15),t.ALo(16,"number"),t.qZA(),t.qZA()),2&o){const e=c.$implicit;t.xp6(2),t.Oqu(e.endOfPolicyYear),t.xp6(2),t.Oqu(e.age),t.xp6(2),t.Oqu(t.lcZ(7,6,e.premiumPaid)||"-"),t.xp6(3),t.Oqu(t.lcZ(10,8,e.benefit)),t.xp6(3),t.Oqu(t.lcZ(13,10,e.surrenderValue)||"-"),t.xp6(3),t.Oqu(t.lcZ(16,12,e.policyLoan)||"-")}}function Ae(o,c){if(1&o&&(t.TgZ(0,"tbody"),t.YNc(1,De,17,14,"tr",7),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.showDatas)}}function Oe(o,c){if(1&o&&(t.ynx(0),t._UZ(1,"app-endo-grip",9),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("parentData",e.showDatas)}}let Pe=(()=>{class o{constructor(e,i,n,a,r,s,d,u,m){this.globalFun=e,this.alertService=i,this.prodService=n,this.eduPreService=a,this.eduSurrService=r,this.eduPayment=s,this.cdf=d,this.auth=u,this.numberPipe=m,this.actionEvent=new t.vpe,this.premimuRate={"5opt":5,"7opt":7,"10opt":10},this.frequency={monthly:12,quarterly:4,semi_annually:6,annually:1},this.lists=[],this.premiumRate=[],this.surrendRate=[],this.showDatas=[]}ngOnInit(){this.parentData=this.getParnet(),this.parentData2=this.getParnet(!0),this.parentData?this.getRateValue().pipe((0,B.w)(e=>{if(!e[0]||!e[1])throw e;return(0,b.of)({premium:e[0],surrend:e[1]})})).toPromise().then(e=>{console.log(e),e&&(this.premiumRate=e.premium,this.surrendRate=e.surrend,this.createListData())}).catch(e=>{console.log(e)}):this.alertService.activate("This page cann't to show because there is no endowment product detail data. Please add endowment product detail in prodcut configuration","Warning")}createListData(){this.getcalculateData(),this.showDatas=[],this.lists.forEach((e,i)=>{let n={resourceId:this.resourcesId,endOfPolicyYear:e,age:this.currentAge+i,premiumPaid:this.premimuRateNum>=e?this.calculatePre(this.currentAge,e):0,benefit:this.sumInsured,surrenderValue:this.calculateSur(e),policyLoan:.9*this.calculateSur(e)};this.showDatas.push(n),i+1==this.lists.length&&this.cdf.detectChanges()})}getcalculateData(){let e=this.globalFun.paPolicyValidationResult.value,i=e.validationValue;console.log(i,e),this.premimuRateNum=this.premimuRate[i+"opt"],this.policyTermCode=this.parentData.policy_term,this.sumInsured=this.parentData.sum_insured;let n=this.parentData2.date_of_birth;return this.currentAge=Math.ceil(O().diff(n,"years",!0)),this.frequencyValue=this.frequency[this.parentData.payment_frequency],this.lists=Array.from({length:i},(r,s)=>s+1),!0}getParnet(e){if((0,k.cU)(this.product.config)){let i=JSON.parse(this.product.config),a={};return a=("quotation"!=this.prodService.type?i.application||[]:i.quotation||[]).find(e?r=>"life_insured_endow"==r.tableName:r=>"endo_detail"==r.tableName),a&&this.globalFun.tempFormData[a.tableName+a.id]||null}return null}calculatePre(e,i){let n=0,a=this.premiumRate.find(s=>s.formAge<=e&&s.toAge>=e);a&&(n=a.rate);let r=n/1e3*this.sumInsured;if(1==i){let s=this.globalFun.calculateDecimal(r/this.frequencyValue);s=this.globalFun.calculateDecimal(s+3e-4*r),this.premiumAmt=this.numberPipe.transform(s)+" MMK / "+this.parentData.payment_frequency,this.globalFun.paPremiumResult.next(this.premiumAmt)}return this.globalFun.calculateDecimal(r)*i}calculateSur(e){let i=10,n=this.surrendRate.find(a=>a.premiumPaidYear==e);return n?(i=n.rate,i/1e3*this.sumInsured):0}getRateValue(){return(0,K.D)([this.getPRate(),this.getSurRate()]).pipe((0,R.U)(e=>e))}getPRate(){return this.eduPreService.getMany(this.parentData.policy_term)}getSurRate(){return this.eduSurrService.getMany(this.parentData.policy_term)}nextPage(){this.showDatas.length>0&&this.eduPayment.deleteMany(this.resourcesId).pipe((0,X.z)(e=>{let i={request:this.showDatas,resourceDataDTO:{agentId:this.auth.currentUserValue.id||1,customerId:this.prodService.creatingCustomer.customerId||1,leadId:this.prodService.creatingLeadId||1,policyNumber:null,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,productId:this.product.id,quotationId:this.prodService.referenceID,type:this.prodService.type},resourceId:this.resourcesId};return this.eduPayment.saveMany(i)})).toPromise().then(e=>{e&&(this.globalFun.tempFormData[C.Ft]=this.showDatas,this.actionEvent.emit({type:T.V.NEXT}))})}backPage(){this.actionEvent.emit({type:T.V.PREV})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.Q),t.Y36(w.c),t.Y36(M.f),t.Y36(Ce),t.Y36(be),t.Y36(Te.F),t.Y36(t.sBO),t.Y36(U.e8),t.Y36(_.JJ))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-endo"]],inputs:{product:"product",editData:"editData",resourcesId:"resourcesId"},outputs:{actionEvent:"actionEvent"},decls:25,vars:2,consts:[[1,"table","table-bordered"],[4,"ngIf"],[1,"mb-5"],[1,"row","mt-3"],[1,"col-sm-6","mx-auto"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"],[4,"ngFor","ngForOf"],[2,"text-align","right"],[3,"parentData"]],template:function(e,i){1&e&&(t.TgZ(0,"table",0),t.TgZ(1,"thead"),t.TgZ(2,"tr"),t.TgZ(3,"th"),t._uU(4,"End of Policy Year"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Age"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Premium Paid"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Death/PTD Benefit"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Surrender Value"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Policy Loan"),t.qZA(),t.qZA(),t.qZA(),t.YNc(15,Ae,2,1,"tbody",1),t.qZA(),t._UZ(16,"hr",2),t.YNc(17,Oe,2,1,"ng-container",1),t.TgZ(18,"div",3),t.TgZ(19,"div",4),t.TgZ(20,"button",5),t.NdJ("click",function(){return i.backPage()}),t._uU(21," Previous "),t.qZA(),t.qZA(),t.TgZ(22,"div",4),t.TgZ(23,"button",6),t.NdJ("click",function(){return i.nextPage()}),t._uU(24," Save & Next "),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(15),t.Q6J("ngIf",i.premiumRate.length>0&&i.surrendRate.length>0),t.xp6(2),t.Q6J("ngIf",i.showDatas.length>0))},directives:[_.O5,_.sg,ht],pipes:[_.JJ],styles:[""]}),o})();var at=p(53489),rt=p(99765);function ye(o,c){if(1&o&&(t.TgZ(0,"div",6),t.TgZ(1,"div",7),t.TgZ(2,"label",8),t._uU(3,"Item Name"),t.qZA(),t.TgZ(4,"div",9),t._UZ(5,"input",16),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(5),t.ekj("is-invalid",e.isControlInvalid("itemName"))("is-valid",e.isControlValid("itemName"))}}const tt=function(){return{prefix:"",thousands:",",precision:0,allowNegative:!1,align:"left"}};function xe(o,c){if(1&o&&(t.TgZ(0,"div",6),t.TgZ(1,"div",7),t.TgZ(2,"label",8),t._uU(3,"Stock Value"),t.qZA(),t.TgZ(4,"div",9),t._UZ(5,"input",17),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(5),t.ekj("is-invalid",e.isControlInvalid("stockValue"))("is-valid",e.isControlValid("stockValue")),t.Q6J("options",t.DdM(5,tt))}}function Ie(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",6),t.TgZ(1,"div",7),t.TgZ(2,"label",8),t._uU(3,"Quantiy"),t.qZA(),t.TgZ(4,"div",9),t.TgZ(5,"input",18),t.NdJ("ngModelChange",function(){return t.CHM(e),t.oxw().calculateTotalValue()}),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(5),t.ekj("is-invalid",e.isControlInvalid("quantity"))("is-valid",e.isControlValid("quantity"))}}function Me(o,c){if(1&o&&(t.TgZ(0,"div",6),t.TgZ(1,"div",7),t.TgZ(2,"label",8),t._uU(3,"Total Value"),t.qZA(),t.TgZ(4,"div",9),t._UZ(5,"input",19),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(5),t.ekj("is-invalid",e.isControlInvalid("totalValue"))("is-valid",e.isControlValid("totalValue")),t.Q6J("options",t.DdM(5,tt))}}function we(o,c){if(1&o&&(t.TgZ(0,"div",5),t.TgZ(1,"div",6),t.TgZ(2,"div",7),t.TgZ(3,"label",8),t._uU(4,"Month"),t.qZA(),t.TgZ(5,"div",9),t._UZ(6,"input",20),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"div",6),t.TgZ(8,"div",7),t.TgZ(9,"label",8),t._uU(10,"Remark"),t.qZA(),t.TgZ(11,"div",9),t._UZ(12,"input",21),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(6),t.ekj("is-invalid",e.isControlInvalid("month"))("is-valid",e.isControlValid("month")),t.xp6(6),t.ekj("is-invalid",e.isControlInvalid("remark"))("is-valid",e.isControlValid("remark"))}}function qe(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",6),t.TgZ(1,"div",7),t.TgZ(2,"label",8),t._uU(3,"Value Per Quantity"),t.qZA(),t.TgZ(4,"div",9),t.TgZ(5,"input",22),t.NdJ("ngModelChange",function(){return t.CHM(e),t.oxw().calculateTotalValue()}),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(5),t.ekj("is-invalid",e.isControlInvalid("valuePerQuantity"))("is-valid",e.isControlValid("valuePerQuantity")),t.Q6J("options",t.DdM(5,tt))}}function Fe(o,c){if(1&o&&(t.TgZ(0,"div",6),t.TgZ(1,"div",7),t.TgZ(2,"label",8),t._uU(3,"Agreed SI"),t.qZA(),t.TgZ(4,"div",9),t._UZ(5,"input",23),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(5),t.ekj("is-invalid",e.isControlInvalid("agreedSi"))("is-valid",e.isControlValid("agreedSi")),t.Q6J("options",t.DdM(5,tt))}}let st=(()=>{class o{constructor(e,i){this.modal=e,this.cdf=i,this.type="Contents including FFF",this.pageType="Add",this.riskId=1,this.isStock=!1}ngOnInit(){this.loadForm(this.data),this.setValidator()}create(){this.modal.dismiss({data:this.calculatedbuildingForm.value,type:"save"})}loadForm(e){this.calculatedbuildingForm=new l.cw({firePolicyRiskId:new l.NI(e?e.firePolicyRiskId:this.riskId),id:new l.NI(e?e.id:""),itemDescription:new l.NI(e?e.itemDescription||e.description:""),itemName:new l.NI(e?e.itemName:""),quantity:new l.NI(e?e.quantity:""),totalValue:new l.NI(e?e.totalValue:""),updatedBy:new l.NI(e?e.updatedBy:""),valuePerQuantity:new l.NI(e?e.valuePerQuantity:""),month:new l.NI(e?e.month:""),remark:new l.NI(e?e.remark:""),stockValue:new l.NI(e?e.stockValue:""),agreedSi:new l.NI(e?e.agreedSi:"")})}setValidator(){("Contents including FFF"==this.type||"Plant and Machinery"==this.type)&&(this.calculatedbuildingForm.controls.itemDescription.setValidators([l.kI.required]),this.calculatedbuildingForm.controls.itemDescription.updateValueAndValidity(),this.calculatedbuildingForm.controls.itemName.setValidators([l.kI.required]),this.calculatedbuildingForm.controls.itemName.updateValueAndValidity(),this.calculatedbuildingForm.controls.quantity.setValidators([l.kI.required]),this.calculatedbuildingForm.controls.quantity.updateValueAndValidity(),this.calculatedbuildingForm.controls.valuePerQuantity.setValidators([l.kI.required]),this.calculatedbuildingForm.controls.valuePerQuantity.updateValueAndValidity(),this.calculatedbuildingForm.controls.totalValue.setValidators([l.kI.required]),this.calculatedbuildingForm.controls.totalValue.updateValueAndValidity()),"Stock"==this.type&&(this.calculatedbuildingForm.controls.itemDescription.setValidators([l.kI.required]),this.calculatedbuildingForm.controls.itemDescription.updateValueAndValidity(),this.calculatedbuildingForm.controls.stockValue.setValidators([l.kI.required]),this.calculatedbuildingForm.controls.stockValue.updateValueAndValidity(),this.calculatedbuildingForm.controls.month.setValidators([l.kI.required]),this.calculatedbuildingForm.controls.month.updateValueAndValidity(),this.calculatedbuildingForm.controls.remark.setValidators([l.kI.required]),this.calculatedbuildingForm.controls.remark.updateValueAndValidity(),this.calculatedbuildingForm.controls.agreedSi.setValidators([l.kI.required]),this.calculatedbuildingForm.controls.agreedSi.updateValueAndValidity())}calculateTotalValue(){this.cdf.detectChanges();let e=this.calculatedbuildingForm.value.quantity,i=this.calculatedbuildingForm.value.valuePerQuantity;console.log("quantity,value",e,i),e&&i&&this.calculatedbuildingForm.controls.totalValue.setValue(e*i)}dismissModal(){this.modal.dismiss()}isControlValid(e){const i=this.calculatedbuildingForm.controls[e];return i.valid&&(i.dirty||i.touched)}isControlInvalid(e){const i=this.calculatedbuildingForm.controls[e];return i.invalid&&(i.dirty||i.touched)}controlHasError(e,i){const n=this.calculatedbuildingForm.controls[i];return n.hasError(e)&&(n.dirty||n.touched)}isControlTouched(e){const i=this.calculatedbuildingForm.controls[e];return i.dirty||i.touched}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(g.Kz),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-add-calculated-building"]],inputs:{type:"type",pageType:"pageType",data:"data",riskId:"riskId",isStock:"isStock"},decls:27,vars:15,consts:[[1,"modal-content"],[1,"modal-header"],["id","example-modal-sizes-title-lg",1,"modal-title","h4","left-border-image"],["action","#",1,"form",3,"formGroup","ngSubmit"],[1,"overlay","overlay-block","cursor-default","modal-body"],[1,"row",2,"align-items","center"],[1,"col-sm-6"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8"],["type","text","name","itemDescription","autocomplete","off","formControlName","itemDescription",1,"form-control","form-control-sm"],["class","col-sm-6",4,"ngIf"],["class","row","style","align-items: center",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-2",3,"click"],["type","submit",1,"btn","btn-primary","btn-elevate",3,"disabled"],["type","text","name","itemName","autocomplete","off","formControlName","itemName",1,"form-control","form-control-sm"],["type","tel","currencyMask","","name","stockValue","autocomplete","off","formControlName","stockValue",1,"form-control","form-control-sm",3,"options"],["type","number","name","quantity","autocomplete","off","formControlName","quantity",1,"form-control","form-control-sm",3,"ngModelChange"],["type","tel","currencyMask","","name","totalValue","autocomplete","off","formControlName","totalValue","readonly","",1,"form-control","form-control-sm",3,"options"],["type","text","name","month","autocomplete","off","formControlName","month",1,"form-control","form-control-sm"],["type","text","name","remark","autocomplete","off","formControlName","remark",1,"form-control","form-control-sm"],["type","tel","currencyMask","","name","valuePerQuantity","autocomplete","off","formControlName","valuePerQuantity",1,"form-control","form-control-sm",3,"options","ngModelChange"],["type","tel","currencyMask","","name","agreedSi","autocomplete","off","formControlName","agreedSi",1,"form-control","form-control-sm",3,"options"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.qZA(),t.TgZ(4,"form",3),t.NdJ("ngSubmit",function(){return i.create()}),t.TgZ(5,"div",4),t.TgZ(6,"div",5),t.TgZ(7,"div",6),t.TgZ(8,"div",7),t.TgZ(9,"label",8),t._uU(10,"Item Description"),t.qZA(),t.TgZ(11,"div",9),t._UZ(12,"input",10),t.qZA(),t.qZA(),t.qZA(),t.YNc(13,ye,6,4,"div",11),t.YNc(14,xe,6,6,"div",11),t.qZA(),t.TgZ(15,"div",5),t.YNc(16,Ie,6,4,"div",11),t.YNc(17,Me,6,6,"div",11),t.qZA(),t.YNc(18,we,13,8,"div",12),t.TgZ(19,"div",5),t.YNc(20,qe,6,6,"div",11),t.YNc(21,Fe,6,6,"div",11),t.qZA(),t.qZA(),t.TgZ(22,"div",13),t.TgZ(23,"button",14),t.NdJ("click",function(){return i.dismissModal()}),t._uU(24,"Cancel"),t.qZA(),t.TgZ(25,"button",15),t._uU(26,"Save"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(3),t.AsE(" ",i.pageType," ",i.type," "),t.xp6(1),t.Q6J("formGroup",i.calculatedbuildingForm),t.xp6(8),t.ekj("is-invalid",i.isControlInvalid("itemDescription"))("is-valid",i.isControlValid("itemDescription")),t.xp6(1),t.Q6J("ngIf",!i.isStock),t.xp6(1),t.Q6J("ngIf",i.isStock),t.xp6(2),t.Q6J("ngIf",!i.isStock),t.xp6(1),t.Q6J("ngIf",!i.isStock),t.xp6(1),t.Q6J("ngIf",i.isStock),t.xp6(2),t.Q6J("ngIf",!i.isStock),t.xp6(1),t.Q6J("ngIf",i.isStock),t.xp6(4),t.Q6J("disabled",i.calculatedbuildingForm.invalid))},directives:[l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,_.O5,rt.g1,l.wV],styles:[""]}),o})();const ke=`${N.N.apiUrl}/fire-policy/content`,Se=`${N.N.apiUrl}/fire-policy/plant-machinery`,Ne=`${N.N.apiUrl}/fire-policy/stock`;let Ue=(()=>{class o extends J.i{constructor(e){super(e,ke),this.httpClient=e}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(E.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),ze=(()=>{class o extends J.i{constructor(e){super(e,Se),this.httpClient=e}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(E.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Re=(()=>{class o extends J.i{constructor(e){super(e,Ne),this.httpClient=e}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(E.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var ct=p(66977),Zt=p(13468);function Je(o,c){1&o&&(t.TgZ(0,"thead"),t.TgZ(1,"tr"),t.TgZ(2,"th"),t._uU(3,"Item Name"),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Item Description"),t.qZA(),t.TgZ(6,"th",3),t._uU(7,"Value per Quantity"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Quantity"),t.qZA(),t.TgZ(10,"th",3),t._uU(11,"Total Value"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Action"),t.qZA(),t.qZA(),t.qZA())}function Ee(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"th"),t._uU(2),t.qZA(),t.TgZ(3,"th"),t._uU(4),t.qZA(),t.TgZ(5,"th",3),t._uU(6),t.ALo(7,"number"),t.qZA(),t.TgZ(8,"th"),t._uU(9),t.qZA(),t.TgZ(10,"th",3),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"th"),t.TgZ(14,"a",5),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).onActionView(a,"edit","content")}),t._UZ(15,"span",6),t.qZA(),t.TgZ(16,"a",7),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).onActionView(a,"delete","content")}),t._UZ(17,"span",8),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=c.$implicit;t.xp6(2),t.hij(" ",e.itemName," "),t.xp6(2),t.hij(" ",e.itemDescription," "),t.xp6(2),t.hij(" ",t.lcZ(7,5,e.valuePerQuantity)," "),t.xp6(3),t.hij(" ",e.quantity," "),t.xp6(2),t.hij(" ",t.lcZ(12,7,e.totalValue)," ")}}function Be(o,c){if(1&o&&(t.TgZ(0,"tbody"),t.YNc(1,Ee,18,9,"tr",4),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.tableData)}}function Qe(o,c){1&o&&(t.TgZ(0,"thead"),t.TgZ(1,"tr"),t.TgZ(2,"th"),t._uU(3,"Item Name"),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Item Description"),t.qZA(),t.TgZ(6,"th",3),t._uU(7,"Value per Quantity"),t.qZA(),t.TgZ(8,"th",3),t._uU(9,"Quantity"),t.qZA(),t.TgZ(10,"th",3),t._uU(11,"Total Value"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Action"),t.qZA(),t.qZA(),t.qZA())}function Ve(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"th"),t._uU(2),t.qZA(),t.TgZ(3,"th"),t._uU(4),t.qZA(),t.TgZ(5,"th",3),t._uU(6),t.ALo(7,"number"),t.qZA(),t.TgZ(8,"th",3),t._uU(9),t.qZA(),t.TgZ(10,"th",3),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"th"),t.TgZ(14,"a",5),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).onActionView(a,"edit","plant")}),t._UZ(15,"span",6),t.qZA(),t.TgZ(16,"a",7),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).onActionView(a,"delete","plant")}),t._UZ(17,"span",8),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=c.$implicit;t.xp6(2),t.hij(" ",e.itemName," "),t.xp6(2),t.hij(" ",e.itemDescription," "),t.xp6(2),t.hij(" ",t.lcZ(7,5,e.valuePerQuantity)," "),t.xp6(3),t.hij(" ",e.quantity," "),t.xp6(2),t.hij(" ",t.lcZ(12,7,e.totalValue)," ")}}function Ye(o,c){if(1&o&&(t.TgZ(0,"tbody"),t.YNc(1,Ve,18,9,"tr",4),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.tableData)}}function Le(o,c){1&o&&(t.TgZ(0,"thead"),t.TgZ(1,"tr"),t.TgZ(2,"th"),t._uU(3,"Month"),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Description"),t.qZA(),t.TgZ(6,"th",3),t._uU(7,"Stock Value"),t.qZA(),t.TgZ(8,"th",3),t._uU(9,"Agreed SI"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Remarks"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Action"),t.qZA(),t.qZA(),t.qZA())}function je(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"th"),t._uU(2),t.qZA(),t.TgZ(3,"th"),t._uU(4),t.qZA(),t.TgZ(5,"th",3),t._uU(6),t.ALo(7,"number"),t.qZA(),t.TgZ(8,"th",3),t._uU(9),t.ALo(10,"number"),t.qZA(),t.TgZ(11,"th"),t._uU(12),t.qZA(),t.TgZ(13,"th"),t.TgZ(14,"a",5),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).onActionView(a,"edit","stock")}),t._UZ(15,"span",6),t.qZA(),t.TgZ(16,"a",7),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).onActionView(a,"delete","stock")}),t._UZ(17,"span",8),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=c.$implicit;t.xp6(2),t.hij(" ",e.month," "),t.xp6(2),t.hij(" ",e.description," "),t.xp6(2),t.hij(" ",t.lcZ(7,5,e.stockValue)," "),t.xp6(3),t.hij(" ",t.lcZ(10,7,e.agreedSi)," "),t.xp6(3),t.hij(" ",e.remark," ")}}function He(o,c){if(1&o&&(t.TgZ(0,"tbody"),t.YNc(1,je,18,9,"tr",4),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.tableData)}}let Ge=(()=>{class o{constructor(){this.contents=!1,this.plant=!1,this.stock=!1,this.tableData=[],this.emitter=new t.vpe}ngOnInit(){}onActionView(e,i,n){this.emitter.emit({cmd:i,data:e,tbtype:n})}ngOnDestroy(){this.emitter.unsubscribe()}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-tables"]],inputs:{contents:"contents",plant:"plant",stock:"stock",tableData:"tableData"},outputs:{emitter:"emitter"},decls:8,vars:6,consts:[[1,"table-responsive","angular-bootstrap-table"],[1,"table","table-head-custom","table-vertical-center"],[4,"ngIf"],[2,"text-align","right"],[4,"ngFor","ngForOf"],["title","Edit Form Page",1,"btn","btn-primary","btn-cus","btn-sm","mx-1",3,"click"],[1,"flaticon-edit"],["title","Delete Form Page",1,"btn","btn-danger","btn-cus","btn-sm","mx-1",3,"click"],[1,"flaticon-delete"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"table",1),t.YNc(2,Je,14,0,"thead",2),t.YNc(3,Be,2,1,"tbody",2),t.YNc(4,Qe,14,0,"thead",2),t.YNc(5,Ye,2,1,"tbody",2),t.YNc(6,Le,14,0,"thead",2),t.YNc(7,He,2,1,"tbody",2),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngIf",i.contents),t.xp6(1),t.Q6J("ngIf",i.tableData.length>0&&i.contents),t.xp6(1),t.Q6J("ngIf",i.plant),t.xp6(1),t.Q6J("ngIf",i.tableData.length>0&&i.plant),t.xp6(1),t.Q6J("ngIf",i.stock),t.xp6(1),t.Q6J("ngIf",i.tableData.length>0&&i.stock))},directives:[_.O5,_.sg],pipes:[_.JJ],styles:["table[_ngcontent-%COMP%]   .tr[_ngcontent-%COMP%]   .th[_ngcontent-%COMP%]{text-align:center}"]}),o})();function $e(o,c){1&o&&t._UZ(0,"hr")}function We(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"app-tables",11),t.NdJ("emitter",function(n){return t.CHM(e),t.oxw(2).actionBtn(n)}),t.qZA(),t.TgZ(2,"div",1),t.TgZ(3,"div",12),t.TgZ(4,"label",13),t._uU(5,"Total Sum Insured for Contents including FFF "),t.TgZ(6,"span",14),t._uU(7),t.ALo(8,"number"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("contents",!0)("tableData",e.contentsData),t.xp6(6),t.Oqu(t.lcZ(8,3,e.totalContent))}}function Ke(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",9),t.TgZ(1,"div",1),t.TgZ(2,"div",4),t.TgZ(3,"label",5),t._uU(4,"Contents including FFF"),t.qZA(),t.qZA(),t.TgZ(5,"div",6),t.TgZ(6,"mat-slide-toggle",7),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().isContents=n})("toggleChange",function(){return t.CHM(e),t.oxw().toggleChange("contents")}),t.qZA(),t.qZA(),t.TgZ(7,"div",6),t.TgZ(8,"button",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().add("contents",null,"Add")}),t._uU(9,"Add"),t.qZA(),t.qZA(),t.qZA(),t.YNc(10,We,9,5,"div",2),t.qZA()}if(2&o){const e=t.oxw();t.xp6(6),t.Q6J("ngModel",e.isContents)("color",e.primary),t.xp6(4),t.Q6J("ngIf",e.isContents&&e.contentsData)}}function Xe(o,c){1&o&&t._UZ(0,"hr")}function ti(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"app-tables",15),t.NdJ("emitter",function(n){return t.CHM(e),t.oxw(2).actionBtn(n)}),t.qZA(),t.TgZ(2,"div",1),t.TgZ(3,"div",12),t.TgZ(4,"label",13),t._uU(5,"Total Sum Insured for Plants and Machinery "),t.TgZ(6,"span",14),t._uU(7),t.ALo(8,"number"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("plant",!0)("tableData",e.plantData),t.xp6(6),t.Oqu(t.lcZ(8,3,e.totalPlant))}}function ei(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"div",1),t.TgZ(2,"div",4),t.TgZ(3,"label",5),t._uU(4,"Plant and Machinery"),t.qZA(),t.qZA(),t.TgZ(5,"div",6),t.TgZ(6,"mat-slide-toggle",7),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().isPlant=n})("toggleChange",function(){return t.CHM(e),t.oxw().toggleChange("plants")}),t.qZA(),t.qZA(),t.TgZ(7,"div",6),t.TgZ(8,"button",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().add("plants",null,"Add")}),t._uU(9,"Add"),t.qZA(),t.qZA(),t.qZA(),t.YNc(10,ti,9,5,"div",2),t.qZA()}if(2&o){const e=t.oxw();t.xp6(6),t.Q6J("ngModel",e.isPlant)("color",e.primary),t.xp6(4),t.Q6J("ngIf",e.isPlant&&e.plantData)}}function ii(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",6),t.TgZ(1,"button",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().add("stock",null,"Add")}),t._uU(2,"Add"),t.qZA(),t.qZA()}}const ni=function(){return{prefix:"",thousands:",",precision:0,allowNegative:!1,align:"left"}};function oi(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"app-tables",16),t.NdJ("emitter",function(n){return t.CHM(e),t.oxw().actionBtn(n)}),t.qZA(),t.TgZ(2,"div",1),t.TgZ(3,"div",17),t.TgZ(4,"div",18),t.TgZ(5,"label",19),t._uU(6,"Proposed Stock Value"),t.qZA(),t.TgZ(7,"div",20),t._UZ(8,"input",21),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",17),t.TgZ(10,"label",13),t._uU(11,"Total Sum Insured for Stock "),t.TgZ(12,"span",14),t._uU(13),t.ALo(14,"number"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t._UZ(15,"hr"),t.qZA()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("stock",!0)("tableData",e.stockData),t.xp6(7),t.Q6J("options",t.DdM(8,ni))("value",e.stockData.length>0?e.stockData[0].agreedSi:0)("disabled",!0),t.xp6(5),t.Oqu(t.lcZ(14,6,e.totalStock))}}let Ct=(()=>{class o{constructor(e,i,n,a,r,s,d,u,m){this.FireContentService=e,this.FirePLantService=i,this.FireStockService=n,this.modal=a,this.auth=r,this.cdf=s,this.globalService=d,this.riskService=u,this.alertService=m,this.isContents=!1,this.isPlant=!1,this.isStock=!1,this.default=0,this.primary="primary",this.totalContent=0,this.totalPlant=0,this.totalStock=0,this.tableData=[],this.contentsData=[],this.plantData=[],this.stockData=[],this.totalSI=0,this.productDetail={},this.riskId=1,this.totalEvent=new t.vpe}ngOnInit(){this.getFireContent(),this.getFirePlant(),this.getFireStock(),this.productDetail=this.globalService.tempFormData[C.T$]||{}}actionBtn(e){"delete"==e.cmd&&("content"==e.tbtype&&this.deleteFireContent(e.data.id),"plant"==e.tbtype&&this.deleteFirePlant(e.data.id),"stock"==e.tbtype&&this.deleteFireStock(e.data.id)),"edit"==e.cmd&&("content"==e.tbtype&&this.add("contents",e.data,"Edit"),"plant"==e.tbtype&&this.add("plants",e.data,"Edit"),"stock"==e.tbtype&&this.add("stock",e.data,"Edit"))}add(e,i,n){if("contents"==e){let a;a=this.modal.open(st,{size:"xl",backdrop:!1}),a.componentInstance.type="Contents including FFF",a.componentInstance.pageType=n,a.componentInstance.riskId=this.riskId,a.componentInstance.data=i,a.result.then(()=>{},r=>{if(r&&"save"==r.type){let s=Object.assign(Object.assign({},r.data),{createdBy:this.auth.currentUserValue.id});this.FireContentService.save(s).toPromise().then(d=>{if(d){this.getFireContent();let u=i||{id:0},m=this.contentsData.findIndex(h=>h.id==u.id);m<0?this.contentsData.push(Object.assign(Object.assign({},s),{id:d})):this.contentsData[m]=Object.assign(Object.assign({},s),{id:d}),this.cdf.detectChanges()}})}})}if("plants"==e){let a;a=this.modal.open(st,{size:"xl",backdrop:!1}),a.componentInstance.type="Plant and Machinery",a.componentInstance.pageType=n,a.componentInstance.riskId=this.riskId,a.componentInstance.data=i,a.result.then(()=>{},r=>{if(r&&"save"==r.type){let s=Object.assign(Object.assign({},r.data),{createdBy:this.auth.currentUserValue.id});this.FirePLantService.save(s).toPromise().then(d=>{if(d){this.getFirePlant();let u=i||{id:0},m=this.plantData.findIndex(h=>h.id==u.id);m<0?this.plantData.push(Object.assign(Object.assign({},s),{id:d})):this.plantData[m]=Object.assign(Object.assign({},s),{id:d}),this.cdf.detectChanges()}})}})}if("stock"==e){let a;a=this.modal.open(st,{size:"xl",backdrop:!1}),a.componentInstance.type="Stock",a.componentInstance.pageType=n,a.componentInstance.riskId=this.riskId,a.componentInstance.data=i,a.componentInstance.isStock=!0,a.result.then(()=>{},r=>{if(r&&"save"==r.type){let s=Object.assign(Object.assign({},r.data),{createdBy:this.auth.currentUserValue.id,description:r.data.itemDescription});this.FireStockService.save(s).toPromise().then(d=>{if(d){this.getFireStock();let u=i||{id:0},m=this.stockData.findIndex(h=>h.id==u.id);m<0?this.stockData.push(Object.assign(Object.assign({},s),{id:d})):this.stockData[m]=Object.assign(Object.assign({},s),{id:d}),this.cdf.detectChanges()}})}})}}getFireContent(){this.riskService.getContent(this.riskId).toPromise().then(e=>{if(e){if(this.contentsData=e,this.contentsData.length>0){this.isContents=!0,this.totalContent=0;for(let i of this.contentsData)this.totalContent+=parseInt(i.totalValue)}this.calculateProposeStock(),this.cdf.detectChanges()}})}getFirePlant(){this.riskService.getPlant(this.riskId).toPromise().then(e=>{if(e){if(this.plantData=e,this.plantData.length>0){this.isPlant=!0,this.totalPlant=0;for(let i of this.plantData)this.totalPlant+=parseInt(i.totalValue)}this.calculateProposeStock(),this.cdf.detectChanges()}})}getFireStock(){this.riskService.getStock(this.riskId).toPromise().then(e=>{if(e){if(this.stockData=e,this.stockData.length>0){this.isStock=!0,this.totalStock=0;for(let i of this.stockData)this.totalStock+=parseInt(i.stockValue);this.calculateProposeStock()}this.cdf.detectChanges()}})}calculateProposeStock(){this.totalSI=this.totalStock+this.totalContent+this.totalPlant,this.totalEvent.next(this.totalSI)}deleteFireContent(e){this.alertService.activate("Are you sure want to delete?","Warning Message").then(i=>{i&&this.FireContentService.delete(e).toPromise().then(n=>{n&&(this.getFireContent(),this.alertService.activate("This record was deleted","Success Message").then(a=>{}))})})}deleteFirePlant(e){this.alertService.activate("Are you sure want to delete?","Warning Message").then(i=>{this.FirePLantService.delete(e).toPromise().then(n=>{n&&(this.getFirePlant(),this.alertService.activate("This record was deleted","Success Message").then(a=>{}))})})}deleteFireStock(e){this.alertService.activate("Are you sure want to delete?","Warning Message").then(i=>{this.FireStockService.delete(e).toPromise().then(n=>{n&&(this.getFireStock(),this.alertService.activate("This record was deleted","Success Message").then(a=>{}))})})}toggleChange(e){if("contents"==e&&(this.isContents=this.isContents,!this.isContents&&this.contentsData.length>0))for(let i of this.contentsData)this.deleteFireContent(i.id);if("plants"==e&&(this.isPlant=this.isPlant,!this.isPlant&&this.plantData.length>0))for(let i of this.plantData)this.deleteFirePlant(i.id);if("stock"==e&&(this.isStock=this.isStock,!this.isStock&&this.stockData.length>0))for(let i of this.stockData)this.deleteFireStock(i.id)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Ue),t.Y36(ze),t.Y36(Re),t.Y36(g.FF),t.Y36(U.e8),t.Y36(t.sBO),t.Y36(A.Q),t.Y36(ct.U),t.Y36(w.c))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-calculated-building"]],inputs:{default:"default",riskId:"riskId"},outputs:{totalEvent:"totalEvent"},decls:16,vars:8,consts:[[1,"form-group"],[1,"row",2,"align-items","center"],[4,"ngIf"],["class","px5 py5",4,"ngIf"],[1,"col-sm-8"],[1,"col-sm-6","left-border-image"],[1,"col-sm-2"],[1,"toggle","ft-right",3,"ngModel","color","ngModelChange","toggleChange"],["class","col-sm-2",4,"ngIf"],[1,"px5","py5"],["type","button",1,"btn","btn-primary","btn-sm","mx-2","ft-right",3,"click"],[3,"contents","tableData","emitter"],[1,"col-sm-12"],[1,"col-sm-12","col-form-label","tx-right"],[2,"margin-left","29px"],[3,"plant","tableData","emitter"],[3,"stock","tableData","emitter"],[1,"col-sm-6"],[1,"form-group","row"],[1,"col-md-4","col-form-label"],[1,"col-md-8"],["type","tel","currencyMask","","name","proposeStockValue","autocomplete","off",1,"form-control","form-control-sm",3,"options","value","disabled"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.YNc(2,$e,1,0,"hr",2),t.YNc(3,Ke,11,3,"div",3),t.YNc(4,Xe,1,0,"hr",2),t.YNc(5,ei,11,3,"div",2),t._UZ(6,"hr"),t.TgZ(7,"div"),t.TgZ(8,"div",1),t.TgZ(9,"div",4),t.TgZ(10,"label",5),t._uU(11,"Stock"),t.qZA(),t.qZA(),t.TgZ(12,"div",6),t.TgZ(13,"mat-slide-toggle",7),t.NdJ("ngModelChange",function(a){return i.isStock=a})("toggleChange",function(){return i.toggleChange("stock")}),t.qZA(),t.qZA(),t.YNc(14,ii,3,0,"div",8),t.qZA(),t.YNc(15,oi,16,9,"div",2),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngIf","T-NM"==i.productDetail.policyType),t.xp6(1),t.Q6J("ngIf","T-NM"==i.productDetail.policyType),t.xp6(1),t.Q6J("ngIf","T-NM"==i.productDetail.policyType),t.xp6(1),t.Q6J("ngIf","T-NM"==i.productDetail.policyType),t.xp6(8),t.Q6J("ngModel",i.isStock)("color",i.primary),t.xp6(1),t.Q6J("ngIf",0==i.stockData.length),t.xp6(1),t.Q6J("ngIf",i.isStock&&i.stockData))},directives:[_.O5,Zt.Rr,l.JJ,l.On,Ge,rt.g1],pipes:[_.JJ],styles:[".ft-right[_ngcontent-%COMP%]{float:right}.tx-right[_ngcontent-%COMP%]{text-align:right}"]}),o})();var et=p(26697);const bt=`${N.N.apiUrl}/fire/premium-rate`;let Tt=(()=>{class o extends J.i{constructor(e){super(e,bt),this.httpClient=e}getPremiumRate(e,i,n){return this.httpClient.get(bt+"?classOfBuilding="+e+"&occupationOfBuilding="+i+"&typeOfBuilding="+n)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(E.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const Dt=`${N.N.apiUrl}/fire-policy/pae`;let ai=(()=>{class o extends J.i{constructor(e){super(e,Dt),this.httpClient=e}getMany(e){return this.httpClient.post(Dt,e)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(E.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const At=`${N.N.apiUrl}/fire-policy/surrounding-building`,ri=`${N.N.apiUrl}/fire-policy/risk/`;let lt=(()=>{class o extends J.i{constructor(e){super(e,At),this.httpClient=e}getByRiskId(e){return this.httpClient.get(ri+e+"/surrounding-building")}getMaxRate(e){return this.httpClient.get(At+"/max-rate?riskId="+e)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(E.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Q=p(55167),si=p(90949),H=p(18510);const ci=[{title:"Building Description",type:H.Y.FEILD,field:"description",isDate:!0},{title:"Type of building",type:H.Y.FEILD,field:"typeOfBuilding"},{title:"Occupation",type:H.Y.FEILD,field:"occupation"},{title:"Class",type:H.Y.FEILD,field:"class"},{title:"Premiun Rate",type:H.Y.FEILD,field:"premiumRate"},{title:"Actions",type:H.Y.ACTION,field:"actions",btn:{edit:!0,view:!0}}],li=["description","typeOfBuilding","occupation","class","premiumRate"];let di=(()=>{class o{constructor(e,i,n,a,r,s){this.modal=e,this.masterDataService=i,this.cdf=n,this.SurroundingBuildingService=a,this.auth=r,this.PremiumRateService=s,this.typeOfBuildingOption=[],this.occupationOfBuildingOption=[],this.occupationOfBuildingOptions=[],this.buildingClassOption=[],this.premiumRateOption=[],this.type="create",this.riskId="1"}ngOnInit(){this.loadForm(),this.getBuildingClass(),this.getBuildingType(),this.getBuildingOccupation(),"create"==this.type?this.loadForm():this.loadForm(this.oldData)}getBuildingClass(){this.masterDataService.getDataByType("BUILDING_CLASS").toPromise().then(e=>{e&&(this.buildingClassOption=e.map(i=>({code:i.codeId,value:i.codeName})),this.cdf.detectChanges())})}getBuildingType(){this.masterDataService.getDataByType("TYPE_OF_BUILDING").toPromise().then(e=>{e&&(this.typeOfBuildingOption=e.map(i=>({code:i.codeId,value:i.codeName})),this.cdf.detectChanges())})}getBuildingOccupation(){this.masterDataService.getDataByType("OCCUPATION_OF_BUILDING").toPromise().then(e=>{e&&(this.occupationOfBuildingOptions=e.map(i=>({code:i.codeId,value:i.codeName,parent:i.parentId})),this.cdf.detectChanges())})}getPremiumRate(){this.PremiumRateService.getPremiumRate(this.surroundingdetailform.value.buildingClass,this.surroundingdetailform.value.occupationOfBuilding,this.surroundingdetailform.value.typeOfBuilding).toPromise().then(a=>{a&&this.surroundingdetailform.controls.premiumRate.setValue(a.premiumRate)})}loadForm(e){this.surroundingdetailform=new l.cw({buildingClass:new l.NI(e?e.buildingClass:""),buildingDescription:new l.NI(e?e.buildingDescription:""),distanceToBuilding:new l.NI(e?e.distanceToBuilding:""),firePolicyRiskId:new l.NI(this.riskId),id:new l.NI(e?e.id:""),occupationOfBuilding:new l.NI(e?e.occupationOfBuilding:""),premiumRate:new l.NI(e?e.premiumRate:""),typeOfBuilding:new l.NI(e?e.typeOfBuilding:"")})}createSurrounding(){let e=this.surroundingdetailform.getRawValue(),i=Object.assign(Object.assign({},e),{createdBy:this.auth.currentUserValue.id});"create"!=this.type?this.SurroundingBuildingService.updateNoID(i).toPromise().then(n=>{if(n){let a=Object.assign({},i),r=this.surroundingdetailform.value.buildingClass,s=this.surroundingdetailform.value.occupationOfBuilding,d=this.surroundingdetailform.value.typeOfBuilding,u=this.buildingClassOption.find(f=>f.code==r).value,m=this.occupationOfBuildingOption.find(f=>f.code==s).value,h=this.typeOfBuildingOption.find(f=>f.code==d).value;this.modal.dismiss({data:Object.assign(Object.assign({},a),{buildingClassValue:u,occupationOfBuildingValue:m,typeOfBuildingValue:h}),type:"save"})}}):this.SurroundingBuildingService.save(i).toPromise().then(n=>{if(n){i.id=n;let a=Object.assign({},i),r=this.surroundingdetailform.value.buildingClass,s=this.surroundingdetailform.value.occupationOfBuilding,d=this.surroundingdetailform.value.typeOfBuilding,u=this.buildingClassOption.find(f=>f.code==r).value,m=this.occupationOfBuildingOption.find(f=>f.code==s).value,h=this.typeOfBuildingOption.find(f=>f.code==d).value;this.modal.dismiss({data:Object.assign(Object.assign({},a),{buildingClassValue:u,occupationOfBuildingValue:m,typeOfBuildingValue:h}),type:"save"})}})}changeClass(){"T-001"==this.surroundingdetailform.value.buildingClass&&(this.surroundingdetailform.controls.distanceToBuilding.setValidators([l.kI.max(25)]),this.surroundingdetailform.controls.distanceToBuilding.updateValueAndValidity()),"T-001"!=this.surroundingdetailform.value.buildingClass&&(this.surroundingdetailform.controls.distanceToBuilding.setValidators([l.kI.max(50)]),this.surroundingdetailform.controls.distanceToBuilding.updateValueAndValidity()),this.surroundingdetailform.value.buildingClass&&this.surroundingdetailform.value.occupationOfBuilding&&this.surroundingdetailform.value.typeOfBuilding&&this.getPremiumRate()}changeType(e){let i=this.surroundingdetailform.value.buildingClass,n=this.surroundingdetailform.value.occupationOfBuilding,a=this.surroundingdetailform.value.typeOfBuilding;"child"==e&&(this.occupationOfBuildingOption=this.occupationOfBuildingOptions.filter(s=>s.parent==a),this.occupationOfBuildingOption.findIndex(s=>s.code==n)<0&&this.surroundingdetailform.controls.occupationOfBuilding.setValue(null)),i&&n&&a&&this.getPremiumRate()}changeOccuption(){this.surroundingdetailform.value.buildingClass&&this.surroundingdetailform.value.occupationOfBuilding&&this.surroundingdetailform.value.typeOfBuilding&&this.getPremiumRate()}dismissModal(){this.modal.dismiss()}isControlValid(e){const i=this.surroundingdetailform.controls[e];return i.valid&&(i.dirty||i.touched)}isControlInvalid(e){const i=this.surroundingdetailform.controls[e];return i.invalid&&(i.dirty||i.touched)}controlHasError(e,i){const n=this.surroundingdetailform.controls[i];return n.hasError(e)&&(n.dirty||n.touched)}isControlTouched(e){const i=this.surroundingdetailform.controls[e];return i.dirty||i.touched}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(g.Kz),t.Y36(et.D),t.Y36(t.sBO),t.Y36(lt),t.Y36(U.e8),t.Y36(Tt))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-surrounding-detail"]],decls:50,vars:28,consts:[[1,"modal-content"],[1,"modal-header"],["id","example-modal-sizes-title-lg",1,"modal-title","h4","left-border-image"],["action","#",1,"form",3,"formGroup","ngSubmit"],[1,"overlay","overlay-block","cursor-default","modal-body"],[1,"row",2,"align-items","center"],[1,"col-sm-6"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8"],["type","text","name","buildingDescription","autocomplete","off","formControlName","buildingDescription",1,"form-control","form-control-sm"],["bindLabel","value","bindValue","code","formControlName","typeOfBuilding",1,"ng-custom-select",3,"items","change"],["bindLabel","value","bindValue","code","formControlName","occupationOfBuilding",1,"ng-custom-select",3,"items","change"],["bindLabel","value","bindValue","code","formControlName","buildingClass",1,"ng-custom-select",3,"items","change"],["type","number","name","distanceToBuilding","autocomplete","off","formControlName","distanceToBuilding",1,"form-control","form-control-sm"],["type","number","name","premiumRate","autocomplete","off","formControlName","premiumRate",1,"form-control","form-control-sm"],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-sm","btn-elevate","mr-2",3,"click"],["type","submit",1,"btn","btn-primary","btn-sm","btn-elevate"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3," Surrounding Detail "),t.qZA(),t.qZA(),t.TgZ(4,"form",3),t.NdJ("ngSubmit",function(){return i.createSurrounding()}),t.TgZ(5,"div",4),t.TgZ(6,"div",5),t.TgZ(7,"div",6),t.TgZ(8,"div",7),t.TgZ(9,"label",8),t._uU(10,"Building Description"),t.qZA(),t.TgZ(11,"div",9),t._UZ(12,"input",10),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"div",6),t.TgZ(14,"div",7),t.TgZ(15,"label",8),t._uU(16,"Type of Building"),t.qZA(),t.TgZ(17,"div",9),t.TgZ(18,"ng-select",11),t.NdJ("change",function(){return i.changeType("child")}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(19,"div",5),t.TgZ(20,"div",6),t.TgZ(21,"div",7),t.TgZ(22,"label",8),t._uU(23,"Occupation of Building"),t.qZA(),t.TgZ(24,"div",9),t.TgZ(25,"ng-select",12),t.NdJ("change",function(){return i.changeOccuption()}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(26,"div",6),t.TgZ(27,"div",7),t.TgZ(28,"label",8),t._uU(29,"Building Class"),t.qZA(),t.TgZ(30,"div",9),t.TgZ(31,"ng-select",13),t.NdJ("change",function(){return i.changeClass()}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(32,"div",5),t.TgZ(33,"div",6),t.TgZ(34,"div",7),t.TgZ(35,"label",8),t._uU(36,"Distance to Building (feet)"),t.qZA(),t.TgZ(37,"div",9),t._UZ(38,"input",14),t.qZA(),t.qZA(),t.qZA(),t.TgZ(39,"div",6),t.TgZ(40,"div",7),t.TgZ(41,"label",8),t._uU(42,"Rate"),t.qZA(),t.TgZ(43,"div",9),t._UZ(44,"input",15),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(45,"div",16),t.TgZ(46,"button",17),t.NdJ("click",function(){return i.dismissModal()}),t._uU(47,"Cancel"),t.qZA(),t.TgZ(48,"button",18),t._uU(49,"Save"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(4),t.Q6J("formGroup",i.surroundingdetailform),t.xp6(8),t.ekj("is-invalid",i.isControlInvalid("buildingDescription"))("is-valid",i.isControlValid("buildingDescription")),t.xp6(6),t.ekj("is-invalid",i.isControlInvalid("typeOfBuilding"))("is-valid",i.isControlValid("typeOfBuilding")),t.Q6J("items",i.typeOfBuildingOption),t.xp6(7),t.ekj("is-invalid",i.isControlInvalid("occupationOfBuilding"))("is-valid",i.isControlValid("occupationOfBuilding")),t.Q6J("items",i.occupationOfBuildingOption),t.xp6(6),t.ekj("is-invalid",i.isControlInvalid("buildingClass"))("is-valid",i.isControlValid("buildingClass")),t.Q6J("items",i.buildingClassOption),t.xp6(7),t.ekj("is-invalid",i.isControlInvalid("distanceToBuilding"))("is-valid",i.isControlValid("distanceToBuilding")),t.xp6(6),t.ekj("is-invalid",i.isControlInvalid("premiumRate"))("is-valid",i.isControlValid("premiumRate")))},directives:[l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,$.w9,l.wV],styles:[""]}),o})();function ui(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"th"),t._uU(2),t.qZA(),t.TgZ(3,"th"),t._uU(4),t.qZA(),t.TgZ(5,"th"),t._uU(6),t.qZA(),t.TgZ(7,"th"),t._uU(8),t.qZA(),t.TgZ(9,"th"),t._uU(10),t.qZA(),t.TgZ(11,"th"),t.TgZ(12,"a",9),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).onActionView(a,"edit")}),t._UZ(13,"span",10),t.qZA(),t.TgZ(14,"a",11),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).onActionView(a,"delete")}),t._UZ(15,"span",12),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=c.$implicit;t.xp6(2),t.hij(" ",e.buildingDescription," "),t.xp6(2),t.hij(" ",e.typeOfBuildingValue," "),t.xp6(2),t.hij(" ",e.occupationOfBuildingValue," "),t.xp6(2),t.hij(" ",e.buildingClassValue," "),t.xp6(2),t.hij(" ",e.premiumRate," ")}}function pi(o,c){if(1&o&&(t.TgZ(0,"tbody"),t.YNc(1,ui,16,5,"tr",8),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.surrounding)}}let gi=(()=>{class o{constructor(e,i,n,a){this.surroundingBuildingService=e,this.modalService=i,this.cdf=n,this.alertService=a,this.riskId=1,this.ELEMENT_COL=JSON.parse(JSON.stringify(ci)),this.displayedColumns=JSON.parse(JSON.stringify(li)),this.isPopup=!1,this.surrounding=[]}ngOnInit(){this.getList()}getList(){this.surroundingBuildingService.getByRiskId(this.riskId).toPromise().then(e=>{e&&(this.surrounding=e,this.cdf.detectChanges())})}add(e,i){let n;n=this.modalService.open(di,{size:"xl",backdrop:!1}),n.componentInstance.type=e,n.componentInstance.riskId=this.riskId,n.componentInstance.oldData=i,n.result.then(()=>{},a=>{if(a&&"save"==a.type){let r=i||{id:0},s=this.surrounding.findIndex(d=>d.id==r.id);s<0?this.surrounding.push(a.data):this.surrounding[s]=a.data,this.cdf.detectChanges()}})}onActionView(e,i){"delete"==i?this.alertService.activate("Are you sure want to delete?","Warning Message").then(n=>{n&&(this.surroundingBuildingService.delete(e.id).toPromise().then(a=>{if(a){let r=this.surrounding.findIndex(s=>s.id==e.id);r>=0&&(this.surrounding.splice(r,1),this.cdf.detectChanges())}}),this.alertService.activate("This record was deleted","Success Message").then(a=>{}))}):this.add(i,e)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(lt),t.Y36(g.FF),t.Y36(t.sBO),t.Y36(w.c))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-surrounding-building"]],viewQuery:function(e,i){if(1&e&&t.Gf(si.I,5),2&e){let n;t.iGM(n=t.CRH())&&(i.matTable=n.first)}},inputs:{riskId:"riskId"},decls:25,vars:1,consts:[[1,"row",2,"align-items","center","margin","10px 0px"],[1,"col-sm-8"],[1,"col-sm-6","left-border-image"],[1,"col-sm-4"],["type","button",1,"btn","btn-primary","btn-sm","mx-2","ft-right",3,"click"],[1,"table-responsive","angular-bootstrap-table"],[1,"table","table-head-custom","table-vertical-center"],[4,"ngIf"],[4,"ngFor","ngForOf"],["title","Edit Form Page",1,"btn","btn-primary","btn-cus","btn-sm","mx-1",3,"click"],[1,"flaticon-edit"],["title","Delete Form Page",1,"btn","btn-danger","btn-cus","btn-sm","mx-1",3,"click"],[1,"flaticon-delete"]],template:function(e,i){1&e&&(t.TgZ(0,"div"),t.TgZ(1,"div",0),t.TgZ(2,"div",1),t.TgZ(3,"label",2),t._uU(4,"Surrounding Building "),t.qZA(),t.qZA(),t.TgZ(5,"div",3),t.TgZ(6,"button",4),t.NdJ("click",function(){return i.add("create")}),t._uU(7,"Add New Data"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"div",5),t.TgZ(9,"table",6),t.TgZ(10,"thead"),t.TgZ(11,"tr"),t.TgZ(12,"th"),t._uU(13,"Building Description"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Type of Building"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Occupation"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Class"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Premium Rate"),t.qZA(),t.TgZ(22,"th"),t._uU(23,"Action"),t.qZA(),t.qZA(),t.qZA(),t.YNc(24,pi,2,1,"tbody",7),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(24),t.Q6J("ngIf",i.surrounding.length>0))},directives:[_.O5,_.sg],styles:[".ft-right[_ngcontent-%COMP%]{float:right}.tx-right[_ngcontent-%COMP%]{text-align:right}"]}),o})();function mi(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",41),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleAccordion("DETAIL")}),t._UZ(1,"span",42),t.qZA()}}function _i(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",43),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleAccordion("DETAIL")}),t._UZ(1,"span",44),t.qZA()}}function hi(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleAccordion("BUILDING")}),t._UZ(1,"span",42),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",!e.step1Com)}}function fi(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",46),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleAccordion("BUILDING")}),t._UZ(1,"span",44),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",!e.step1Com)}}function vi(o,c){if(1&o){const e=t.EpF();t.ynx(0),t._UZ(1,"app-surrounding-building",47),t.TgZ(2,"app-calculated-building",48),t.NdJ("totalEvent",function(n){return t.CHM(e),t.oxw(2).changeTotal(n)}),t.qZA(),t.TgZ(3,"div",33),t.TgZ(4,"button",49),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).step2Done()}),t._uU(5,"Next"),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("riskId",e.oldData.id),t.xp6(1),t.Q6J("riskId",e.oldData.id)("default",e.buildingSi)}}function Zi(o,c){if(1&o&&(t.ynx(0),t.TgZ(1,"div",10),t.YNc(2,vi,6,3,"ng-container",37),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngClass","BUILDING"==e.activeBox?"active":"inactive"),t.xp6(1),t.Q6J("ngIf",e.oldData.id)}}function Ci(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleAccordion("ADDON")}),t._UZ(1,"span",42),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",!e.step2Com)}}function bi(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",46),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleAccordion("ADDON")}),t._UZ(1,"span",44),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",!e.step2Com)}}function Ti(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",10),t.TgZ(2,"app-addon-page",50),t.NdJ("actionEvent",function(){return t.CHM(e),t.oxw().step3Done()}),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngClass","ADDON"==e.activeBox?"active":"inactive"),t.xp6(1),t.Q6J("product",e.product)("optionId",e.oldData.id)("editData",e.editData)("resourcesId",e.resourcesId)("fireAdd",!0)}}const Di=function(){return{prefix:"",thousands:",",precision:0,allowNegative:!1,align:"left"}};let Ai=(()=>{class o{constructor(e,i,n,a,r,s,d,u,m,h,f){this.modalService=e,this.modal=i,this.masterDataService=n,this.cdf=a,this.fireRiskService=r,this.auth=s,this.PremiumRateService=d,this.prodService=u,this.globalService=m,this.fireRiskRate=h,this.firebuildingService=f,this.typeOfBuildingOption=[],this.occupationOfBuildingOption=[],this.occupationOfBuildingOptions=[],this.buildingClassOption=[],this.roofOption=[],this.wallOption=[],this.floorClassOption=[],this.premiumRateOption=[],this.type="create",this.resourcesId="",this.oldData={},this.premiumAmt="",this.viewPage="form",this.buildingSi=0,this.riskSi=0,this.otherSi=0,this.fireRate=0,this.productDetail={},this.fireContentSi=0,this.firePlatSi=0,this.fireStockSi=0,this.activeBox="DETAIL",this.step1Com=!1,this.step2Com=!1,this.step3Com=!1}ngOnInit(){this.loadForm(),this.getBuildingClass(),this.getBuildingType(),this.getBuildingOccupation(),this.getRoof(),this.getWall(),this.getFloor(),this.productDetail=this.globalService.tempFormData[C.T$]||{},"create"==this.type?this.loadForm():(this.loadForm(this.oldData),this.oldData.id&&(this.getFirePlant(),this.getFireStock(),this.getFireContent()))}getBuildingClass(){this.masterDataService.getDataByType("BUILDING_CLASS").pipe((0,R.U)(e=>this.getFormatOpt(e))).toPromise().then(e=>{e&&(this.buildingClassOption=e,this.cdf.detectChanges())})}getBuildingType(){this.masterDataService.getDataByType("TYPE_OF_BUILDING").pipe((0,R.U)(e=>this.getFormatOpt(e))).toPromise().then(e=>{e&&(this.typeOfBuildingOption=e,this.cdf.detectChanges())})}getRoof(){this.masterDataService.getDataByType("CONTRUCTION_OF_ROOF").pipe((0,R.U)(e=>this.getFormatOpt(e))).toPromise().then(e=>{e&&(this.roofOption=e,this.cdf.detectChanges())})}getWall(){this.masterDataService.getDataByType("CONTRUCTION_OF_WALLS").pipe((0,R.U)(e=>this.getFormatOpt(e))).toPromise().then(e=>{e&&(this.wallOption=e,this.cdf.detectChanges())})}getFloor(){this.masterDataService.getDataByType("CONTRUCTION_OF_FLOOR").pipe((0,R.U)(e=>this.getFormatOpt(e))).toPromise().then(e=>{e&&(this.floorClassOption=e,this.cdf.detectChanges())})}getBuildingOccupation(){this.masterDataService.getDataByType("OCCUPATION_OF_BUILDING").pipe((0,R.U)(e=>this.getFormatOpt(e))).toPromise().then(e=>{if(e){this.occupationOfBuildingOptions=e;let i=this.fireRiskform.value.occupationOfBuilding,n=this.fireRiskform.value.typeOfBuilding;i&&n&&(this.occupationOfBuildingOption=this.occupationOfBuildingOptions.filter(r=>r.parent==n),this.occupationOfBuildingOption.findIndex(r=>r.code==i)<0&&this.fireRiskform.controls.occupationOfBuilding.setValue(null)),this.cdf.detectChanges()}})}getFormatOpt(e){return e.map(i=>({code:i.codeId,value:i.codeName||i.codeValue,parent:i.parentId}))}calcuRate(e){let i=this.fireRiskform.value.buildingClass,n=this.fireRiskform.value.occupationOfBuilding,a=this.fireRiskform.value.typeOfBuilding;"child"==e&&(this.occupationOfBuildingOption=this.occupationOfBuildingOptions.filter(s=>s.parent==a),this.occupationOfBuildingOption.findIndex(s=>s.code==n)<0&&this.fireRiskform.controls.occupationOfBuilding.setValue(null)),i&&n&&a&&this.getPremiumRate()}getPremiumRate(){this.PremiumRateService.getPremiumRate(this.fireRiskform.value.buildingClass,this.fireRiskform.value.occupationOfBuilding,this.fireRiskform.value.typeOfBuilding).toPromise().then(a=>{a&&this.fireRiskform.controls.rate.setValue(a.premiumRate)})}loadForm(e){this.fireRiskform=new l.cw({buildingClass:new l.NI(e?e.buildingClass:"",l.kI.required),buildingDescription:new l.NI(e?e.buildingDescription:"",l.kI.required),occupationOfBuilding:new l.NI(e?e.occupationOfBuilding:"",l.kI.required),typeOfBuilding:new l.NI(e?e.typeOfBuilding:"",l.kI.required),constructionOfFloor:new l.NI(e?e.constructionOfFloor:"",l.kI.required),constructionOfRoof:new l.NI(e?e.constructionOfRoof:"",l.kI.required),constructionOfWall:new l.NI(e?e.constructionOfWall:"",l.kI.required),height:new l.NI(e?e.height:"",l.kI.required),length:new l.NI(e?e.length:"",l.kI.required),width:new l.NI(e?e.width:"",l.kI.required),rate:new l.NI(e?e.rate:""),specialDecoration:new l.NI(e?e.specialDecoration:"",l.kI.required),storyOfBuilding:new l.NI(e?e.storyOfBuilding:"",l.kI.required),sumInsure:new l.NI(e?e.sumInsure:""),totalSquareFoot:new l.NI(e?e.totalSquareFoot:"",l.kI.required),yearOfConstruction:new l.NI(e?e.yearOfConstruction:"",[l.kI.required,l.kI.max(9999)]),buildingSi:new l.NI(e?e.buildingSi:0),riskSi:new l.NI(e?e.riskSi:0)}),this.riskSi=e?e.riskSi:0,this.buildingSi=e?e.buildingSi:0;let i=this.fireRiskform.value.occupationOfBuilding,n=this.fireRiskform.value.typeOfBuilding;e&&(this.step1Com=!!e.id),i&&n&&this.occupationOfBuildingOptions.length>0&&(this.occupationOfBuildingOption=this.occupationOfBuildingOptions.filter(r=>r.parent==n),this.occupationOfBuildingOption.findIndex(r=>r.code==i)<0&&this.fireRiskform.controls.occupationOfBuilding.setValue(null))}createRisk(e,i){if(this.fireRiskform.invalid)return(0,at.w)(this.fireRiskform),!0;let n=this.fireRiskform.getRawValue();this.step1Com=!0,!e&&!i&&(this.activeBox="BUILDING");let a=Object.assign(Object.assign(Object.assign({},this.oldData),n),{id:this.oldData.id,buildingSi:this.buildingSi,riskSi:this.riskSi,resourceData:{agentId:this.auth.currentUserValue.id||1,customerId:this.prodService.creatingCustomer.customerId||1,policyNumber:null,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,productId:this.prodService.createingProd.id,quotationId:this.prodService.referenceID,leadId:this.prodService.creatingLeadId||null,resourceId:this.resourcesId,type:this.prodService.type},resourceId:this.resourcesId});a.id?this.fireRiskService.updateNoID(a).toPromise().then(r=>{if(r){if(this.oldData=Object.assign({},a),this.viewPage="other",this.globalService.tempFormData[C.nm]){let s=this.globalService.tempFormData[C.nm].findIndex(d=>d.id==this.oldData.id);s<0?this.globalService.tempFormData[C.nm].push(this.oldData):this.globalService.tempFormData[C.nm][s]=this.oldData}else this.globalService.tempFormData[C.nm]=[this.oldData];i||this.calPremimun(!1),e&&this.modalService.dismissAll({data:a,type:"save"})}}):this.fireRiskService.save(a).toPromise().then(r=>{r&&(a.id=r,this.oldData=Object.assign({},a),this.viewPage="other",this.globalService.tempFormData[C.nm]?this.globalService.tempFormData[C.nm].push(this.oldData):this.globalService.tempFormData[C.nm]=[this.oldData],i||this.calPremimun(!1),e&&this.modal.dismiss({data:a,type:"save"}))})}viewOther(e){this.viewPage!=e&&(this.viewPage=e)}dismissModal(){this.modal.dismiss()}isControlValid(e){const i=this.fireRiskform.controls[e];return i.valid&&(i.dirty||i.touched)}isControlInvalid(e){const i=this.fireRiskform.controls[e];return i.invalid&&(i.dirty||i.touched)}controlHasError(e,i){const n=this.fireRiskform.controls[i];return n.hasError(e)&&(n.dirty||n.touched)}isControlTouched(e){const i=this.fireRiskform.controls[e];return i.dirty||i.touched}calcuSquare(){let e=this.fireRiskform.controls.width.value,i=this.fireRiskform.controls.length.value;e*i&&this.fireRiskform.controls.totalSquareFoot.setValue(e*i)}calBuildingSi(){console.log("enter SI"),this.buildingSi=0,this.buildingSi=this.oldData.sumInsure,0==this.otherSi&&(this.otherSi=this.fireContentSi+this.firePlatSi+this.fireStockSi),this.riskSi=this.otherSi+this.buildingSi,this.oldData&&(this.oldData.buildingSi=this.buildingSi,this.oldData.riskSi=this.riskSi)}changeTotal(e){this.otherSi=0,this.otherSi=e}calPremimun(e=!0){return(0,v.mG)(this,void 0,void 0,function*(){if(console.log("rateData,rate1,rate2,",this.oldData),this.oldData.id){"T-NM"==this.productDetail.policyType?yield this.calBuildingSi():(this.riskSi=this.oldData.proposeStockValue||0,this.oldData.riskSi=this.riskSi);let i=0,n=this.oldData.rate,a=yield this.firebuildingService.getMaxRate(this.oldData.id).toPromise(),r=a?a.rate:0;i=this.oldData.specialDecoration?1.3*n<r?1.3*n:(1.3*n+r)/2:n>r?n:(n+r)/2,this.oldData.premium=this.globalService.calculateDecimal(this.oldData.riskSi*(i/100)),this.createRisk(e,!0)}else this.modal.dismiss()})}getFireContent(){this.fireRiskService.getContent(this.oldData.id).toPromise().then(e=>{e&&(this.fireContentSi=0,e.forEach(i=>{this.fireContentSi+=parseFloat(i.totalValue)}))})}getFirePlant(){this.fireRiskService.getPlant(this.oldData.id).toPromise().then(e=>{e&&(this.firePlatSi=0,e.forEach(i=>{this.firePlatSi+=parseFloat(i.totalValue)}))})}getFireStock(){this.fireRiskService.getStock(this.oldData.id).toPromise().then(e=>{e&&(this.fireStockSi=0,e.forEach(i=>{this.fireStockSi+=parseFloat(i.stockValue)}))})}toggleAccordion(e){this.activeBox=e==this.activeBox?"":e}step2Done(){this.step2Com=!0,this.activeBox="ADDON";let e=this.stockTemp.stockData;e.length>0&&(this.oldData.proposeStockValue=e[0].agreedSi),this.calPremimun(!1)}step3Done(){this.activeBox="",this.step3Com=!0,this.calPremimun()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(g.FF),t.Y36(g.Kz),t.Y36(et.D),t.Y36(t.sBO),t.Y36(ct.U),t.Y36(U.e8),t.Y36(Tt),t.Y36(M.f),t.Y36(A.Q),t.Y36(ai),t.Y36(lt))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-risk-detail"]],viewQuery:function(e,i){if(1&e&&t.Gf(Ct,5),2&e){let n;t.iGM(n=t.CRH())&&(i.stockTemp=n.first)}},inputs:{product:"product",editData:"editData",oldData:"oldData"},decls:140,vars:77,consts:[[1,"modal-content"],[1,"modal-header"],["id","example-modal-sizes-title-lg",1,"modal-title","h4","left-border-image"],[1,"overlay","overlay-block","cursor-default","modal-body"],[1,"toggle-box"],[1,"toggle-header"],[1,"left-border-image"],[1,"tool-box"],["type","button","class","icon",3,"click",4,"ngIf"],["type","button","class","icon ml-2",3,"click",4,"ngIf"],[1,"toggle-body",3,"ngClass"],["action","#",1,"form",3,"formGroup","ngSubmit"],[1,"row",2,"align-items","center"],[1,"col-md-6"],[1,"form-group","row"],[1,"col-md-4","col-form-label"],[1,"col-md-8"],["type","text","name","buildingDescription","autocomplete","off","formControlName","buildingDescription",1,"form-control","form-control-sm"],["bindLabel","value","bindValue","code","formControlName","typeOfBuilding",1,"ng-custom-select",3,"items","change"],["bindLabel","value","bindValue","code","formControlName","occupationOfBuilding",1,"ng-custom-select",3,"items","change"],["bindLabel","value","bindValue","code","formControlName","buildingClass",1,"ng-custom-select",3,"items","change"],["bindLabel","value","bindValue","code","formControlName","constructionOfRoof",1,"ng-custom-select",3,"items"],["bindLabel","value","bindValue","code","formControlName","constructionOfWall",1,"ng-custom-select",3,"items"],["bindLabel","value","bindValue","code","formControlName","constructionOfFloor",1,"ng-custom-select",3,"items"],["type","number","name","storyOfBuilding","autocomplete","off","formControlName","storyOfBuilding",1,"form-control","form-control-sm"],["type","number","name","length","autocomplete","off","formControlName","length",1,"form-control","form-control-sm"],["type","number","name","height","autocomplete","off","formControlName","height",1,"form-control","form-control-sm",3,"change"],["type","number","name","width","autocomplete","off","formControlName","width",1,"form-control","form-control-sm",3,"change"],["type","number","name","totalSquareFoot","autocomplete","off","formControlName","totalSquareFoot",1,"form-control","form-control-sm"],["type","number","name","yearOfConstruction","autocomplete","off","formControlName","yearOfConstruction",1,"form-control","form-control-sm"],["formControlName","specialDecoration",1,"col-8"],[1,"mx-1",3,"value"],["type","tel","currencyMask","","name","sumInsure","autocomplete","off","formControlName","sumInsure",1,"form-control","form-control-sm",3,"options"],[1,"form-footer"],["type","submit",1,"btn","btn-primary","btn-elevate"],["type","button","class","icon",3,"disabled","click",4,"ngIf"],["type","button","class","icon ml-2",3,"disabled","click",4,"ngIf"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-2",3,"click"],["type","button",1,"btn","btn-primary","btn-elevate",3,"disabled","click"],["type","button",1,"icon",3,"click"],[1,"flaticon2-back"],["type","button",1,"icon","ml-2",3,"click"],[1,"flaticon2-down"],["type","button",1,"icon",3,"disabled","click"],["type","button",1,"icon","ml-2",3,"disabled","click"],[3,"riskId"],[3,"riskId","default","totalEvent"],["type","submit",1,"btn","btn-primary","btn-elevate",3,"click"],[3,"product","optionId","editData","resourcesId","fireAdd","actionEvent"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3," Fire Risk "),t.qZA(),t.qZA(),t.TgZ(4,"div",3),t.TgZ(5,"div",4),t.TgZ(6,"div",5),t.TgZ(7,"h4",6),t._uU(8,"Risk Detail"),t.qZA(),t.TgZ(9,"div",7),t.YNc(10,mi,2,0,"button",8),t.YNc(11,_i,2,0,"button",9),t.qZA(),t.qZA(),t.TgZ(12,"div",10),t.TgZ(13,"form",11),t.NdJ("ngSubmit",function(){return i.createRisk()}),t.TgZ(14,"div",12),t.TgZ(15,"div",13),t.TgZ(16,"div",14),t.TgZ(17,"label",15),t._uU(18,"Building Description"),t.qZA(),t.TgZ(19,"div",16),t._UZ(20,"textarea",17),t.qZA(),t.qZA(),t.qZA(),t.TgZ(21,"div",13),t.TgZ(22,"div",14),t.TgZ(23,"label",15),t._uU(24,"Type of Building"),t.qZA(),t.TgZ(25,"div",16),t.TgZ(26,"ng-select",18),t.NdJ("change",function(){return i.calcuRate("child")}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",12),t.TgZ(28,"div",13),t.TgZ(29,"div",14),t.TgZ(30,"label",15),t._uU(31,"Occupation of Building"),t.qZA(),t.TgZ(32,"div",16),t.TgZ(33,"ng-select",19),t.NdJ("change",function(){return i.calcuRate()}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(34,"div",13),t.TgZ(35,"div",14),t.TgZ(36,"label",15),t._uU(37,"Building Class"),t.qZA(),t.TgZ(38,"div",16),t.TgZ(39,"ng-select",20),t.NdJ("change",function(){return i.calcuRate()}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(40,"div",12),t.TgZ(41,"div",13),t.TgZ(42,"div",14),t.TgZ(43,"label",15),t._uU(44,"Construction of Roof"),t.qZA(),t.TgZ(45,"div",16),t._UZ(46,"ng-select",21),t.qZA(),t.qZA(),t.qZA(),t.TgZ(47,"div",13),t.TgZ(48,"div",14),t.TgZ(49,"label",15),t._uU(50,"Construction of Walls"),t.qZA(),t.TgZ(51,"div",16),t._UZ(52,"ng-select",22),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(53,"div",12),t.TgZ(54,"div",13),t.TgZ(55,"div",14),t.TgZ(56,"label",15),t._uU(57,"Construction of Floor"),t.qZA(),t.TgZ(58,"div",16),t._UZ(59,"ng-select",23),t.qZA(),t.qZA(),t.qZA(),t.TgZ(60,"div",13),t.TgZ(61,"div",14),t.TgZ(62,"label",15),t._uU(63,"No. of Story of Building"),t.qZA(),t.TgZ(64,"div",16),t._UZ(65,"input",24),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(66,"div",12),t.TgZ(67,"div",13),t.TgZ(68,"div",14),t.TgZ(69,"label",15),t._uU(70,"Length in Feet"),t.qZA(),t.TgZ(71,"div",16),t._UZ(72,"input",25),t.qZA(),t.qZA(),t.qZA(),t.TgZ(73,"div",13),t.TgZ(74,"div",14),t.TgZ(75,"label",15),t._uU(76,"Height in Feet"),t.qZA(),t.TgZ(77,"div",16),t.TgZ(78,"input",26),t.NdJ("change",function(){return i.calcuSquare()}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(79,"div",12),t.TgZ(80,"div",13),t.TgZ(81,"div",14),t.TgZ(82,"label",15),t._uU(83,"Width in Feet"),t.qZA(),t.TgZ(84,"div",16),t.TgZ(85,"input",27),t.NdJ("change",function(){return i.calcuSquare()}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(86,"div",13),t.TgZ(87,"div",14),t.TgZ(88,"label",15),t._uU(89,"Total Square in Feet"),t.qZA(),t.TgZ(90,"div",16),t._UZ(91,"input",28),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(92,"div",12),t.TgZ(93,"div",13),t.TgZ(94,"div",14),t.TgZ(95,"label",15),t._uU(96,"Year of Construction"),t.qZA(),t.TgZ(97,"div",16),t._UZ(98,"input",29),t.qZA(),t.qZA(),t.qZA(),t.TgZ(99,"div",13),t.TgZ(100,"div",14),t.TgZ(101,"label",15),t._uU(102,"Special Decoration"),t.qZA(),t.TgZ(103,"div",16),t.TgZ(104,"mat-radio-group",30),t.TgZ(105,"mat-radio-button",31),t._uU(106,"Yes "),t.qZA(),t.TgZ(107,"mat-radio-button",31),t._uU(108,"No "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(109,"div",12),t.TgZ(110,"div",13),t.TgZ(111,"div",14),t.TgZ(112,"label",15),t._uU(113,"Proposed Sum Insured"),t.qZA(),t.TgZ(114,"div",16),t._UZ(115,"input",32),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(116,"div",33),t.TgZ(117,"button",34),t._uU(118,"Next"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(119,"div",4),t.TgZ(120,"div",5),t.TgZ(121,"h4",6),t._uU(122,"Others"),t.qZA(),t.TgZ(123,"div",7),t.YNc(124,hi,2,1,"button",35),t.YNc(125,fi,2,1,"button",36),t.qZA(),t.qZA(),t.YNc(126,Zi,3,2,"ng-container",37),t.qZA(),t.TgZ(127,"div",4),t.TgZ(128,"div",5),t.TgZ(129,"h4",6),t._uU(130,"Addon"),t.qZA(),t.TgZ(131,"div",7),t.YNc(132,Ci,2,1,"button",35),t.YNc(133,bi,2,1,"button",36),t.qZA(),t.qZA(),t.YNc(134,Ti,3,6,"ng-container",37),t.qZA(),t.qZA(),t.TgZ(135,"div",38),t.TgZ(136,"button",39),t.NdJ("click",function(){return i.calPremimun()}),t._uU(137,"Cancel"),t.qZA(),t.TgZ(138,"button",40),t.NdJ("click",function(){return i.calPremimun()}),t._uU(139,"Save"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(10),t.Q6J("ngIf","DETAIL"==i.activeBox),t.xp6(1),t.Q6J("ngIf","DETAIL"!=i.activeBox),t.xp6(1),t.Q6J("ngClass","DETAIL"==i.activeBox?"active":"inactive"),t.xp6(1),t.Q6J("formGroup",i.fireRiskform),t.xp6(7),t.ekj("is-invalid",i.isControlInvalid("buildingDescription"))("is-valid",i.isControlValid("buildingDescription")),t.xp6(6),t.ekj("is-invalid",i.isControlInvalid("typeOfBuilding"))("is-valid",i.isControlValid("typeOfBuilding")),t.Q6J("items",i.typeOfBuildingOption),t.xp6(7),t.ekj("is-invalid",i.isControlInvalid("occupationOfBuilding"))("is-valid",i.isControlValid("occupationOfBuilding")),t.Q6J("items",i.occupationOfBuildingOption),t.xp6(6),t.ekj("is-invalid",i.isControlInvalid("buildingClass"))("is-valid",i.isControlValid("buildingClass")),t.Q6J("items",i.buildingClassOption),t.xp6(7),t.ekj("is-invalid",i.isControlInvalid("constructionOfRoof"))("is-valid",i.isControlValid("constructionOfRoof")),t.Q6J("items",i.roofOption),t.xp6(6),t.ekj("is-invalid",i.isControlInvalid("constructionOfWall"))("is-valid",i.isControlValid("constructionOfWall")),t.Q6J("items",i.wallOption),t.xp6(7),t.ekj("is-invalid",i.isControlInvalid("constructionOfFloor"))("is-valid",i.isControlValid("constructionOfFloor")),t.Q6J("items",i.floorClassOption),t.xp6(6),t.ekj("is-invalid",i.isControlInvalid("storyOfBuilding"))("is-valid",i.isControlValid("storyOfBuilding")),t.xp6(7),t.ekj("is-invalid",i.isControlInvalid("length"))("is-valid",i.isControlValid("length")),t.xp6(6),t.ekj("is-invalid",i.isControlInvalid("height"))("is-valid",i.isControlValid("height")),t.xp6(7),t.ekj("is-invalid",i.isControlInvalid("width"))("is-valid",i.isControlValid("width")),t.xp6(6),t.ekj("is-invalid",i.isControlInvalid("totalSquareFoot"))("is-valid",i.isControlValid("totalSquareFoot")),t.xp6(7),t.ekj("is-invalid",i.isControlInvalid("yearOfConstruction"))("is-valid",i.isControlValid("yearOfConstruction")),t.xp6(7),t.Q6J("value",!0),t.xp6(2),t.Q6J("value",!1),t.xp6(8),t.ekj("is-invalid",i.isControlInvalid("sumInsure"))("is-valid",i.isControlValid("sumInsure")),t.Q6J("options",t.DdM(76,Di)),t.xp6(9),t.Q6J("ngIf","BUILDING"==i.activeBox),t.xp6(1),t.Q6J("ngIf","BUILDING"!=i.activeBox),t.xp6(1),t.Q6J("ngIf",i.step1Com),t.xp6(6),t.Q6J("ngIf","ADDON"==i.activeBox),t.xp6(1),t.Q6J("ngIf","ADDON"!=i.activeBox),t.xp6(1),t.Q6J("ngIf",i.step2Com),t.xp6(4),t.Q6J("disabled",!i.step3Com))},directives:[_.O5,_.mk,l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,$.w9,l.wV,Q.VQ,Q.U0,rt.g1,gi,Ct,mt],styles:[".toggle-box[_ngcontent-%COMP%]{padding-bottom:1.75rem}.toggle-box[_ngcontent-%COMP%]   .toggle-header[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between;border-bottom:1px solid #E3E3E3}.toggle-box[_ngcontent-%COMP%]   .toggle-header[_ngcontent-%COMP%]   .tool-box[_ngcontent-%COMP%]{display:inline-block}.toggle-box[_ngcontent-%COMP%]   .toggle-header[_ngcontent-%COMP%]   .tool-box[_ngcontent-%COMP%]   button.icon[_ngcontent-%COMP%]{background:transparent;font-size:1.5rem}.toggle-box[_ngcontent-%COMP%]   .toggle-body[_ngcontent-%COMP%]{transition:1s all;padding:.5rem}.toggle-box[_ngcontent-%COMP%]   .toggle-body.active[_ngcontent-%COMP%]{display:block;height:auto;visibility:visible}.toggle-box[_ngcontent-%COMP%]   .toggle-body.inactive[_ngcontent-%COMP%]{display:none;visibility:hidden;overflow:hidden}.toggle-box[_ngcontent-%COMP%]   .toggle-body[_ngcontent-%COMP%]   .form-footer[_ngcontent-%COMP%]{text-align:right;padding:.9rem 0;border-bottom:1px solid #E3E3E3}"]}),o})();function Oi(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr"),t.TgZ(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"number"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"number"),t.qZA(),t.TgZ(10,"td"),t.TgZ(11,"a",9),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().newData("edit",a)}),t._UZ(12,"span",10),t.qZA(),t.TgZ(13,"a",11),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().delete(a)}),t._UZ(14,"span",12),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=c.$implicit;t.xp6(3),t.Oqu(e.buildingDescription),t.xp6(2),t.Oqu(t.lcZ(6,3,e.riskSi)),t.xp6(3),t.Oqu(t.lcZ(9,5,e.premium))}}let Pi=(()=>{class o{constructor(e,i,n,a,r,s,d){this.globalFun=e,this.fireRiskService=i,this.modalService=n,this.cdf=a,this.numberPipe=r,this.pageDataService=s,this.alertService=d,this.actionEvent=new t.vpe,this.premiumAmt="",this.listData=[]}ngOnInit(){this.getRiskList()}nextPage(){this.listData.length>0&&(this.globalFun.tempFormData[C.nm]=this.listData,this.savePremimunFire(),this.actionEvent.emit({type:T.V.NEXT}))}backPage(){this.listData.length>0&&(this.globalFun.tempFormData[C.nm]=this.listData,this.savePremimunFire()),this.actionEvent.emit({type:T.V.PREV})}getRiskList(){this.fireRiskService.getMany(this.resourcesId).toPromise().then(e=>{e&&(this.globalFun.tempFormData[C.nm]=e,this.listData=e||[],this.cdf.detectChanges())})}newData(e,i){let n;n=this.modalService.open(Ai,{size:"xl",backdrop:!1}),n.componentInstance.type=e,n.componentInstance.riskId=i?i.riskId:"",n.componentInstance.oldData=i||{},n.componentInstance.resourcesId=this.resourcesId,n.componentInstance.product=this.product,n.componentInstance.editData=this.editData,n.componentInstance.premiumAmt=this.premiumAmt,n.result.then(()=>{},a=>{if(a&&(console.log("RESSSS",a),"save"==a.type)){if(i){let r=this.listData.findIndex(s=>s.id==i.id);this.listData[r]=a.data}else{let r=this.listData.findIndex(s=>s.id==a.data.id);r>=0?this.listData[r]=a.data:this.listData.push(a.data)}this.cdf.detectChanges()}})}delete(e){this.alertService.activate("Are you sure want to delete?","Warning Message").then(i=>{i&&this.fireRiskService.delete(e.id).toPromise().then(n=>{if(n){let a=this.listData.findIndex(r=>r.id==e.id);a>=0&&(this.listData.splice(a,1),this.cdf.detectChanges(),this.alertService.activate("This record was deleted","Success Message").then(r=>{}))}})})}caluFirePremimun(){let e=this.globalFun.tempFormData[C.nm],i=this.globalFun.tempFormData[C.T$],n="T-NM"==i.policyType?1:.75,a=0,r=0;for(let u of e){a+=this.globalFun.calculateDecimal(u.premium);const m=this.globalFun.tempFormData["addon_1634010770155"+u.id];if(m)for(let h of m)r+=this.globalFun.calculateDecimal(h.premium)}let s=(a+r)*n,d=1;switch(!0){case"G"==i.durationType&&1==i.policyDuration:case"F"==i.durationType&&i.policyDuration>6:d=1;break;case"D"==i.durationType&&i.policyDuration<=10:d=1/8;break;case"D"==i.durationType&&i.policyDuration<=15:d=1/6;break;case"D"==i.durationType&&i.policyDuration>15:case"F"==i.durationType&&1==i.policyDuration:d=2/8;break;case"F"==i.durationType&&2==i.policyDuration:d=3/8;break;case"F"==i.durationType&&3==i.policyDuration:d=.5;break;case"F"==i.durationType&&4==i.policyDuration:d=5/8;break;case"F"==i.durationType&&5==i.policyDuration:case"F"==i.durationType&&6==i.policyDuration:d=6/8}return s=this.globalFun.calculateDecimal(s*d)+100,this.premiumAmt=this.numberPipe.transform(s)+" MMK",this.globalFun.paPremiumResult.next(this.premiumAmt),s}savePremimunFire(){this.caluFirePremimun();let i={premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,resourceId:this.resourcesId,type:"policy"};return this.pageDataService.updatePremimun(i)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.Q),t.Y36(ct.U),t.Y36(g.FF),t.Y36(t.sBO),t.Y36(_.JJ),t.Y36(j.Q),t.Y36(w.c))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-fire-risk"]],inputs:{product:"product",editData:"editData",resourcesId:"resourcesId"},outputs:{actionEvent:"actionEvent"},decls:24,vars:1,consts:[[1,"form-group"],["type","button",1,"btn","btn-primary","mx-2",3,"click"],[1,"table-responsive","angular-bootstrap-table"],[1,"table","table-head-custom","table-vertical-center"],[4,"ngFor","ngForOf"],[1,"row","mt-3"],[1,"col-sm-6","mx-auto"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"],["title","Edit",1,"btn","btn-primary","btn-cus","btn-sm","mx-1",3,"click"],[1,"flaticon-edit"],["title","Delete",1,"btn","btn-danger","btn-cus","btn-sm","mx-1",3,"click"],[1,"flaticon-delete"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"button",1),t.NdJ("click",function(){return i.newData("add")}),t._uU(2,"Add New Data"),t.qZA(),t.qZA(),t.TgZ(3,"div",2),t.TgZ(4,"table",3),t.TgZ(5,"thead"),t.TgZ(6,"tr"),t.TgZ(7,"th"),t._uU(8,"Building Description"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Sum Insured"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Premium "),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Action"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(15,"tbody"),t.YNc(16,Oi,15,7,"ng-container",4),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"div",5),t.TgZ(18,"div",6),t.TgZ(19,"button",7),t.NdJ("click",function(){return i.backPage()}),t._uU(20," Previous "),t.qZA(),t.qZA(),t.TgZ(21,"div",6),t.TgZ(22,"button",8),t.NdJ("click",function(){return i.nextPage()}),t._uU(23," Save & Next "),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(16),t.Q6J("ngForOf",i.listData))},directives:[_.sg],pipes:[_.JJ],styles:[""]}),o})();var G=p(21177),S=p(44290),it=p(92118),yi=p(75103),nt=p(57730),q=p(78480),ot=p(86031),dt=p(94115);let xi=(()=>{class o{constructor(e,i,n,a,r,s,d,u,m){this.fb=e,this.prodService=i,this.auth=n,this.fireService=a,this.globalFun=r,this.addOnQuoService=s,this.coverageQuoService=d,this.alertService=u,this.cdf=m,this.actionEvent=new t.vpe,this.toMinDate=null,this.fromMinDate=null,this.toMaxDate=null,this.fromMaxDate=null,this.dobMinDate=null,this.dobMaxDate=null,this.validValue=365,this.options=[],this.options2=[],this.addOns={},this.options3=[],this.options4=[],this.durtaionOption=[{code:"D",value:"Days"},{code:"F",value:"Months"},{code:"G",value:"Years"}],this.staticForm=this.fb.group({startDate:[null,l.kI.compose([l.kI.required])],endDate:[null,l.kI.compose([l.kI.required])],policyType:["T-001",l.kI.compose([l.kI.required])],policyDuration:[null,l.kI.compose([l.kI.required,l.kI.max(30)])],currency:["T-001",l.kI.compose([l.kI.required])],policyUnit:["D",l.kI.compose([l.kI.required])]}),this.options3=Array.from({length:10},(h,f)=>f+1)}updateValidation(){let e=this.staticForm.value.policyUnit;"D"==e?(this.staticForm.controls.policyDuration.clearValidators(),this.staticForm.controls.policyDuration.setValidators([l.kI.required,l.kI.max(30)]),this.staticForm.controls.policyDuration.updateValueAndValidity(),this.validValue=30,this.doValid()):"F"==e?(this.staticForm.controls.policyDuration.clearValidators(),this.staticForm.controls.policyDuration.setValidators([l.kI.required,l.kI.max(11)]),this.staticForm.controls.policyDuration.updateValueAndValidity(),this.validValue=11,this.doValid()):(this.staticForm.controls.policyDuration.clearValidators(),this.staticForm.controls.policyDuration.setValidators([l.kI.required,l.kI.max(1)]),this.staticForm.controls.policyDuration.updateValueAndValidity(),this.validValue=1,this.doValid())}ngOnInit(){return(0,v.mG)(this,void 0,void 0,function*(){this.options=this.product.coverages,this.options2=this.product.addOns,this.refID=this.prodService.referenceID;let e=O().subtract(5,"days");this.fromMinDate=e.format("YYYY-MM-DD"),this.toMinDate=e.format("YYYY-MM-DD");let i=O().subtract(6,"years");this.dobMaxDate=i.format("YYYY-MM-DD");let n=O().subtract(75,"years");this.dobMinDate=n.format("YYYY-MM-DD"),this.getOldData(),this.updateValidation()})}doValid(){let e=this.staticForm.controls.startDate.value,i=this.staticForm.controls.policyDuration.value,n=this.staticForm.controls.policyUnit.value;if(e&&i&&"D"==n){let a=O(this.staticForm.controls.startDate.value).add(i,"days");this.staticForm.controls.endDate.setValue(a)}else if(e&&i&&"F"==n){let a=O(this.staticForm.controls.startDate.value).add(i,"month");this.staticForm.controls.endDate.setValue(a)}else{let a=O(this.staticForm.controls.startDate.value).add(i,"year");this.staticForm.controls.endDate.setValue(a)}}calcuteDay(){let e=O(this.staticForm.controls.startDate.value),i=O(this.staticForm.controls.endDate.value),n=e.diff(i,"days")+1;this.staticForm.controls.policyDuration.setValue(n)}get controls(){return this.staticForm.controls}isControlValid(e,i){const n=i.controls[e];return n.valid&&(n.dirty||n.touched)}isControlInvalid(e,i){const n=i.controls[e];return n.invalid&&(n.dirty||n.touched)}controlHasError(e,i,n){const a=n.controls[i];return a.hasError(e)&&(a.dirty||a.touched)}isControlTouched(e,i){const n=i.controls[e];return n.dirty||n.touched}nextPage(){if(this.staticForm.invalid)return(0,at.w)(this.staticForm),!0;this.editId?this.saveData(this.editId):this.saveData()}backPage(){this.actionEvent.emit({type:T.V.PREV})}saveData(e){const i=this.staticForm.value;let n={id:e||null,endDate:O(i.endDate).format("YYYY-MM-DD"),startDate:O(i.startDate).format("YYYY-MM-DD"),policyType:i.policyType,policyDuration:i.policyDuration,currency:i.currency,policyUnit:i.policyUnit,resourceData:{agentId:this.auth.currentUserValue.id||1,customerId:this.prodService.creatingCustomer.customerId||1,policyNumber:null,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,productId:this.prodService.createingProd.id,quotationId:this.prodService.referenceID,leadId:this.prodService.creatingLeadId||null,type:this.prodService.type},resourceId:this.resourcesId};e?this.fireService.updateNoID(n).toPromise().then(a=>{a&&(this.editId=a.id,this.globalFun.tempFormData[C.T$]=Object.assign({id:a.id},n),this.actionEvent.emit({type:T.V.NEXT,data:Object.assign({},a)}))}).catch(a=>a):this.fireService.save(n).toPromise().then(a=>{a&&(this.editId=a.id,this.resourcesId=a.resourceId,this.globalFun.tempFormData[C.T$]=Object.assign({id:a.id},n),this.actionEvent.emit({type:T.V.NEXT,data:Object.assign({},a)}))}).catch(a=>a)}getOldData(e=!1){if(console.log(this.resourcesId),this.resourcesId||this.refID){let i=e?this.refID:this.resourcesId||this.refID;if(!i)return!1;this.fireService.getOne(i).toPromise().then(n=>{n?(this.oldData=Object.assign(Object.assign({},n),{id:null}),this.editId=i==this.resourcesId?n.id:null,this.reloadOldValueForm()):!e&&i!=this.refID&&this.getOldData(!0)})}}reloadOldValueForm(){this.staticForm.patchValue({startDate:O(this.oldData.startDate),endDate:O(this.oldData.endDate),policyType:this.oldData.policyType,policyDuration:this.oldData.policyDuration,currency:this.oldData.currency}),this.cdf.detectChanges()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(l.qu),t.Y36(M.f),t.Y36(U.e8),t.Y36(yi.V),t.Y36(A.Q),t.Y36(L.D),t.Y36(W.a),t.Y36(w.c),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-fire-simple-page"]],inputs:{product:"product",editData:"editData",resourcesId:"resourcesId",premiumAmt:"premiumAmt"},outputs:{actionEvent:"actionEvent"},features:[t._Bn([{provide:g.DO,useClass:G.Wv},{provide:g.NG,useClass:G.ke},{provide:S._A,useClass:it.t7,deps:[S.Ad]},{provide:S.sG,useValue:k.Gs}])],decls:63,vars:19,consts:[["action","",3,"formGroup"],[1,"row",2,"align-items","center"],[1,"col-sm-6"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"input-group"],["matInput","","formControlName","startDate","readonly","",1,"form-control-sm","date-input",3,"min","max","matDatepicker","dateChange"],["matSuffix","",3,"for"],["disabled","false"],["picker",""],[3,"control"],["matInput","","formControlName","endDate","readonly","",1,"form-control-sm","date-input",3,"min","max","matDatepicker"],["disabled","true"],["picker2",""],["type","text","name","policyDuration","formControlName","policyDuration",1,"form-control","form-control-sm",3,"change"],["bindLabel","value","bindValue","code","formControlName","policyUnit",1,"ng-custom-select",3,"items","change"],[3,"control","validValue"],[1,"example-section"],[1,"col-4"],["formControlName","policyType",1,"col-8"],[1,"mx-1",3,"value"],[1,"row"],["formControlName","currency",1,"col-8"],[1,"row","mt-3"],[1,"col-sm-6","mx-auto"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"]],template:function(e,i){if(1&e&&(t.TgZ(0,"form",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"label",4),t._uU(5,"Policy Effective Date"),t.qZA(),t.TgZ(6,"div",2),t.TgZ(7,"div",5),t.TgZ(8,"input",6),t.NdJ("dateChange",function(){return i.doValid()}),t.qZA(),t._UZ(9,"mat-datepicker-toggle",7),t._UZ(10,"mat-datepicker",8,9),t._UZ(12,"app-print-error",10),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"div",2),t.TgZ(14,"div",3),t.TgZ(15,"label",4),t._uU(16,"-"),t.qZA(),t.TgZ(17,"div",2),t.TgZ(18,"div",5),t._UZ(19,"input",11),t._UZ(20,"mat-datepicker-toggle",7),t._UZ(21,"mat-datepicker",12,13),t._UZ(23,"app-print-error",10),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(24,"div",1),t.TgZ(25,"div",2),t.TgZ(26,"div",3),t.TgZ(27,"label",4),t._uU(28,"Policy Duration"),t.qZA(),t.TgZ(29,"div",2),t.TgZ(30,"div",5),t.TgZ(31,"input",14),t.NdJ("change",function(){return i.doValid()}),t.qZA(),t._UZ(32,"mat-datepicker-toggle",7),t.TgZ(33,"ng-select",15),t.NdJ("change",function(){return i.updateValidation()}),t.qZA(),t.qZA(),t._UZ(34,"app-print-error",16),t.qZA(),t.qZA(),t.qZA(),t.TgZ(35,"div",2),t.TgZ(36,"section",17),t.TgZ(37,"div",3),t.TgZ(38,"label",18),t._uU(39,"Policy Type"),t.qZA(),t.TgZ(40,"mat-radio-group",19),t.TgZ(41,"mat-radio-button",20),t._uU(42,"Normal "),t.qZA(),t.TgZ(43,"mat-radio-button",20),t._uU(44,"Declaration "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(45,"div",21),t.TgZ(46,"div",2),t.TgZ(47,"section",17),t.TgZ(48,"div",3),t.TgZ(49,"label",18),t._uU(50,"Currency"),t.qZA(),t.TgZ(51,"mat-radio-group",22),t.TgZ(52,"mat-radio-button",20),t._uU(53,"MMK "),t.qZA(),t.TgZ(54,"mat-radio-button",20),t._uU(55,"USD "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(56,"div",23),t.TgZ(57,"div",24),t.TgZ(58,"button",25),t.NdJ("click",function(){return i.backPage()}),t._uU(59," Previous "),t.qZA(),t.qZA(),t.TgZ(60,"div",24),t.TgZ(61,"button",26),t.NdJ("click",function(){return i.nextPage()}),t._uU(62," Save & Next "),t.qZA(),t.qZA(),t.qZA()),2&e){const n=t.MAs(11),a=t.MAs(22);t.Q6J("formGroup",i.staticForm),t.xp6(8),t.Q6J("min",i.fromMinDate)("max",i.fromMaxDate)("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(3),t.Q6J("control",i.controls.startDate),t.xp6(7),t.Q6J("min",i.toMinDate)("max",i.toMaxDate)("matDatepicker",a),t.xp6(1),t.Q6J("for",a),t.xp6(3),t.Q6J("control",i.controls.endDate),t.xp6(9),t.Q6J("for",a),t.xp6(1),t.Q6J("items",i.durtaionOption),t.xp6(1),t.Q6J("control",i.controls.policyDuration)("validValue",i.validValue),t.xp6(7),t.Q6J("value","T-NM"),t.xp6(2),t.Q6J("value","T-DM"),t.xp6(9),t.Q6J("value","MMK"),t.xp6(2),t.Q6J("value","USD")}},directives:[l._Y,l.JL,l.sg,nt.Nt,l.Fj,q.hl,l.JJ,l.u,q.nW,ot.R9,q.Mq,dt.n,$.w9,Q.VQ,Q.U0],styles:[".input-group[_ngcontent-%COMP%]   .form-control-sm[_ngcontent-%COMP%]{background-color:#fff;background-clip:padding-box;border:1px solid #E4E6EF;padding:0 .75rem}.input-group[_ngcontent-%COMP%]   .mat-datepicker-toggle[_ngcontent-%COMP%]{position:absolute;right:5px}"]}),o})();const Ot=`${N.N.apiUrl}/health/coverage-rate`;let Ii=(()=>{class o extends J.i{constructor(e){super(e,Ot),this.httpClient=e}getOne(e,i){return this.httpClient.get(Ot+"?age="+e+"&cover="+i)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(E.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Pt=p(93931);function Mi(o,c){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.qZA()),2&o){const e=c.$implicit;t.xp6(2),t.Oqu("HEALTH"==e.keyName?"Health":"Critical Illness"),t.xp6(2),t.hij("",e.value," Units")}}function wi(o,c){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"number"),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.ALo(8,"number"),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"number"),t.qZA(),t.qZA()),2&o){const e=c.$implicit,i=c.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(t.lcZ(5,4,e.premium)),t.xp6(3),t.Oqu(t.lcZ(8,6,e.levy)),t.xp6(3),t.Oqu(t.lcZ(11,8,e.premium+e.levy))}}let qi=(()=>{class o{constructor(e,i,n,a,r,s,d,u){this.globalFun=e,this.alertService=i,this.healthRateService=n,this.healthPayService=a,this.cdf=r,this.auth=s,this.prodService=d,this.numberPipe=u,this.actionEvent=new t.vpe,this.showData=[],this.schedule=[],this.tempSchedule=[],this.totalP=0,this.totalL=0}ngOnInit(){this.parentData=this.globalFun.tempFormData[C.Hu],this.parentData?(this.showData.push({keyName:this.parentData.basicCoverId,value:this.parentData.sumInsuredMainCover}),this.parentData.addOns&&"CRTILLNESS"!=this.parentData.basicCoverId&&this.product.addOns.forEach(e=>{this.parentData.addOns[e.id+"opt"]&&this.showData.push({keyName:e.description,value:this.parentData.addOns[e.id+"value"]})}),this.calculateSchedule()):this.alertService.activate("This page cann't to show because there is no health product detail data. Please add health product detail in prodcut configuration","Warning")}calculateSchedule(){this.totalP=0,this.totalL=0;let e=300,n=Math.ceil(O().diff(this.parentData.dateOfBirth,"years",!0));this.healthRateService.getOne(n,this.parentData.basicCoverId).toPromise().then(a=>{if(a){if("L"==this.parentData.paymentFrequency){let s=a.lumpSum*this.parentData.sumInsuredMainCover,d=e*this.parentData.sumInsuredMainCover;this.totalP=this.totalP+s,this.totalL=d,this.schedule.push({premium:s,coverage:this.parentData.basicCoverId,sumInsured:this.parentData.sumInsuredMainCover,levy:d}),e=0}else{let s=a.semiAnnual*this.parentData.sumInsuredMainCover,d=e*this.parentData.sumInsuredMainCover;this.totalP=this.totalP+s,this.totalP=this.totalP+s,this.totalL=d,this.schedule.push({premium:s,coverage:this.parentData.basicCoverId,sumInsured:this.parentData.sumInsuredMainCover,levy:d}),e=0,this.schedule.push({premium:s,coverage:this.parentData.basicCoverId,sumInsured:this.parentData.sumInsuredMainCover,levy:0})}let r=this.globalFun.calculateDecimal(this.totalP/12)+this.totalL;if(this.schedule.length>0)if("L"==this.schedule[0].paymentTerm)this.tempSchedule=[{premium:this.totalP,levy:this.totalL,total:this.totalP+this.totalL}];else{let s=this.totalP/2;this.tempSchedule=[{premium:s,levy:this.totalL,total:s+this.totalL},{premium:s,levy:0,total:s}]}this.premiumAmt=this.numberPipe.transform(r)+" MMK / month",this.globalFun.paPremiumResult.next(this.premiumAmt),"CRTILLNESS"==this.parentData.basicCoverId?this.cdf.detectChanges():this.calculateScheduleAddOn(n)}})}calculateScheduleAddOn(e){let i=0;this.product.addOns.forEach(n=>{if(this.parentData.addOns[n.id+"opt"]){let a=this.parentData.addOns[n.id+"value"];i+=1,this.healthRateService.getOne(e,n.code).toPromise().then(r=>{if(r)if("L"==this.parentData.paymentFrequency){let s=r.lumpSum*a;this.totalP=this.totalP+s,this.schedule.push({premium:s,coverage:n.code,sumInsured:a,levy:0})}else{let s=r.semiAnnual*a;this.totalP=this.totalP+s,this.totalP=this.totalP+s,this.schedule.push({premium:s,coverage:n.code,sumInsured:a,levy:0}),this.schedule.push({premium:s,coverage:n.code,sumInsured:a,levy:0})}if(i==this.product.addOns.length){let s=this.globalFun.calculateDecimal(this.totalP/12)+this.totalL;this.premiumAmt=this.numberPipe.transform(s)+" MMK / month",this.globalFun.paPremiumResult.next(this.premiumAmt),this.cdf.detectChanges()}}).catch(r=>{i==this.product.addOns.length&&this.cdf.detectChanges()})}})}nextPage(){return(0,v.mG)(this,void 0,void 0,function*(){let e=this.globalFun.calculateDecimal(this.totalP/12)+this.totalL;this.premiumAmt=this.numberPipe.transform(e)+" MMK / month",this.globalFun.paPremiumResult.next(this.premiumAmt),this.healthPayService.deleteMany(this.resourcesId).pipe((0,X.z)(i=>{let n={resourceData:{agentId:this.auth.currentUserValue.id||1,customerId:this.prodService.creatingCustomer.customerId||1,policyNumber:null,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,productId:this.product.id,quotationId:this.prodService.referenceID,type:this.prodService.type,leadId:this.prodService.creatingLeadId},resourceId:this.resourcesId,requests:[]};return n.requests=this.schedule.map(a=>({paymentTerm:this.parentData.paymentFrequency,plan:this.parentData.basicCoverId,premium:a.premium,levy:a.levy,coverage:a.coverage,sumInsured:a.sumInsured,resourceId:this.resourcesId,total:a.levy+a.premium})),this.healthPayService.saveAll(n)})).toPromise().then(i=>{i&&this.actionEvent.emit({type:T.V.NEXT})})})}backPage(){this.actionEvent.emit({type:T.V.PREV})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.Q),t.Y36(w.c),t.Y36(Ii),t.Y36(Pt.q),t.Y36(t.sBO),t.Y36(U.e8),t.Y36(M.f),t.Y36(_.JJ))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-health-quo"]],inputs:{product:"product",editData:"editData",resourcesId:"resourcesId",premiumAmt:"premiumAmt"},outputs:{actionEvent:"actionEvent"},decls:46,vars:11,consts:[[1,"table","table-bordered"],[4,"ngFor","ngForOf"],[1,""],[2,"text-align","right"],[1,"tbody-align"],[1,"row","mt-3"],[1,"col-sm-6","mx-auto"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"table",0),t.TgZ(1,"thead"),t.TgZ(2,"tr"),t.TgZ(3,"th"),t._uU(4," Coverages/Benefit "),t.qZA(),t.TgZ(5,"th"),t._uU(6," Sum Insured "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"tbody"),t.YNc(8,Mi,5,2,"tr",1),t.qZA(),t.qZA(),t._UZ(9,"hr"),t.TgZ(10,"h5",2),t._uU(11,"Payment Schedules"),t.qZA(),t.TgZ(12,"table",0),t.TgZ(13,"thead"),t.TgZ(14,"tr"),t.TgZ(15,"th"),t._uU(16," No. of Installment "),t.qZA(),t.TgZ(17,"th",3),t._uU(18," Premium "),t.qZA(),t.TgZ(19,"th",3),t._uU(20," Levy "),t.qZA(),t.TgZ(21,"th",3),t._uU(22," Total "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"tbody",4),t.YNc(24,wi,12,10,"tr",1),t.qZA(),t.TgZ(25,"tfoot",4),t.TgZ(26,"tr"),t.TgZ(27,"td"),t.TgZ(28,"b"),t._uU(29,"Total"),t.qZA(),t.qZA(),t.TgZ(30,"td"),t._uU(31),t.ALo(32,"number"),t.qZA(),t.TgZ(33,"td"),t._uU(34),t.ALo(35,"number"),t.qZA(),t.TgZ(36,"td"),t._uU(37),t.ALo(38,"number"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(39,"div",5),t.TgZ(40,"div",6),t.TgZ(41,"button",7),t.NdJ("click",function(){return i.backPage()}),t._uU(42," Previous "),t.qZA(),t.qZA(),t.TgZ(43,"div",6),t.TgZ(44,"button",8),t.NdJ("click",function(){return i.nextPage()}),t._uU(45," Save & Next "),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(8),t.Q6J("ngForOf",i.showData),t.xp6(16),t.Q6J("ngForOf",i.tempSchedule),t.xp6(7),t.Oqu(t.lcZ(32,5,i.totalP)),t.xp6(3),t.Oqu(t.lcZ(35,7,i.totalL)),t.xp6(3),t.Oqu(t.lcZ(38,9,i.totalP+i.totalL)))},directives:[_.sg],pipes:[_.JJ],styles:[""]}),o})();var Fi=p(74464);function ki(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",8),t.TgZ(1,"div",2),t.TgZ(2,"div",13),t.TgZ(3,"div",14),t.TgZ(4,"ng-select",15),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().planOption=n})("change",function(){return t.CHM(e),t.oxw().changePlan()}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(5,"div",2),t.TgZ(6,"label",16),t._uU(7,"Premium : "),t.TgZ(8,"span"),t._uU(9),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(4),t.Q6J("ngModel",e.planOption)("items",e.planOptionOption),t.xp6(5),t.Oqu(e.medPremium)}}function Si(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",8),t.TgZ(1,"div",17),t.TgZ(2,"div",13),t.TgZ(3,"label",18),t._uU(4,"Start Date"),t.qZA(),t.TgZ(5,"div",14),t.TgZ(6,"div",19),t.TgZ(7,"input",20),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().startDate=n}),t.qZA(),t._UZ(8,"mat-datepicker-toggle",21),t._UZ(9,"mat-datepicker",22,23),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"div",17),t.TgZ(12,"div",13),t.TgZ(13,"label",18),t._uU(14,"End Date"),t.qZA(),t.TgZ(15,"div",14),t.TgZ(16,"div",19),t.TgZ(17,"input",20),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().endDate=n}),t.qZA(),t._UZ(18,"mat-datepicker-toggle",21),t._UZ(19,"mat-datepicker",22,24),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.MAs(10),i=t.MAs(20),n=t.oxw();t.xp6(7),t.Q6J("ngModel",n.startDate)("matDatepicker",e),t.xp6(1),t.Q6J("for",e),t.xp6(9),t.Q6J("ngModel",n.endDate)("matDatepicker",i),t.xp6(1),t.Q6J("for",i)}}function Ni(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",8),t.TgZ(1,"div",17),t.TgZ(2,"div",13),t.TgZ(3,"label",18),t._uU(4,"Source Place"),t.qZA(),t.TgZ(5,"div",14),t.TgZ(6,"input",25),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().option1=n}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"div",17),t.TgZ(8,"div",13),t.TgZ(9,"label",18),t._uU(10,"Destination Place"),t.qZA(),t.TgZ(11,"div",14),t.TgZ(12,"input",26),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().option2=n}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"div",17),t.TgZ(14,"div",13),t.TgZ(15,"label",16),t._uU(16,"Premium : "),t.TgZ(17,"span"),t._uU(18),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(6),t.Q6J("disabled",!0)("ngModel",e.option1),t.xp6(6),t.Q6J("disabled",!0)("ngModel",e.option2),t.xp6(6),t.hij("$",e.crossPremium,"")}}let Ui=(()=>{class o{constructor(e,i,n,a,r,s){this.globalFun=e,this.prodService=i,this.numberPipe=n,this.addOnQuoService=a,this.pageDataService=r,this.cdf=s,this.actionEvent=new t.vpe,this.premiumAmt="",this.primary="primary",this.isMedical=!1,this.isCross=!1,this.planOption="basic",this.planOptionOption=[{code:"basic",value:"Basic Plan"},{code:"special",value:"Special Plan"}],this.option1="Digital Source Place",this.option2="Digital Destination Place",this.parentData={},this.addOnsData={}}ngOnInit(){this.parentData=this.getParnet()}getParnet(e="m_detail"){if((0,k.cU)(this.product.config)){let i=JSON.parse(this.product.config),a=("quotation"!=this.prodService.type?i.application||[]:i.quotation||[]).find(r=>r.tableName==e);return a&&this.globalFun.tempFormData[a.tableName+a.id]||null}return null}toggleChange(e){"medical"==e&&(this.isMedical=!this.isMedical,this.changePlan(),this.cdf.detectChanges()),"cross"==e&&(this.isCross=!this.isCross,this.crossPremium=this.isCross?this.calcuCross():0,this.cdf.detectChanges())}changePlan(){this.medPremium=this.calcumotorMedical()}calcumotorMedical(){let e=0;return e="basic"==this.planOption?20:30,e}calcuCross(){let e=0,i=this.globalFun.tempFormData.addon_1634010770155;for(let s of i)this.addOnsData[s.id]&&(e+=this.globalFun.calculateDecimal(this.addOnsData[s.id].premium||0));this.isMedical&&(e+=this.globalFun.calculateDecimal(this.medPremium));let n=this.globalFun.tempFormData.coverage_1634010995936?this.globalFun.tempFormData.coverage_1634010995936:[];for(let s of n)e+=this.globalFun.calculateDecimal(s.premium||0);let r=0;if(this.parentData){let s=this.parentData.m_excess;"T-NILEX"==s&&"MMK"==(this.parentData?this.parentData.m_currency:"MMK")?r=5e4:"TU-NILEX"==s&&(r=25)}return e+r}backPage(){this.actionEvent.emit({type:T.V.PREV})}nextPage(){return(0,v.mG)(this,void 0,void 0,function*(){const e=this.addOnQuoService;if(this.isMedical){let i=this.product.addOns.find(n=>"MED"==n.code);if(this.medPremium="string"!=typeof this.medPremium?this.medPremium+"":this.medPremium,i){let n={addonId:i.id,quotationNo:this.resourcesId,optionalKey:this.resourcesId,premium:this.medPremium.replace(",","").replace("MMK","").replace("USD",""),option:this.planOption};yield e.save(n).toPromise(),this.globalFun.tempFormData.addon_1634010770155?this.globalFun.tempFormData.addon_1634010770155.push(n):this.globalFun.tempFormData.addon_1634010770155=[n]}}if(this.isCross){let i=this.product.addOns.find(n=>"CROSSBRDR"==n.code);if(this.crossPremium="string"!=typeof this.crossPremium?this.crossPremium+"":this.crossPremium,i){let n={addonId:i.id,quotationNo:this.resourcesId,optionalKey:this.resourcesId,premium:this.crossPremium.replace(",","").replace("MMK","").replace("USD",""),startDate:this.startDate,endDate:this.endDate,option:this.option1,option2:this.option2};yield e.save(n).toPromise(),this.globalFun.tempFormData.addon_1634010770155?this.globalFun.tempFormData.addon_1634010770155.push(n):this.globalFun.tempFormData.addon_1634010770155=[n]}}this.savePremimun(),this.actionEvent.emit({type:T.V.NEXT})})}savePremimun(){this.caluMotorPremimun();let i={premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,resourceId:this.resourcesId,type:this.prodService.viewType};return this.pageDataService.updatePremimun(i)}caluMotorPremimun(){let e=0,i=this.globalFun.tempFormData.addon_1634010770155||[];for(let u of i)e+=this.globalFun.calculateDecimal(u.premium||0);let n=this.globalFun.tempFormData.coverage_1634010995936?this.globalFun.tempFormData.coverage_1634010995936:[];for(let u of n)e+=this.globalFun.calculateDecimal(u.premium||0);let a=this.parentData?this.parentData.m_currency:"MMK",r=0;if(this.parentData){let u=this.parentData.m_excess,m=this.parentData.excess_discount;"T-NILEX"==u&&"MMK"==a?r=-5e4:"TU-NILEX"==u?r=-25:"T-ED"==u&&"MMK"==a&&("T-EXD1"==m?r=5e4:"T-EXD2"==m?r=7e4:"T-EXD3"==m&&(r=1e5))}let d=e-r+("MMK"==a?100:1);return this.premiumAmt=this.numberPipe.transform(d)+" "+a.toUpperCase(),this.globalFun.paPremiumResult.next(this.premiumAmt),d}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.Q),t.Y36(M.f),t.Y36(_.JJ),t.Y36(L.D),t.Y36(j.Q),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-motor-addon"]],inputs:{product:"product",editData:"editData",resourcesId:"resourcesId",optionId:"optionId",premiumAmt:"premiumAmt"},outputs:{actionEvent:"actionEvent"},features:[t._Bn([{provide:Fi._A,useClass:it.t7,deps:[S.Ad]},{provide:S.sG,useValue:k.Gs}])],decls:30,vars:7,consts:[[1,"form-group"],[1,"row",2,"align-items","center"],[1,"col-sm-6"],[1,"col-sm-6","text-bold"],[1,"col-sm-6","text-bold","left-border-image"],[1,"col-sm-2"],[1,"toggle","ft-right",3,"ngModel","color","ngModelChange","toggleChange"],["class","row","style","align-items: center; margin-top: 10px;",4,"ngIf"],[1,"row",2,"align-items","center","margin-top","10px"],[1,"row"],[1,"col-sm-6","mx-auto"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"],[1,"form-group","row"],[1,"col-sm-8"],["bindLabel","value","bindValue","code",1,"ng-custom-select",3,"ngModel","items","ngModelChange","change"],[1,"col-sm-12","text-bold"],[1,"col-sm-4"],[1,"col-sm-4","col-form-label"],[1,"input-group","input-group-sm"],["matInput","","readonly","",1,"form-control-sm","date-input",2,"width","100%",3,"ngModel","matDatepicker","ngModelChange"],["matSuffix","",3,"for"],["disabled","false"],["start",""],["end",""],["type","text","name","option1","autocomplete","off",1,"form-control","form-control-sm",3,"disabled","ngModel","ngModelChange"],["type","text","name","option2","autocomplete","off",1,"form-control","form-control-sm",3,"disabled","ngModel","ngModelChange"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"label",3),t._uU(4,"Optional Covers"),t.qZA(),t.qZA(),t.qZA(),t._UZ(5,"hr"),t.TgZ(6,"div"),t.TgZ(7,"div",1),t.TgZ(8,"div",2),t.TgZ(9,"label",4),t._uU(10,"Medical Expense"),t.qZA(),t.qZA(),t.TgZ(11,"div",5),t.TgZ(12,"mat-slide-toggle",6),t.NdJ("ngModelChange",function(a){return i.isMedical=a})("toggleChange",function(){return i.toggleChange("medical")}),t.qZA(),t.qZA(),t.qZA(),t.YNc(13,ki,10,3,"div",7),t.TgZ(14,"div",8),t.TgZ(15,"div",2),t.TgZ(16,"label",4),t._uU(17,"Cross Border"),t.qZA(),t.qZA(),t.TgZ(18,"div",5),t.TgZ(19,"mat-slide-toggle",6),t.NdJ("ngModelChange",function(a){return i.isCross=a})("toggleChange",function(){return i.toggleChange("cross")}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(20,Si,21,6,"div",7),t.YNc(21,Ni,19,5,"div",7),t.qZA(),t._UZ(22,"hr"),t.TgZ(23,"div",9),t.TgZ(24,"div",10),t.TgZ(25,"button",11),t.NdJ("click",function(){return i.backPage()}),t._uU(26," Previous "),t.qZA(),t.qZA(),t.TgZ(27,"div",10),t.TgZ(28,"button",12),t.NdJ("click",function(){return i.nextPage()}),t._uU(29," Save & Next "),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(12),t.Q6J("ngModel",i.isMedical)("color",i.primary),t.xp6(1),t.Q6J("ngIf",i.isMedical),t.xp6(6),t.Q6J("ngModel",i.isCross)("color",i.primary),t.xp6(1),t.Q6J("ngIf",i.isCross),t.xp6(1),t.Q6J("ngIf",i.isCross))},directives:[Zt.Rr,l.JJ,l.On,_.O5,$.w9,nt.Nt,l.Fj,q.hl,q.nW,ot.R9,q.Mq],styles:[".input-group[_ngcontent-%COMP%]   .form-control-sm[_ngcontent-%COMP%]{background-color:#fff;background-clip:padding-box;border:1px solid #E4E6EF;padding:0 .75rem}.input-group[_ngcontent-%COMP%]   .mat-datepicker-toggle[_ngcontent-%COMP%]{position:absolute;right:5px}.active[_ngcontent-%COMP%]{display:block}.inactive[_ngcontent-%COMP%]{display:none}.icon[_ngcontent-%COMP%]{position:relative;border:none;margin:0;font-size:1.5rem;background-color:transparent}.add[_ngcontent-%COMP%]{top:-11px;position:relative;border:none;background:#f2f2f2;margin:0}.add[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:absolute;top:-52px;right:78px;width:110px}.btn-box[_ngcontent-%COMP%]{text-align:end}.btn-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;width:127%;height:100%;opacity:0}h2[_ngcontent-%COMP%]{font-size:13px;color:#005ca2;background:#F2F2F2;border:none;cursor:pointer;position:relative;margin-top:24px;padding:12px 24px 1px}h2[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;right:14px;top:5px}h2[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:6px;height:12px;float:left}h2[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;padding-left:18px}.tab-div[_ngcontent-%COMP%]{position:relative;padding:20px 0 0;background:#d1d7e2;border-bottom:1px solid #d2d2d2;margin:-10px 0 0}.tab-div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:absolute;bottom:20px;right:20px}"]}),o})();var yt=p(75291);function zi(o,c){1&o&&(t.TgZ(0,"mat-radio-button",18),t._uU(1,"Critical Illness "),t.qZA()),2&o&&t.Q6J("value","CRTILLNESS")}function Ri(o,c){if(1&o&&(t.TgZ(0,"option",23),t._uU(1),t.qZA()),2&o){const e=c.$implicit;t.Q6J("value",e),t.xp6(1),t.AsE("",e," Unit",e>1?"s":"","")}}function Ji(o,c){1&o&&(t.TgZ(0,"div",20),t.TgZ(1,"div",2),t.TgZ(2,"div",3),t.TgZ(3,"label",21),t._uU(4,"Medical Card No"),t.qZA(),t.TgZ(5,"div",2),t._UZ(6,"input",37),t.qZA(),t.qZA(),t.qZA(),t.qZA())}function Ei(o,c){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"number"),t.qZA(),t.qZA()),2&o){const e=c.$implicit,i=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,6,e.plan)),t.xp6(3),t.AsE("",e.sumInsured," Unit",e.sumInsured>1?"s":"",""),t.xp6(2),t.Oqu("HEALTH"==e.coverage?"Health":"TRMTS"==e.coverage?"Medical treatments in clinic or hospital":"Surgery and Miscarriage"),t.xp6(2),t.Oqu("S"!=(i.policyTerm[e.paymentTerm]||e.paymentTerm)?"Lump Sum":"Semi-Annually"),t.xp6(2),t.hij("",t.lcZ(12,8,e.premium)," ")}}let Bi=(()=>{class o{constructor(e,i,n,a,r,s,d,u,m,h,f){this.fb=e,this.prodService=i,this.healthService=n,this.alertService=a,this.healthPayService=r,this.auth=s,this.globalFun=d,this.coverageQuoService=u,this.addOnQuoService=m,this.numberPipe=h,this.cdf=f,this.actionEvent=new t.vpe,this.toMinDate=null,this.fromMinDate=null,this.toMaxDate=null,this.fromMaxDate=null,this.dobMinDate=null,this.dobMaxDate=null,this.options=[],this.options2=[],this.addOns={},this.options3=[],this.options4=[],this.optionArray=[],this.tempArray=[],this.totalResult={unit:0,premium:0},this.policyTerm={lump:"Lump Sum",semi_annually:"Semi-Annually"},this.totalP=0,this.currentAge=0,this.dob="",this.totalL=0,this.staticForm=this.fb.group({insuranceStartDate:[{value:null,disabled:!0},l.kI.compose([l.kI.required])],insuranceEndDate:[{value:null,disabled:!0},l.kI.compose([l.kI.required])],dateOfBirth:[{value:null,disabled:!0}],basicCoverId:[{value:"Health Insurance",disabled:!0},l.kI.compose([l.kI.required])],paymentFrequency:[{value:null,disabled:!0},l.kI.compose([l.kI.required])],sumInsuredMainCover:[{value:null,disabled:!0},l.kI.compose([l.kI.required])],medicalCardNo:[{value:null,disabled:!0}]}),this.options3=Array.from({length:10},(D,z)=>z+1)}ngOnInit(){return(0,v.mG)(this,void 0,void 0,function*(){this.refID=this.prodService.referenceID,this.refID||this.alertService.activate("This page cann't to show because there is no health product detail quotation data.","Warning"),this.options=this.product.coverages,this.options2=this.product.addOns;let e=O().subtract(5,"days");this.fromMinDate={year:parseInt(e.format("YYYY")),month:parseInt(e.format("M")),day:parseInt(e.format("D"))},this.toMinDate={year:parseInt(e.format("YYYY")),month:parseInt(e.format("M")),day:parseInt(e.format("D"))},this.parentData=this.getParent(),this.dob=this.parentData.date_of_birth,this.currentAge=Math.ceil(O().diff(this.dob,"years",!0)),this.getOldData()})}getParent(){if((0,k.cU)(this.product.config)){let e=JSON.parse(this.product.config),n=("quotation"!=this.prodService.type?e.application||[]:e.quotation||[]).find(a=>"life_insured_health"==a.tableName);return n&&this.globalFun.tempFormData[n.tableName+n.id]||null}return null}get controls(){return this.staticForm.controls}isControlValid(e,i){const n=i.controls[e];return n.valid&&(n.dirty||n.touched)}isControlInvalid(e,i){const n=i.controls[e];return n.invalid&&(n.dirty||n.touched)}controlHasError(e,i,n){const a=n.controls[i];return a.hasError(e)&&(a.dirty||a.touched)}isControlTouched(e,i){const n=i.controls[e];return n.dirty||n.touched}nextPage(){this.editId?this.saveData(this.editId):this.saveData()}backPage(){this.actionEvent.emit({type:T.V.PREV})}getOldData(){if(this.refID){let e=this.refID;if(!e)return!1;this.editData.id?(console.log(this.editData),this.healthService.getOne(this.resourcesId).pipe((0,B.w)(n=>n?(0,b.of)(n):this.healthService.getOne(this.refID))).toPromise().then(n=>{n&&(this.oldData=Object.assign(Object.assign({},n),{id:null}),this.editId=n.resourceId==this.resourcesId?n.id:null,this.getQuoData(n.resourceId!=this.resourcesId),this.getAddOn(!0),this.reloadOldValueForm())})):this.healthService.getOne(e).toPromise().then(i=>{i&&(this.oldData=Object.assign(Object.assign({},i),{id:null}),this.editId=e==this.resourcesId?i.id:null,this.getQuoData(!0),this.getAddOn(!0),this.reloadOldValueForm())})}}saveData(e){const i=this.staticForm.getRawValue();if(!this.product.coverages.find(s=>s.code==i.basicCoverId))return this.alertService.activate("This page cann't to save because there is not match coverage in product detail. Please configuration the product detail","Warning"),!1;let a=this.globalFun.calculateDecimal(this.totalP/12)+this.totalL;this.premiumAmt=this.numberPipe.transform(a)+" MMK / month",this.globalFun.paPremiumResult.next(this.premiumAmt);let r={basicCoverId:i.basicCoverId,id:e||null,insuranceEndDate:i.insuranceEndDate,insuranceStartDate:i.insuranceStartDate,medicalCardNo:i.medicalCardNo,paymentFrequency:i.paymentFrequency,dateOfBirth:this.dob,resourceData:{agentId:this.auth.currentUserValue.id||1,customerId:this.prodService.creatingCustomer.customerId||1,policyNumber:null,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,productId:this.prodService.createingProd.id,quotationId:this.prodService.referenceID,leadId:this.prodService.creatingLeadId||null,type:this.prodService.type},resourceId:this.resourcesId,sumInsuredMainCover:i.sumInsuredMainCover};e?this.healthService.updateNoID(r).toPromise().then(s=>{s&&(this.editId=s.id,this.saveCoverAddon(),this.globalFun.tempFormData[C.Hu]=Object.assign(Object.assign({id:s.id},r),{addOns:this.addOns}),this.actionEvent.emit({type:T.V.NEXT,data:Object.assign({},s)}))}).catch(s=>s):this.healthService.save(r).toPromise().then(s=>{s&&(this.editId=s.id,this.resourcesId=s.resourceId,this.saveCoverAddon(),this.saveSchdule().toPromise().then(d=>{}).catch(d=>d),this.globalFun.tempFormData[C.Hu]=Object.assign(Object.assign({id:s.id},r),{addOns:this.addOns}),this.actionEvent.emit({type:T.V.NEXT,data:{res:s}}))}).catch(s=>s)}getQuoData(e=!1){this.healthPayService.getMany(e?this.refID:this.resourcesId).toPromise().then(n=>{n&&(this.optionArray=n,this.totalResult={unit:0,premium:0},this.totalP=0,this.totalL=0,this.optionArray.forEach(a=>{this.totalP+=a.premium,this.totalL+=a.levy,this.totalResult.unit+=a.sumInsured,this.totalResult.premium+=a.premium}),console.log(this.totalResult,"Total"),this.optionArray=this.optionArray.sort((a,r)=>a.coverage>r.coverage?1:-1),this.tempArray=this.optionArray.filter((a,r,s)=>r===s.findIndex(d=>d.coverage===a.coverage)),this.cdf.detectChanges())})}reloadOldValueForm(){this.staticForm.patchValue({insuranceStartDate:this.oldData.insuranceStartDate,insuranceEndDate:this.oldData.insuranceEndDate,dateOfBirth:this.oldData.dateOfBirth,basicCoverId:this.oldData.basicCoverId,paymentFrequency:this.oldData.paymentFrequency,sumInsuredMainCover:this.oldData.sumInsuredMainCover,medicalCardNo:this.oldData.medicalCardNo})}saveCoverage(){let e=this.staticForm.controls.basicCoverId.value,i=this.staticForm.controls.sumInsuredMainCover.value,n=this.product.coverages.find(a=>a.code==e);if(n){let a={coverageId:n.id,quotationNo:this.resourcesId,optionalKey:this.resourcesId,sumInsured:i,unit:null,premium:null};return this.coverageQuoService.deleteAll(this.resourcesId,this.resourcesId).pipe((0,B.w)(r=>this.coverageQuoService.save(a)))}return(0,b.of)([])}getAddOn(e=!1){return(0,v.mG)(this,void 0,void 0,function*(){if(this.resourcesId||this.refID){let i=!0,n=e?this.refID:this.resourcesId||this.refID;if(!n)return!1;for(const a of this.product.addOns){let r={};try{r=yield this.addOnQuoService.getOne(a.id,n,n).toPromise()}catch(s){}r?(i=!1,this.addOns[a.id+"opt"]=!!r.sumInsured,this.addOns[a.id+"value"]=r.sumInsured):(this.addOns[a.id+"opt"]=!1,this.addOns[a.id+"value"]=null)}}})}saveCoverAddon(){return(0,v.mG)(this,void 0,void 0,function*(){yield this.saveCoverage().toPromise(),yield this.saveAddOn().toPromise()})}saveSchdule(){return(0,K.D)(this.optionArray.map(e=>{let i={paymentTerm:e.paymentTerm,plan:e.plan,premium:e.premium,levy:e.levy,coverage:e.coverage,sumInsured:e.sumInsured,resourceId:this.resourcesId,total:e.total,resourceData:{agentId:this.auth.currentUserValue.id||1,customerId:this.prodService.creatingCustomer.customerId||1,policyNumber:null,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,productId:this.product.id,quotationId:this.prodService.referenceID,type:this.prodService.type,leadId:this.prodService.creatingLeadId}};return this.healthPayService.save(i)}))}saveAddOn(){return this.addOnQuoService.deleteAll(this.resourcesId,this.resourcesId).pipe((0,X.z)(e=>(0,K.D)(this.options2.map(i=>this.addOns[i.id+"opt"]?this.addOnQuoService.save({addonId:i.id,optionalKey:this.resourcesId,quotationNo:this.resourcesId,sumInsured:this.addOns[i.id+"value"],unit:null,premium:null}):(0,b.of)(null)))))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(l.qu),t.Y36(M.f),t.Y36(yt.e),t.Y36(w.c),t.Y36(Pt.q),t.Y36(U.e8),t.Y36(A.Q),t.Y36(W.a),t.Y36(L.D),t.Y36(_.JJ),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-simple-page-policy"]],inputs:{product:"product",editData:"editData",resourcesId:"resourcesId",premiumAmt:"premiumAmt"},outputs:{actionEvent:"actionEvent"},features:[t._Bn([{provide:g.DO,useClass:G.Wv},{provide:g.NG,useClass:G.ke},{provide:S._A,useClass:it.t7,deps:[S.Ad]},{provide:S.sG,useValue:k.Gs}])],decls:96,vars:24,consts:[["action","",3,"formGroup"],[1,"row",2,"align-items","center"],[1,"col-6"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"col-sm-6"],[1,"input-group"],["matInput","","formControlName","insuranceStartDate","readonly","",1,"form-control-sm","date-input",3,"min","max","matDatepicker"],["matSuffix","",3,"for"],["disabled","false"],["picker",""],[3,"control"],["matInput","","formControlName","insuranceEndDate","readonly","",1,"form-control-sm","date-input",3,"min","max","matDatepicker"],["disabled","true"],["picker2",""],[1,"example-section"],[1,"col-4"],["formControlName","basicCoverId",1,"col-8"],[1,"mx-1",3,"value"],["class","mx-1",3,"value",4,"ngIf"],[1,"row"],[1,"col-4","col-form-label"],["name","payment_frequency","formControlName","paymentFrequency",1,"form-control","form-control-sm"],[3,"value"],["value","L"],["value","S"],["name","sumInsuredMainCover","formControlName","sumInsuredMainCover",1,"form-control","form-control-sm"],[3,"value",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[1,"row","mt-3"],[1,"col-12"],[2,"border-bottom","1px solid rgba(0, 0, 0, 0.1)","padding","20px 0px"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],[1,"col-sm-6","mx-auto"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"],["type","text","name","medicalCardNo","formControlName","medicalCardNo",1,"form-control","form-control-sm"]],template:function(e,i){if(1&e&&(t.TgZ(0,"form",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"label",4),t._uU(5,"Period of Insurance"),t.qZA(),t.TgZ(6,"div",5),t.TgZ(7,"div",6),t._UZ(8,"input",7),t._UZ(9,"mat-datepicker-toggle",8),t._UZ(10,"mat-datepicker",9,10),t._UZ(12,"app-print-error",11),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"div",2),t.TgZ(14,"div",3),t.TgZ(15,"label",4),t._uU(16,"-"),t.qZA(),t.TgZ(17,"div",5),t.TgZ(18,"div",6),t._UZ(19,"input",12),t._UZ(20,"mat-datepicker-toggle",8),t._UZ(21,"mat-datepicker",13,14),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"div",1),t.TgZ(24,"div",2),t.TgZ(25,"section",15),t.TgZ(26,"div",3),t.TgZ(27,"label",16),t._uU(28,"Basic Cover"),t.qZA(),t.TgZ(29,"mat-radio-group",17),t.TgZ(30,"mat-radio-button",18),t._uU(31,"Health Insurance "),t.qZA(),t.YNc(32,zi,2,1,"mat-radio-button",19),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(33,"div",20),t.TgZ(34,"div",2),t.TgZ(35,"div",3),t.TgZ(36,"label",21),t._uU(37,"Payment Frequency"),t.qZA(),t.TgZ(38,"div",2),t.TgZ(39,"select",22),t.TgZ(40,"option",23),t._uU(41,"Please Select Payment Frequency"),t.qZA(),t.TgZ(42,"option",24),t._uU(43,"Lump Sum"),t.qZA(),t.TgZ(44,"option",25),t._uU(45,"Semi-Annually"),t.qZA(),t.qZA(),t._UZ(46,"app-print-error",11),t.qZA(),t.qZA(),t.qZA(),t.TgZ(47,"div",2),t.TgZ(48,"div",3),t.TgZ(49,"label",21),t._uU(50,"Sum Insured of Main Cover"),t.qZA(),t.TgZ(51,"div",2),t.TgZ(52,"select",26),t.TgZ(53,"option",23),t._uU(54,"Please Select Sum Insured"),t.qZA(),t.YNc(55,Ri,2,3,"option",27),t.qZA(),t._UZ(56,"app-print-error",11),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(57,Ji,7,0,"div",28),t.qZA(),t.TgZ(58,"div",29),t.TgZ(59,"div",30),t.TgZ(60,"h5",31),t._uU(61,"Product And Riders"),t.qZA(),t.TgZ(62,"table",32),t.TgZ(63,"thead"),t.TgZ(64,"tr"),t.TgZ(65,"th"),t._uU(66," Plan "),t.qZA(),t.TgZ(67,"th"),t._uU(68," Sum Assured "),t.qZA(),t.TgZ(69,"th"),t._uU(70," Coverage Term "),t.qZA(),t.TgZ(71,"th"),t._uU(72," Payment Term "),t.qZA(),t.TgZ(73,"th"),t._uU(74," Premium "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(75,"tbody"),t.YNc(76,Ei,13,10,"tr",33),t.qZA(),t.TgZ(77,"tfoot"),t.TgZ(78,"tr"),t.TgZ(79,"td"),t.TgZ(80,"b"),t._uU(81,"Total"),t.qZA(),t.qZA(),t.TgZ(82,"td"),t._uU(83),t.qZA(),t._UZ(84,"td"),t._UZ(85,"td"),t.TgZ(86,"td"),t._uU(87),t.ALo(88,"number"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(89,"div",29),t.TgZ(90,"div",34),t.TgZ(91,"button",35),t.NdJ("click",function(){return i.backPage()}),t._uU(92," Previous "),t.qZA(),t.qZA(),t.TgZ(93,"div",34),t.TgZ(94,"button",36),t.NdJ("click",function(){return i.nextPage()}),t._uU(95," Save & Next "),t.qZA(),t.qZA(),t.qZA()),2&e){const n=t.MAs(11),a=t.MAs(22);t.Q6J("formGroup",i.staticForm),t.xp6(8),t.Q6J("min",i.fromMinDate)("max",i.fromMaxDate)("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(3),t.Q6J("control",i.controls.insuranceStartDate),t.xp6(7),t.Q6J("min",i.toMinDate)("max",i.toMaxDate)("matDatepicker",a),t.xp6(1),t.Q6J("for",a),t.xp6(10),t.Q6J("value","HEALTH"),t.xp6(2),t.Q6J("ngIf",i.currentAge<61),t.xp6(8),t.Q6J("value",null),t.xp6(6),t.Q6J("control",i.controls.paymentFrequency),t.xp6(7),t.Q6J("value",null),t.xp6(2),t.Q6J("ngForOf",i.options3),t.xp6(1),t.Q6J("control",i.controls.sumInsuredMainCover),t.xp6(1),t.Q6J("ngIf","CRTILLNESS"==i.controls.basicCoverId.value),t.xp6(19),t.Q6J("ngForOf",i.tempArray),t.xp6(7),t.AsE("",i.totalResult.unit," Unit",i.totalResult.unit>1?"s":"",""),t.xp6(4),t.Oqu(t.lcZ(88,22,i.totalResult.premium))}},directives:[l._Y,l.JL,l.sg,nt.Nt,l.Fj,q.hl,l.JJ,l.u,q.nW,ot.R9,q.Mq,dt.n,Q.VQ,Q.U0,_.O5,l.EJ,l.YN,l.Kr,_.sg],pipes:[_.JJ,_.rS],styles:[".input-group[_ngcontent-%COMP%]   .form-control-sm[_ngcontent-%COMP%]{background-color:#fff;background-clip:padding-box;border:1px solid #E4E6EF;padding:0 .75rem}.input-group[_ngcontent-%COMP%]   .mat-datepicker-toggle[_ngcontent-%COMP%]{position:absolute;right:5px}"]}),o})();function Qi(o,c){if(1&o&&(t.TgZ(0,"option",22),t._uU(1),t.qZA()),2&o){const e=c.$implicit;t.Q6J("value",e),t.xp6(1),t.AsE("",e," Unit",e>1?"s":"","")}}function Vi(o,c){if(1&o&&(t.TgZ(0,"div",19),t.TgZ(1,"div",2),t.TgZ(2,"div",3),t.TgZ(3,"label",20),t._uU(4,"Medical Card No"),t.qZA(),t.TgZ(5,"div",2),t._UZ(6,"input",33),t._UZ(7,"app-print-error",11),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(7),t.Q6J("control",e.controls.medicalCardNo)}}function Yi(o,c){if(1&o&&(t.TgZ(0,"option",22),t._uU(1),t.qZA()),2&o){const e=c.$implicit;t.Q6J("value",e),t.xp6(1),t.AsE("",e," Unit",e>1?"s":"","")}}const xt=function(){return{standalone:!0}};function Li(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",2),t.TgZ(1,"div",19),t.TgZ(2,"label",43),t._uU(3,"Sum Insured"),t.qZA(),t.TgZ(4,"div",2),t.TgZ(5,"select",44),t.NdJ("ngModelChange",function(n){t.CHM(e);const a=t.oxw().$implicit;return t.oxw(2).addOns[a.id+"value"]=n}),t.YNc(6,Yi,2,3,"option",26),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(5),t.Q6J("ngModel",i.addOns[e.id+"value"])("ngModelOptions",t.DdM(3,xt)),t.xp6(1),t.Q6J("ngForOf",i.options4)}}function ji(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",38),t.TgZ(1,"label",20),t._uU(2),t.qZA(),t.TgZ(3,"div",39),t.TgZ(4,"span",40),t.TgZ(5,"label"),t.TgZ(6,"input",41),t.NdJ("ngModelChange",function(n){const r=t.CHM(e).$implicit;return t.oxw(2).addOns[r.id+"opt"]=n}),t.qZA(),t._UZ(7,"span"),t.qZA(),t.qZA(),t.qZA(),t.YNc(8,Li,7,4,"div",42),t.qZA()}if(2&o){const e=c.$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(e.description),t.xp6(4),t.s9C("name",e.description),t.Q6J("ngModel",i.addOns[e.id+"opt"])("ngModelOptions",t.DdM(5,xt)),t.xp6(2),t.Q6J("ngIf",i.addOns[e.id+"opt"])}}function Hi(o,c){if(1&o&&(t.ynx(0),t.TgZ(1,"div",34),t.TgZ(2,"div",35),t.TgZ(3,"h5",36),t._uU(4,"Optional Cover"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(5,"div",19),t.TgZ(6,"div",35),t.YNc(7,ji,9,6,"div",37),t.qZA(),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(7),t.Q6J("ngForOf",e.options2)}}let Gi=(()=>{class o{constructor(e,i,n,a,r,s,d,u,m){this.fb=e,this.prodService=i,this.auth=n,this.healthService=a,this.globalFun=r,this.addOnQuoService=s,this.coverageQuoService=d,this.alertService=u,this.cdf=m,this.actionEvent=new t.vpe,this.toMinDate=null,this.fromMinDate=null,this.toMaxDate=null,this.fromMaxDate=null,this.dobMinDate=null,this.dobMaxDate=null,this.options=[],this.options2=[],this.addOns={},this.options3=[],this.options4=[],this.currentAge=0,this.dob="",this.addValid=!1,this.staticForm=this.fb.group({insuranceStartDate:[null,l.kI.compose([l.kI.required])],insuranceEndDate:[null,l.kI.compose([l.kI.required])],dateOfBirth:[null],basicCoverId:["HEALTH",l.kI.compose([l.kI.required])],paymentFrequency:[null,l.kI.compose([l.kI.required])],sumInsuredMainCover:[null,l.kI.compose([l.kI.required])],medicalCardNo:[null]}),this.options3=Array.from({length:10},(h,f)=>f+1)}ngOnInit(){return(0,v.mG)(this,void 0,void 0,function*(){this.options=this.product.coverages,this.options2=this.product.addOns,this.refID=this.prodService.referenceID;let e=O().subtract(5,"days");this.fromMinDate=e.format("YYYY-MM-DD"),this.toMinDate=e.format("YYYY-MM-DD"),this.parentData=this.getParent(),this.parentData?(this.dob=this.parentData.date_of_birth,this.currentAge=Math.ceil(O().diff(this.dob,"years",!0))):this.alertService.activate("This page cann't to save because there is no parent Data. Please configuration the product detail","Warning"),this.getOldData()})}radioChange(e){"CRTILLNESS"==this.staticForm.value.basicCoverId?(this.currentAge>50&&this.staticForm.value.sumInsuredMainCover>4&&this.alertService.activate("Medical check up is required","Warning"),this.addValid&&(this.addValid=!1,this.staticForm.get("medicalCardNo").setValidators([l.kI.required]),this.staticForm.get("medicalCardNo").updateValueAndValidity())):(this.staticForm.get("medicalCardNo").clearValidators(),this.staticForm.get("medicalCardNo").updateValueAndValidity(),this.currentAge<50&&this.staticForm.value.sumInsuredMainCover>4&&(this.addValid=!0))}getParent(){if((0,k.cU)(this.product.config)){let e=JSON.parse(this.product.config),n=("quotation"!=this.prodService.type?e.application||[]:e.quotation||[]).find(a=>"life_insured_health"==a.tableName);return console.log(this.globalFun.tempFormData,n),n&&this.globalFun.tempFormData[n.tableName+n.id]||null}return null}doValid(){if(this.staticForm.controls.insuranceStartDate.value){let i=O(this.staticForm.controls.insuranceStartDate.value).add(1,"years").subtract(1,"days");this.toMaxDate=i.format("YYYY-MM-DD"),this.staticForm.controls.insuranceEndDate.setValue(i.format("YYYY-MM-DD"))}}getUnitOption(){let e=this.controls.sumInsuredMainCover.value;if("CRTILLNESS"==this.staticForm.value.basicCoverId&&this.currentAge>50&&this.staticForm.value.sumInsuredMainCover>4&&this.alertService.activate("Medical check up is required","Warning"),e!=this.options4.length){this.options4=Array.from({length:e},(i,n)=>n+1);for(let i of this.options2)this.addOns[i.id+"value"]=e}}get controls(){return this.staticForm.controls}isControlValid(e,i){const n=i.controls[e];return n.valid&&(n.dirty||n.touched)}isControlInvalid(e,i){const n=i.controls[e];return n.invalid&&(n.dirty||n.touched)}controlHasError(e,i,n){const a=n.controls[i];return a.hasError(e)&&(a.dirty||a.touched)}isControlTouched(e,i){const n=i.controls[e];return n.dirty||n.touched}nextPage(){if(this.staticForm.invalid)return(0,at.w)(this.staticForm),!0;this.editId?this.saveData(this.editId):this.saveData()}backPage(){this.actionEvent.emit({type:T.V.PREV})}saveData(e){if(this.staticForm.invalid)return!1;const i=this.staticForm.value;if(!this.product.coverages.find(r=>r.code==i.basicCoverId))return this.alertService.activate("This page cann't to save because there is not match coverage in product detail. Please configuration the product detail","Warning"),!1;let a={basicCoverId:i.basicCoverId,id:e||null,insuranceEndDate:i.insuranceEndDate,insuranceStartDate:i.insuranceStartDate,medicalCardNo:i.medicalCardNo,paymentFrequency:i.paymentFrequency,dateOfBirth:this.dob,resourceData:{agentId:this.auth.currentUserValue.id||1,customerId:this.prodService.creatingCustomer.customerId||1,policyNumber:null,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,productId:this.prodService.createingProd.id,quotationId:this.prodService.referenceID,leadId:this.prodService.creatingLeadId||null,type:this.prodService.type},resourceId:this.resourcesId,sumInsuredMainCover:i.sumInsuredMainCover};e?this.healthService.updateNoID(a).toPromise().then(r=>{r&&(this.editId=r.id,this.saveCoverAddon(),this.globalFun.tempFormData[C.Hu]=Object.assign(Object.assign({id:r.id},a),{addOns:this.addOns}),this.actionEvent.emit({type:T.V.NEXT,data:Object.assign({},r)}))}).catch(r=>r):this.healthService.save(a).toPromise().then(r=>{r&&(this.editId=r.id,this.resourcesId=r.resourceId,this.saveCoverAddon(),this.globalFun.tempFormData[C.Hu]=Object.assign(Object.assign({id:r.id},a),{addOns:this.addOns}),this.actionEvent.emit({type:T.V.NEXT,data:Object.assign({},r)}))}).catch(r=>r)}saveCoverAddon(){return(0,v.mG)(this,void 0,void 0,function*(){yield this.saveCoverage().toPromise(),yield this.saveAddOn().toPromise()})}getOldData(e=!1){if(this.resourcesId||this.refID){let i=e?this.refID:this.resourcesId||this.refID;if(!i)return!1;this.healthService.getOne(i).toPromise().then(n=>{n?(this.oldData=Object.assign(Object.assign({},n),{id:null}),this.editId=i==this.resourcesId?n.id:null,this.getAddOn(),this.reloadOldValueForm()):!e&&i!=this.refID&&(this.getAddOn(!0),this.getOldData(!0))})}}reloadOldValueForm(){this.staticForm.patchValue({insuranceStartDate:O(this.oldData.insuranceStartDate),insuranceEndDate:O(this.oldData.insuranceEndDate),dateOfBirth:O(this.oldData.dateOfBirth),basicCoverId:this.oldData.basicCoverId,paymentFrequency:this.oldData.paymentFrequency,sumInsuredMainCover:this.oldData.sumInsuredMainCover,medicalCardNo:this.oldData.medicalCardNo}),this.getUnitOption()}saveCoverage(){let e=this.staticForm.controls.basicCoverId.value,i=this.staticForm.controls.sumInsuredMainCover.value,n=this.product.coverages.find(a=>a.code==e);if(n){let a={coverageId:n.id,quotationNo:this.resourcesId,optionalKey:this.resourcesId,sumInsured:i,unit:null,premium:null};return this.coverageQuoService.deleteAll(this.resourcesId,this.resourcesId).pipe((0,B.w)(r=>this.coverageQuoService.save(a)))}return(0,b.of)([])}getAddOn(e=!1){return(0,v.mG)(this,void 0,void 0,function*(){if(this.resourcesId||this.refID){let i=!0,n=e?this.refID:this.resourcesId||this.refID;if(!n)return!1;for(const a of this.product.addOns){let r={};try{r=yield this.addOnQuoService.getOne(a.id,n,n).toPromise()}catch(s){}r?(i=!1,this.addOns[a.id+"opt"]=!!r.sumInsured,this.addOns[a.id+"value"]=r.sumInsured):(this.addOns[a.id+"opt"]=!1,this.addOns[a.id+"value"]=null)}this.cdf.detectChanges()}})}saveAddOn(){const e=this.staticForm.value;return this.addOnQuoService.deleteAll(this.resourcesId,this.resourcesId).pipe((0,X.z)(i=>(0,K.D)(this.options2.map(n=>"HEALTH"==e.basicCoverId?this.addOns[n.id+"opt"]?this.addOnQuoService.save({addonId:n.id,quotationNo:this.resourcesId,optionalKey:this.resourcesId,sumInsured:this.addOns[n.id+"value"],unit:null,premium:null}):(this.addOns[n.id+"opt"]=!1,this.addOns[n.id+"value"]=0,(0,b.of)(null)):(0,b.of)(null)))))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(l.qu),t.Y36(M.f),t.Y36(U.e8),t.Y36(yt.e),t.Y36(A.Q),t.Y36(L.D),t.Y36(W.a),t.Y36(w.c),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-simple-page"]],inputs:{product:"product",editData:"editData",resourcesId:"resourcesId",premiumAmt:"premiumAmt"},outputs:{actionEvent:"actionEvent"},features:[t._Bn([{provide:g.DO,useClass:G.Wv},{provide:g.NG,useClass:G.ke},{provide:S._A,useClass:it.t7,deps:[S.Ad]},{provide:S.sG,useValue:k.Gs}])],decls:67,vars:19,consts:[["action","",3,"formGroup"],[1,"row",2,"align-items","center"],[1,"col-6"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"col-sm-6"],[1,"input-group"],["matInput","","formControlName","insuranceStartDate","readonly","",1,"form-control-sm","date-input",3,"min","max","matDatepicker","dateChange"],["matSuffix","",3,"for"],["disabled","false"],["picker",""],[3,"control"],["matInput","","formControlName","insuranceEndDate","readonly","",1,"form-control-sm","date-input",3,"min","max","matDatepicker"],["disabled","true"],["picker2",""],[1,"example-section"],[1,"col-4"],["formControlName","basicCoverId",1,"col-8",3,"change"],[1,"mx-1",3,"value"],[1,"row"],[1,"col-4","col-form-label"],["name","payment_frequency","formControlName","paymentFrequency",1,"form-control","form-control-sm"],[3,"value"],["value","L"],["value","S"],["name","sumInsuredMainCover","formControlName","sumInsuredMainCover",1,"form-control","form-control-sm",3,"change"],[3,"value",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[4,"ngIf"],[1,"row","mt-3"],[1,"col-sm-6","mx-auto"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"],["type","text","name","medicalCardNo","formControlName","medicalCardNo",1,"form-control","form-control-sm"],[1,"row","mt-5"],[1,"col-12"],[2,"border-bottom","1px solid rgba(0, 0, 0, 0.1)","padding","20px 0px"],["class","form-group row","style","align-items: center;",4,"ngFor","ngForOf"],[1,"form-group","row",2,"align-items","center"],[1,"col-2"],[1,"switch","switch-icon"],["type","checkbox",3,"name","ngModel","ngModelOptions","ngModelChange"],["class","col-6",4,"ngIf"],[1,"col-6","col-form-label"],[1,"form-control","form-control-sm",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(e,i){if(1&e&&(t.TgZ(0,"form",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"label",4),t._uU(5,"Period of Insurance"),t.qZA(),t.TgZ(6,"div",5),t.TgZ(7,"div",6),t.TgZ(8,"input",7),t.NdJ("dateChange",function(){return i.doValid()}),t.qZA(),t._UZ(9,"mat-datepicker-toggle",8),t._UZ(10,"mat-datepicker",9,10),t._UZ(12,"app-print-error",11),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"div",2),t.TgZ(14,"div",3),t.TgZ(15,"label",4),t._uU(16,"-"),t.qZA(),t.TgZ(17,"div",5),t.TgZ(18,"div",6),t._UZ(19,"input",12),t._UZ(20,"mat-datepicker-toggle",8),t._UZ(21,"mat-datepicker",13,14),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"div",1),t.TgZ(24,"div",2),t.TgZ(25,"section",15),t.TgZ(26,"div",3),t.TgZ(27,"label",16),t._uU(28,"Basic Cover"),t.qZA(),t.TgZ(29,"mat-radio-group",17),t.NdJ("change",function(a){return i.radioChange(a)}),t.TgZ(30,"mat-radio-button",18),t._uU(31,"Health Insurance "),t.qZA(),t.TgZ(32,"mat-radio-button",18),t._uU(33,"Critical Illness "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(34,"div",19),t.TgZ(35,"div",2),t.TgZ(36,"div",3),t.TgZ(37,"label",20),t._uU(38,"Payment Frequency"),t.qZA(),t.TgZ(39,"div",2),t.TgZ(40,"select",21),t.TgZ(41,"option",22),t._uU(42,"Please Select Payment Frequency"),t.qZA(),t.TgZ(43,"option",23),t._uU(44,"Lump Sum"),t.qZA(),t.TgZ(45,"option",24),t._uU(46,"Semi-Annually"),t.qZA(),t.qZA(),t._UZ(47,"app-print-error",11),t.qZA(),t.qZA(),t.qZA(),t.TgZ(48,"div",2),t.TgZ(49,"div",3),t.TgZ(50,"label",20),t._uU(51,"Sum Insured of Main Cover"),t.qZA(),t.TgZ(52,"div",2),t.TgZ(53,"select",25),t.NdJ("change",function(){return i.getUnitOption()}),t.TgZ(54,"option",22),t._uU(55,"Please Select Sum Insured"),t.qZA(),t.YNc(56,Qi,2,3,"option",26),t.qZA(),t._UZ(57,"app-print-error",11),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(58,Vi,8,1,"div",27),t.YNc(59,Hi,8,1,"ng-container",28),t.qZA(),t.TgZ(60,"div",29),t.TgZ(61,"div",30),t.TgZ(62,"button",31),t.NdJ("click",function(){return i.backPage()}),t._uU(63," Previous "),t.qZA(),t.qZA(),t.TgZ(64,"div",30),t.TgZ(65,"button",32),t.NdJ("click",function(){return i.nextPage()}),t._uU(66," Save & Next "),t.qZA(),t.qZA(),t.qZA()),2&e){const n=t.MAs(11),a=t.MAs(22);t.Q6J("formGroup",i.staticForm),t.xp6(8),t.Q6J("min",i.fromMinDate)("max",i.fromMaxDate)("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(3),t.Q6J("control",i.controls.insuranceStartDate),t.xp6(7),t.Q6J("min",i.toMinDate)("max",i.toMaxDate)("matDatepicker",a),t.xp6(1),t.Q6J("for",a),t.xp6(10),t.Q6J("value","HEALTH"),t.xp6(2),t.Q6J("value","CRTILLNESS"),t.xp6(9),t.Q6J("value",null),t.xp6(6),t.Q6J("control",i.controls.paymentFrequency),t.xp6(7),t.Q6J("value",null),t.xp6(2),t.Q6J("ngForOf",i.options3),t.xp6(1),t.Q6J("control",i.controls.sumInsuredMainCover),t.xp6(1),t.Q6J("ngIf","CRTILLNESS"==i.controls.basicCoverId.value),t.xp6(1),t.Q6J("ngIf","HEALTH"==i.controls.basicCoverId.value)}},directives:[l._Y,l.JL,l.sg,nt.Nt,l.Fj,q.hl,l.JJ,l.u,q.nW,ot.R9,q.Mq,dt.n,Q.VQ,Q.U0,l.EJ,l.YN,l.Kr,_.sg,_.O5,l.Wl,l.On],styles:[".input-group[_ngcontent-%COMP%]   .form-control-sm[_ngcontent-%COMP%]{background-color:#fff;background-clip:padding-box;border:1px solid #E4E6EF;padding:0 .75rem}.input-group[_ngcontent-%COMP%]   .mat-datepicker-toggle[_ngcontent-%COMP%]{position:absolute;right:5px}"]}),o})();var It=p(37780),ut=p(87626);function $i(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).toggleAccordion("DETAIL")}),t._UZ(1,"span",23),t.qZA()}}function Wi(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).toggleAccordion("DETAIL")}),t._UZ(1,"span",25),t.qZA()}}const Mt=function(){return{}};function Ki(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",5),t.TgZ(1,"div",6),t.TgZ(2,"h4",7),t._uU(3),t.qZA(),t.TgZ(4,"div",8),t.YNc(5,$i,2,0,"button",15),t.YNc(6,Wi,2,0,"button",16),t.qZA(),t.qZA(),t.TgZ(7,"div",17),t.TgZ(8,"dynamic-form",18,19),t.NdJ("submit",function(n){return t.CHM(e),t.oxw().saveDetailTemp(n)}),t.qZA(),t.TgZ(10,"div",20),t.TgZ(11,"button",21),t.NdJ("click",function(){t.CHM(e);const n=t.MAs(9),a=t.oxw();return a.saveData(n,a.prodDetailForm)}),t._uU(12,"Next"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(3),t.Oqu(e.prodDetailForm.pageTitle),t.xp6(2),t.Q6J("ngIf","DETAIL"==e.activeBox),t.xp6(1),t.Q6J("ngIf","DETAIL"!=e.activeBox),t.xp6(1),t.Q6J("ngClass","DETAIL"==e.activeBox?"active":"inactive"),t.xp6(1),t.Q6J("tempData",e.tempData.travelDetail||t.DdM(7,Mt))("config",e.prodDetailForm.controls)("editStage",!1)}}function Xi(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).toggleAccordion("TRAVELER")}),t._UZ(1,"span",23),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("disabled",!e.stepData.step1)}}function tn(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).toggleAccordion("TRAVELER")}),t._UZ(1,"span",25),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("disabled",!e.stepData.step1)}}function en(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",17),t.TgZ(2,"dynamic-form",18,28),t.NdJ("submit",function(n){return t.CHM(e),t.oxw(2).saveTravelerTemp(n)}),t.qZA(),t.TgZ(4,"div",20),t.TgZ(5,"button",21),t.NdJ("click",function(){t.CHM(e);const n=t.MAs(3),a=t.oxw(2);return a.saveData(n,a.travelerForm)}),t._uU(6,"Next"),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngClass","TRAVELER"==e.activeBox?"active":"inactive"),t.xp6(1),t.Q6J("tempData",e.tempData.traveler||t.DdM(4,Mt))("config",e.travelerForm.controls)("editStage",!1)}}function nn(o,c){if(1&o&&(t.TgZ(0,"div",5),t.TgZ(1,"div",6),t.TgZ(2,"h4",7),t._uU(3),t.qZA(),t.TgZ(4,"div",8),t.YNc(5,Xi,2,1,"button",9),t.YNc(6,tn,2,1,"button",10),t.qZA(),t.qZA(),t.YNc(7,en,7,5,"ng-container",11),t.qZA()),2&o){const e=t.oxw();t.xp6(3),t.Oqu(e.travelerForm.pageTitle),t.xp6(2),t.Q6J("ngIf","TRAVELER"==e.activeBox),t.xp6(1),t.Q6J("ngIf","TRAVELER"!=e.activeBox),t.xp6(1),t.Q6J("ngIf",e.stepData.step1)}}function on(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).toggleAccordion("BENEFI")}),t._UZ(1,"span",23),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("disabled",!e.stepData.step2)}}function an(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).toggleAccordion("BENEFI")}),t._UZ(1,"span",25),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("disabled",!e.stepData.step2)}}function rn(o,c){if(1&o&&(t.ynx(0),t.TgZ(1,"th"),t._uU(2),t.qZA(),t.BQk()),2&o){const e=c.$implicit;t.xp6(2),t.Oqu(e.title)}}function sn(o,c){if(1&o&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,i=t.oxw().$implicit,n=t.oxw(4);t.xp6(1),t.Oqu(n.getOtherData(e.cols,i))}}function cn(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"td"),t.TgZ(1,"a",39),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw().$implicit;return t.oxw(4).download(n.cols,a)}),t._uU(2),t.qZA(),t.qZA()}if(2&o){const e=t.oxw().$implicit,i=t.oxw().$implicit,n=t.oxw(4);t.xp6(2),t.hij(" ",n.getOtherData(e.cols,i)," ")}}function ln(o,c){if(1&o&&(t.ynx(0),t.YNc(1,sn,2,1,"td",11),t.YNc(2,cn,3,1,"td",11),t.BQk()),2&o){const e=c.$implicit;t.xp6(1),t.Q6J("ngIf","file"!=e.type),t.xp6(1),t.Q6J("ngIf","file"==e.type)}}function dn(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.YNc(3,ln,3,2,"ng-container",33),t.TgZ(4,"td",34),t.TgZ(5,"a",35),t.NdJ("click",function(){const n=t.CHM(e),a=n.$implicit,r=n.index;return t.oxw(4).newData(a,r)}),t._UZ(6,"span",36),t.qZA(),t.TgZ(7,"a",37),t.NdJ("click",function(){const n=t.CHM(e),a=n.index,r=n.$implicit;return t.oxw(4).deleteData(a,r)}),t._UZ(8,"span",38),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=c.index,i=t.oxw(4);t.xp6(2),t.Oqu(e+1),t.xp6(1),t.Q6J("ngForOf",i.tableReform),t.xp6(3),t.Q6J("inlineSVG","./assets/media/svg/icons/Communication/Write.svg")("cacheSVG",!0),t.xp6(2),t.Q6J("inlineSVG","./assets/media/svg/icons/General/Trash.svg")("cacheSVG",!0)}}function un(o,c){if(1&o&&(t.ynx(0),t.YNc(1,dn,9,6,"tr",33),t.BQk()),2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.tempData.benefi)}}function pn(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",17),t.TgZ(2,"div",29),t.TgZ(3,"button",30),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).newData()}),t._uU(4,"Add New Data"),t.qZA(),t.qZA(),t._UZ(5,"hr"),t.TgZ(6,"div",31),t.TgZ(7,"table",32),t.TgZ(8,"thead"),t.TgZ(9,"tr"),t.TgZ(10,"th"),t._uU(11,"NO"),t.qZA(),t.YNc(12,rn,3,1,"ng-container",33),t.TgZ(13,"th"),t._uU(14,"Action"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(15,"tbody"),t.YNc(16,un,2,1,"ng-container",11),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"div",20),t.TgZ(18,"button",21),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).nextCover()}),t._uU(19,"Next"),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngClass","BENEFI"==e.activeBox?"active":"inactive"),t.xp6(11),t.Q6J("ngForOf",e.tableReform),t.xp6(4),t.Q6J("ngIf",e.tempData.benefi)}}function gn(o,c){if(1&o&&(t.TgZ(0,"div",5),t.TgZ(1,"div",6),t.TgZ(2,"h4",7),t._uU(3),t.qZA(),t.TgZ(4,"div",8),t.YNc(5,on,2,1,"button",9),t.YNc(6,an,2,1,"button",10),t.qZA(),t.qZA(),t.YNc(7,pn,20,3,"ng-container",11),t.qZA()),2&o){const e=t.oxw();t.xp6(3),t.Oqu(e.benefiForm.pageTitle),t.xp6(2),t.Q6J("ngIf","BENEFI"==e.activeBox),t.xp6(1),t.Q6J("ngIf","BENEFI"!=e.activeBox),t.xp6(1),t.Q6J("ngIf",e.stepData.step2)}}function mn(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleAccordion("COVER")}),t._UZ(1,"span",23),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",!e.stepData.step3)}}function _n(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleAccordion("COVER")}),t._UZ(1,"span",25),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",!e.stepData.step3)}}function hn(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",17),t.TgZ(2,"app-coverage-page",40),t.NdJ("actionEvent",function(){return t.CHM(e),t.oxw().coverDone()}),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngClass","COVER"==e.activeBox?"active":"inactive"),t.xp6(1),t.Q6J("product",e.product)("optionId",e.oldData.id)("editData",e.editData)("resourcesId",e.resourceId)}}let fn=(()=>{class o{constructor(e,i,n,a,r,s,d,u,m,h,f,D){this.globalFun=e,this.numberPipe=i,this.pageDataService=n,this.prodService=a,this.datePipe=r,this.masterServer=s,this.auth=d,this.cdRef=u,this.travelRikService=m,this.modalService=h,this.alert=f,this.ngModal=D,this.list=[],this.editData={},this.oldData={},this.tempData={travelDetail:null,traveler:null,benefi:[],cover:[]},this.stepData={step1:!1,step2:!1,step3:!1,step4:!1},this.tableReform=[],this.premium=0,this.activeBox="DETAIL"}get validCancel(){return!(!(this.stepData.step1||this.stepData.step2||this.stepData.step3||this.stepData.step4)||this.stepData.step1&&this.stepData.step2&&this.stepData.step3&&this.stepData.step4)}ngOnInit(){this.globalFun.travelPremiumResult.subscribe(e=>{this.premium=e})}calPremimun(){this.oldData.id?this.updateTravelRisk():this.saveTravelRisk()}nextCover(){this.stepData.step3=!0,this.activeBox="COVER"}coverDone(){this.stepData.step4=!0,this.activeBox="COVER"}toggleAccordion(e){this.activeBox=e==this.activeBox?"":e}deleteData(e,i){this.alert.activate("Are you sure want to delete?","Warning Message").then(n=>{n&&this.pageDataService.deleteData(this.benefiForm.tableName,i.refId,this.benefiForm.id).toPromise().then(a=>{a&&(this.tempData.benefi.splice(e,1),this.cdRef.detectChanges(),this.alert.activate("This record was deleted","Success Message").then(r=>{}))})})}download(e,i){}newData(e,i){const n=this.benefiForm,a=this.modalService.open(Y,{size:"xl"});a.componentInstance.controls=n.controls,a.componentInstance.pageName=n.pageTitle,a.componentInstance.activateForm=n,a.componentInstance.benefiArray=this.tempData.benefi,a.componentInstance.oldData=i>=0?e:{},a.result.then(()=>{},r=>{r&&r.data&&"save"==r.type&&(i>=0?this.updateDataAPI(n,r.data,this.tempData.benefi[i].refId,i,"benefi"):this.saveDataAPI(n,r.data,"benefi"))})}saveTravelerTemp(e){"form"==this.travelerForm.pageType&&this.tempData.traveler&&this.tempData.traveler.refId?this.updateDataAPI(this.travelerForm,e,this.tempData.traveler.refId,-1,"traveler"):this.saveDataAPI(this.travelerForm,e,"traveler")}saveDetailTemp(e){"form"==this.prodDetailForm.pageType&&this.tempData.travelDetail&&this.tempData.travelDetail.refId?this.updateDataAPI(this.prodDetailForm,e,this.tempData.travelDetail.refId):this.saveDataAPI(this.prodDetailForm,e)}checkMasterValue(e,i,n){Array.isArray(n)?n[0].formData=e:n.formData=e;let a=Object.keys(e).filter(r=>(e[r]+"").includes("T-"));if(a.length>0){let s={codeBookRequest:a.map(u=>{let m=i.find(h=>h.name==u);if(m.masterData)return{codeId:e[u],codeType:m.masterData,langCd:"EN"}})},d=e;return this.masterServer.getMasterValue(s).pipe((0,R.U)(u=>(a.forEach(m=>{let h=i.find(D=>D.name==m),f=u.findIndex(D=>D.codeId==d[m]&&h.masterData==D.codeType);f>=0&&(d[m+"Value"]=u[f].codeName)}),Array.isArray(n)?n[0].formData=d:n.formData=d,n)))}return(0,b.of)(n)}saveData(e,i){return(0,v.mG)(this,void 0,void 0,function*(){if(i.function&&!(yield this.globalFun[i.function]("",e.form.getRawValue(),[],!0))||!e.handleSubmit())return!1})}saveDataAPI(e,i,n="travelDetail"){this.premiumAmt=this.premiumAmt?this.premiumAmt:"0";let a={productId:this.product.id,type:this.prodService.viewType,tableName:e.tableName,resourceId:this.resourceId,agentId:this.auth.currentUserValue.id||1,quotationId:this.referenceID,pageId:e.id,customerId:this.prodService.creatingCustomer.customerId,leadId:this.prodService.creatingLeadId||null,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,policyNumber:null,party:e.party||!1,pageData:[{data:[]}]};for(const[r,s]of Object.entries(i)){let d=e.controls.find(m=>m.name==r),u=s;d&&(u="input"==d.input&&"number"==d.type?Number(s):s,Array.isArray(u)&&(u=u.join("#-#"),u.includes("#-#")||(u+="#+#"))),a.pageData[0].data.push({column:r,value:u,party:d&&d.party||!1})}"travelDetail"!=n&&a.pageData[0].data.push({column:"risk_id",value:this.riskId,party:!1}),this.pageDataService.save(a).pipe((0,B.w)(r=>"table"==e.pageType?this.checkMasterValue(i,e.controls,r):(0,b.of)(r))).toPromise().then(r=>{r&&(this.resourceId||(this.resourceId=r[0].resourceId),"table"==e.pageType?(i=r[0].formData,this.tempData[n]?this.tempData[n].push(Object.assign(Object.assign({},i),{refId:r[0].refId,pageId:e.id})):this.tempData[n]=[Object.assign(Object.assign({},i),{refId:r[0].refId})],this.globalFun.tempFormData=this.tempData,this.cdRef.detectChanges()):(this.tempData[n]=Object.assign(Object.assign({},i),{refId:r[0].refId,pageId:e.id}),"travelDetail"==n&&(this.riskId=r[0].refId,this.stepData.step1=!0,this.activeBox="TRAVELER"),"traveler"==n&&(this.stepData.step2=!0,this.activeBox="BENEFI")))})}updateDataAPI(e,i,n,a=-1,r="travelDetail"){this.premiumAmt=this.premiumAmt?this.premiumAmt:"0";let s={productId:this.prodService.createingProd.id,type:this.prodService.viewType,tableName:e.tableName,resourceId:this.resourceId,refId:n,customerId:this.prodService.creatingCustomer.customerId,quotationId:this.referenceID,agentId:this.auth.currentUserValue.id||1,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,policyNumber:null,pageId:e.id,leadId:this.prodService.creatingLeadId||null,party:e.party||!1,data:[]};for(const[d,u]of Object.entries(i)){let m=e.controls.find(f=>f.name==d),h=u;m&&(h="input"==m.input&&"number"==m.type?Number(u):u,Array.isArray(h)&&(h=h.join("#-#"),h.includes("#-#")||(h+="#+#"))),s.data.push({column:d,value:h,party:m&&m.party||!1})}this.pageDataService.updateNoID(s).pipe((0,B.w)(d=>"table"==e.pageType?this.checkMasterValue(i,e.controls,d):(0,b.of)(d))).toPromise().then(d=>{d&&(a<0?(this.tempData[r]=Object.assign(Object.assign({},i),{refId:d.refId}),"travelDetail"==r&&(this.stepData.step1=!0,this.activeBox="TRAVELER"),"traveler"==r&&(this.stepData.step2=!0,this.activeBox="BENEFI")):(i=d.formData,this.tempData[r][a]=Object.assign(Object.assign({},i),{refId:d.refId}),this.globalFun.tempFormData=this.tempData,this.cdRef.detectChanges()))})}getCoverData(){}saveTravelRisk(){let e={insuredUnit:this.tempData.travelDetail.insured_unit,noOfTraveller:this.tempData.travelDetail.no_of_traveler,premium:this.premium,resourceId:this.resourceId,totalUnit:parseInt(this.tempData.travelDetail.travel_unit),travelDuration:this.tempData.travelDetail.travel_duration,travelPlan:this.tempData.travelDetail.travel_plan,travellerName:this.tempData.traveler.traveler_name,sumInsured:0,riskId:this.tempData.travelDetail.refId,resourceData:{agentId:this.auth.currentUserValue.id||1,customerId:this.prodService.creatingCustomer.customerId,policyNumber:null,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,productId:this.prodService.createingProd.id,quotationId:this.prodService.referenceID,leadId:this.prodService.creatingLeadId||null,type:this.prodService.type}};this.travelRikService.save(e).toPromise().then(i=>{i&&this.ngModal.dismiss({type:"save",data:Object.assign(Object.assign({},e),{id:i}),detail:this.tempData.travelDetail,traveler:this.tempData.traveler,benefi:this.tempData.benefi})})}updateTravelRisk(){let e={id:this.oldData.id,insuredUnit:this.tempData.travelDetail.insured_unit,noOfTraveller:this.tempData.travelDetail.no_of_traveler,premium:this.premium,resourceId:this.resourceId,totalUnit:parseInt(this.tempData.travelDetail.travel_unit),travelDuration:this.tempData.travelDetail.travel_duration,travelPlan:this.tempData.travelDetail.travel_plan,travellerName:this.tempData.traveler.traveler_name,sumInsured:0,riskId:this.tempData.travelDetail.refId,resourceData:{agentId:this.auth.currentUserValue.id||1,customerId:this.prodService.creatingCustomer.customerId,policyNumber:null,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,productId:this.prodService.createingProd.id,quotationId:this.prodService.referenceID,leadId:this.prodService.creatingLeadId||null,type:this.prodService.type}};this.travelRikService.updateNoID(e).toPromise().then(i=>{i&&this.ngModal.dismiss({type:"save",data:Object.assign(Object.assign({},e),{id:i}),detail:this.tempData.travelDetail,traveler:this.tempData.traveler,benefi:this.tempData.benefi})})}getOtherData(e,i){for(let n of e)if(i[n.name]&&(i[n.name]+"").length>0){if("input"==n.type&&"currency"==n.subType)return this.numberPipe.transform(i[n.name]);if("date"==n.type)return this.datePipe.transform(i[n.name],"dd/MM/yyyy");if(n.options.length>0){let r=n.options.find(s=>s.value==i[n.name]);if(r)return r.text}return i[n.name]}}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.Q),t.Y36(_.JJ),t.Y36(j.Q),t.Y36(M.f),t.Y36(_.uU),t.Y36(et.D),t.Y36(U.e8),t.Y36(t.sBO),t.Y36(It.G),t.Y36(g.FF),t.Y36(w.c),t.Y36(g.Kz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-travel-risk-detail"]],viewQuery:function(e,i){if(1&e&&(t.Gf(P.r,5),t.Gf(P.r,5)),2&e){let n;t.iGM(n=t.CRH())&&(i.dynForm=n.first),t.iGM(n=t.CRH())&&(i.dynFormTraveler=n.first)}},inputs:{list:"list",product:"product",editData:"editData",oldData:"oldData",resourceId:"resourceId",referenceID:"referenceID",premiumAmt:"premiumAmt",prodDetailForm:"prodDetailForm",travelerForm:"travelerForm",benefiForm:"benefiForm",riskId:"riskId",sumInsured:"sumInsured",tempData:"tempData"},decls:21,vars:8,consts:[[1,"modal-content"],[1,"modal-header"],["id","example-modal-sizes-title-lg",1,"modal-title","h4","left-border-image"],[1,"overlay","overlay-block","cursor-default","modal-body"],["class","toggle-box",4,"ngIf"],[1,"toggle-box"],[1,"toggle-header"],[1,"left-border-image"],[1,"tool-box"],["type","button","class","icon",3,"disabled","click",4,"ngIf"],["type","button","class","icon ml-2",3,"disabled","click",4,"ngIf"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-2",3,"disabled","click"],["type","button",1,"btn","btn-primary","btn-elevate",3,"disabled","click"],["type","button","class","icon",3,"click",4,"ngIf"],["type","button","class","icon ml-2",3,"click",4,"ngIf"],[1,"toggle-body",3,"ngClass"],[3,"tempData","config","editStage","submit"],["dynForm",""],[1,"form-footer"],["type","submit",1,"btn","btn-primary","btn-elevate",3,"click"],["type","button",1,"icon",3,"click"],[1,"flaticon2-back"],["type","button",1,"icon","ml-2",3,"click"],[1,"flaticon2-down"],["type","button",1,"icon",3,"disabled","click"],["type","button",1,"icon","ml-2",3,"disabled","click"],["dynFormTraveler",""],[1,"form-group"],["type","button",1,"btn","btn-primary","mx-2",3,"click"],[1,"table-responsive","angular-bootstrap-table"],[1,"table","table-head-custom","table-vertical-center"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],["title","Edit Data",1,"btn","btn-icon","btn-light","btn-hover-danger","btn-sm","mx-1",3,"click"],[1,"svg-icon","svg-icon-md","svg-icon-primary",3,"inlineSVG","cacheSVG"],["title","Delete UI",1,"btn","btn-icon","btn-light","btn-hover-danger","btn-sm",3,"click"],[1,"svg-icon","svg-icon-md","svg-icon-danger",3,"inlineSVG","cacheSVG"],["href","javascript:;",3,"click"],[3,"product","optionId","editData","resourcesId","actionEvent"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3," Travel "),t.qZA(),t.qZA(),t.TgZ(4,"div",3),t.YNc(5,Ki,13,8,"div",4),t.YNc(6,nn,8,4,"div",4),t.YNc(7,gn,8,4,"div",4),t.TgZ(8,"div",5),t.TgZ(9,"div",6),t.TgZ(10,"h4",7),t._uU(11,"Cover Details"),t.qZA(),t.TgZ(12,"div",8),t.YNc(13,mn,2,1,"button",9),t.YNc(14,_n,2,1,"button",10),t.qZA(),t.qZA(),t.YNc(15,hn,3,5,"ng-container",11),t.qZA(),t.qZA(),t.TgZ(16,"div",12),t.TgZ(17,"button",13),t.NdJ("click",function(){return i.calPremimun()}),t._uU(18,"Cancel"),t.qZA(),t.TgZ(19,"button",14),t.NdJ("click",function(){return i.calPremimun()}),t._uU(20,"Save"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngIf",i.prodDetailForm),t.xp6(1),t.Q6J("ngIf",i.travelerForm),t.xp6(1),t.Q6J("ngIf",i.benefiForm),t.xp6(6),t.Q6J("ngIf","COVER"==i.activeBox),t.xp6(1),t.Q6J("ngIf","COVER"!=i.activeBox),t.xp6(1),t.Q6J("ngIf",i.stepData.step3),t.xp6(2),t.Q6J("disabled",i.validCancel),t.xp6(2),t.Q6J("disabled",!i.stepData.step4))},directives:[_.O5,_.mk,P.r,_.sg,ut.d$,_t],styles:[".toggle-box[_ngcontent-%COMP%]{padding-bottom:1.75rem}.toggle-box[_ngcontent-%COMP%]   .toggle-header[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between;border-bottom:1px solid #E3E3E3}.toggle-box[_ngcontent-%COMP%]   .toggle-header[_ngcontent-%COMP%]   .tool-box[_ngcontent-%COMP%]{display:inline-block}.toggle-box[_ngcontent-%COMP%]   .toggle-header[_ngcontent-%COMP%]   .tool-box[_ngcontent-%COMP%]   button.icon[_ngcontent-%COMP%]{background:transparent;font-size:1.5rem}.toggle-box[_ngcontent-%COMP%]   .toggle-body[_ngcontent-%COMP%]{transition:1s all;padding:.5rem}.toggle-box[_ngcontent-%COMP%]   .toggle-body.active[_ngcontent-%COMP%]{display:block;height:auto;visibility:visible}.toggle-box[_ngcontent-%COMP%]   .toggle-body.inactive[_ngcontent-%COMP%]{display:none;visibility:hidden;overflow:hidden}.toggle-box[_ngcontent-%COMP%]   .toggle-body[_ngcontent-%COMP%]   .form-footer[_ngcontent-%COMP%]{text-align:right;padding:.9rem 0;border-bottom:1px solid #E3E3E3}"]}),o})();function vn(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr"),t.TgZ(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"titlecase"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"titlecase"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"titlecase"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.ALo(21,"number"),t.qZA(),t.TgZ(22,"td"),t.TgZ(23,"a",9),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().newData("edit",a)}),t._UZ(24,"span",10),t.qZA(),t.TgZ(25,"a",11),t.NdJ("click",function(){const a=t.CHM(e).index;return t.oxw().delete(a)}),t._UZ(26,"span",12),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=c.$implicit,i=t.oxw();t.xp6(3),t.Oqu(e.riskId),t.xp6(2),t.Oqu(t.lcZ(6,8,i.replaceT(e.travelPlan))),t.xp6(3),t.Oqu(t.lcZ(9,10,i.replaceT(e.insuredUnit))),t.xp6(3),t.Oqu(t.lcZ(12,12,i.replaceT(e.travelDuration))),t.xp6(3),t.Oqu(e.noOfTraveller),t.xp6(2),t.Oqu(e.totalUnit),t.xp6(2),t.Oqu(e.travellerName),t.xp6(2),t.Oqu(t.lcZ(21,14,e.premium))}}const Cn={addon_1634010770155:mt,coverage_1634010995936:_t,static_1634018514043:Gi,static_1635218894755:qi,static_1635309151504:fe.k,static_1635747288508:Bi,static_1641364737069:xi,static_1643116155828:Pi,static_1644896661652:Pe,static_1644896804675:ht,static_1648784270356:(()=>{class o{constructor(e,i,n,a,r,s,d,u,m){this.globalFun=e,this.travelRikService=i,this.modalService=n,this.cdf=a,this.numberPipe=r,this.pageDataService=s,this.prodService=d,this.alertService=u,this.ngZone=m,this.travelForm=[],this.listData=[],this.tempData={},this.tableReform=[],this.requiredForm={detail:null,traveler:null,benefi:null},this.actionEvent=new t.vpe}ngOnInit(){this.travelForm.length<3?this.alertService.activate("This page cann't to process because there is not match with requirement configuration. Please check travel product config in prodcut configuration","Warning"):(this.requiredForm.detail=this.travelForm.find(e=>"travel_detail_0001"==e.unitCode),this.requiredForm.traveler=this.travelForm.find(e=>"traveler_0002"==e.unitCode),this.requiredForm.benefi=this.travelForm.find(e=>"trave_benefi_0003"==e.unitCode),this.getRiskList(),this.callback())}callback(){this.prodService.editData&&(this.resourcesId=this.prodService.editData.id,this.getOldData(this.prodService.editData)),this.requiredForm.benefi&&this.reFormatTable(this.requiredForm.benefi.controls)}reFormatTable(e){this.tableReform=[];let i=[],n=JSON.parse(JSON.stringify(e));for(let a of n){let r=!1;if(a.options=a.options?a.options:[],!a.isHideView)if(a.tableTitle&&(i.findIndex(d=>d==a.tableTitle)<0?i.push(a.tableTitle):r=!0),r){let s=this.tableReform.findIndex(d=>d.parent==a.dependency.parentName);s>=0&&this.tableReform[s].cols.push({name:"true"==a.master?a.name+"Value":a.name,type:a.input,subType:a.type,options:("false"==a.master||0==a.master)&&a.options.length>0?a.options:[]})}else this.tableReform.push({title:a.tableTitle||a.label||a.name,cols:[{name:"true"==a.master?a.name+"Value":a.name,type:a.input,subType:a.type,options:("false"==a.master||0==a.master)&&a.options.length>0?a.options:[]}],type:a.input,subType:a.type,parent:a.dependency?a.dependency.parentName:"",options:("false"==a.master||0==a.master)&&a.options.length>0?a.options:[]})}}getRiskList(){this.travelRikService.getMany(this.resourcesId).toPromise().then(e=>{e&&(this.globalFun.tempFormData[C.rf]=e,this.listData=e||[],this.cdf.detectChanges())})}newData(e,i){let n=this.modalService.open(fn,{size:"xl",backdrop:!1});if(n.componentInstance.type=e,n.componentInstance.riskId=i?i.riskId:"",n.componentInstance.oldData=i||{},n.componentInstance.resourceId=this.resourcesId,n.componentInstance.product=this.product,n.componentInstance.editData=this.editData,n.componentInstance.premiumAmt=this.premiumAmt,n.componentInstance.prodDetailForm=this.requiredForm.detail,n.componentInstance.travelerForm=this.requiredForm.traveler,n.componentInstance.benefiForm=this.requiredForm.benefi,n.componentInstance.tableReform=this.tableReform,i){let a=this.tempData.travelDetail.find(d=>d.refId==i.riskId),r=this.tempData.traveler.find(d=>d.risk_id==i.riskId),s=this.tempData.benefi.filter(d=>d.risk_id==i.riskId);this.globalFun.tempFormData[this.requiredForm.benefi.tableName+this.requiredForm.benefi.id]=s,n.componentInstance.tempData={travelDetail:a||{},traveler:r||{},benefi:s||[]}}n.result.then(()=>{},a=>{if(a&&"save"==a.type){if(i){let r=this.listData.findIndex(s=>s.id==i.id);this.listData[r]=a.data}else{let r=this.listData.findIndex(s=>s.id==a.data.id);r>=0?this.listData[r]=a.data:this.listData.push(a.data)}this.cdf.detectChanges(),this.changeTravelDetail(a.detail),this.changeTraveler(a.traveler),this.changeBenefi(a.benefi,a.detail.refId)}})}changeTravelDetail(e){let i=this.tempData.travelDetail.findIndex(n=>n.refId==e.refId);i<0?this.tempData.travelDetail.push(e):this.tempData.travelDetail[i]=e}changeTraveler(e){let i=this.tempData.traveler.findIndex(n=>n.refId==e.refId);i<0?this.tempData.traveler.push(e):this.tempData.traveler[i]=e}changeBenefi(e,i){let n=this.tempData.benefi.filter(a=>a.risk_id!=i);this.tempData.benefi=[...n,...e]}delete(e){this.alertService.activate("Are you sure want to delete?","Warning Message").then(i=>{i&&this.travelRikService.delete(this.listData[e].id).toPromise().then(n=>{n&&(this.listData.splice(e,1),this.cdf.detectChanges(),this.alertService.activate("This record was deleted","Success Message").then(a=>{}))})})}nextPage(){this.listData.length>0&&(this.globalFun.tempFormData[C.rf]=this.listData,this.savePremimunFire().toPromise().then(e=>{this.actionEvent.emit({type:T.V.NEXT})}))}savePremimunFire(){this.caluPremimun();let i={premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,resourceId:this.resourcesId,type:"policy"};return this.pageDataService.updatePremimun(i)}caluPremimun(){let e=this.listData.reduce(function(i,n){return i+parseInt(n.premium)},0);return this.premiumAmt=this.numberPipe.transform(e)+" MMK",this.globalFun.paPremiumResult.next(this.premiumAmt),this.premiumAmt}replaceT(e){return e.replace("T-","").replace("TU-","")}backPage(){this.listData.length>0&&(this.globalFun.tempFormData[C.rf]=this.listData,this.savePremimunFire()),this.actionEvent.emit({type:T.V.PREV})}getOldData(e,i){let n=0;this.travelForm.forEach(a=>{n+=1,a.type==I.it.DYN&&this.pageDataService.getDetail(a.tableName,e.id,a.id,"table"==a.pageType,a.controls,!0).toPromise().then(s=>(0,v.mG)(this,void 0,void 0,function*(){if(s&&s.length>0){let d=[],u=i;for(const h of s){let f={};for(const D of h.data)"id"==D.column&&!u&&(f.refId=D.value),f[D.column]=(D.value+"").includes("#-#")?(D.value+"").split("#-#"):(D.value+"").includes("#+#")?[D.value.replace("#+#","")]:D.value;Array.isArray(d)&&d.push(f)}let m="travelDetail";"traveler_0002"==a.unitCode&&(m="traveler"),"trave_benefi_0003"==a.unitCode&&(m="benefi"),this.tempData[m]=d,a.function&&"form"==a.pageType&&this.globalFun[a.function]("",this.tempData[a.tableName+a.id])}})).catch(s=>{})})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.Q),t.Y36(It.G),t.Y36(g.FF),t.Y36(t.sBO),t.Y36(_.JJ),t.Y36(j.Q),t.Y36(M.f),t.Y36(w.c),t.Y36(t.R0b))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-travel-risk"]],inputs:{product:"product",editData:"editData",resourcesId:"resourcesId",referenceID:"referenceID",premiumAmt:"premiumAmt",travelForm:"travelForm"},outputs:{actionEvent:"actionEvent"},decls:34,vars:1,consts:[[1,"form-group"],["type","button",1,"btn","btn-primary","mx-2",3,"click"],[1,"table-responsive","angular-bootstrap-table"],[1,"table","table-head-custom","table-vertical-center"],[4,"ngFor","ngForOf"],[1,"row","mt-3"],[1,"col-sm-6","mx-auto"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"],["title","Edit",1,"btn","btn-primary","btn-cus","btn-sm","mx-1",3,"click"],[1,"flaticon-edit"],["title","Delete",1,"btn","btn-danger","btn-cus","btn-sm","mx-1",3,"click"],[1,"flaticon-delete"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"button",1),t.NdJ("click",function(){return i.newData("add")}),t._uU(2,"Add New Data"),t.qZA(),t.qZA(),t.TgZ(3,"div",2),t.TgZ(4,"table",3),t.TgZ(5,"thead"),t.TgZ(6,"tr"),t.TgZ(7,"th"),t._uU(8,"Risk No"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Travel Plan"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Insured Unit"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Travel Duration"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"No. Of Traveller"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Total Unit"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Traveller Name"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"Premium"),t.qZA(),t.TgZ(23,"th"),t._uU(24,"Action"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"tbody"),t.YNc(26,vn,27,16,"ng-container",4),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",5),t.TgZ(28,"div",6),t.TgZ(29,"button",7),t.NdJ("click",function(){return i.backPage()}),t._uU(30," Previous "),t.qZA(),t.qZA(),t.TgZ(31,"div",6),t.TgZ(32,"button",8),t.NdJ("click",function(){return i.nextPage()}),t._uU(33," Save & Next "),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(26),t.Q6J("ngForOf",i.listData))},directives:[_.sg],pipes:[_.rS,_.JJ],encapsulation:2}),o})(),static_1648784270432:Ui};let wt=(()=>{class o{constructor(e,i){this.resolver=e,this.container=i,this.travelForm=[],this.eventOut=new t.vpe}ngOnInit(){this.reCreate()}reCreate(){this.container.clear();const e=this.resolver.resolveComponentFactory(Cn[this.compId]);this.component=this.container.createComponent(e),this.component.instance.product=this.product,this.component.instance.editData=this.editData,this.component.instance.resourcesId=this.resourcesId,this.component.instance.referenceID=this.referenceID,this.component.instance.premiumAmt=this.premiumAmt,this.component.instance.travelForm=this.travelForm,this.component.instance.actionEvent.subscribe(i=>{this.eventOut.emit(i)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t._Vd),t.Y36(t.s_b))},o.\u0275dir=t.lG2({type:o,selectors:[["","staticPage",""]],inputs:{compId:"compId",product:"product",resourcesId:"resourcesId",referenceID:"referenceID",premiumAmt:"premiumAmt",editData:"editData",travelForm:"travelForm"},outputs:{eventOut:"eventOut"}}),o})();var bn=p(49875),Tn=p(77720);const pt=function(o,c){return{active:o,done:c}};function Dn(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"a",16),t.NdJ("click",function(){const a=t.CHM(e).index;return t.oxw(4).changePage(a)}),t.TgZ(2,"div",17),t.TgZ(3,"div",18),t.TgZ(4,"span"),t._uU(5),t.qZA(),t._uU(6),t.qZA(),t._UZ(7,"div",19),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=c.$implicit,i=c.index,n=t.oxw(4);t.xp6(2),t.Q6J("ngClass",t.WLB(3,pt,i==n.activePage,i<n.activePage)),t.xp6(3),t.Oqu(i+1),t.xp6(1),t.hij(" ",e.pageTitle,"")}}function An(o,c){if(1&o&&(t.ynx(0),t.TgZ(1,"div",11),t.TgZ(2,"div",12),t.TgZ(3,"div",13),t.TgZ(4,"div",14),t.YNc(5,Dn,8,6,"ng-container",15),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()),2&o){const e=t.oxw(3);t.xp6(5),t.Q6J("ngForOf",e.pageOrder)}}function On(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"a",16),t.NdJ("click",function(){const a=t.CHM(e).index;return t.oxw(4).changePage(a)}),t.TgZ(2,"div",17),t._UZ(3,"i"),t.TgZ(4,"h3",18),t._uU(5),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=c.$implicit,i=c.index,n=t.oxw(4);t.xp6(2),t.Q6J("ngClass",t.WLB(6,pt,i==n.activePage,i<n.activePage)),t.xp6(1),t.Gre("wizard-icon fa ",e.pageIcon,""),t.xp6(2),t.AsE("",i+1,") ",e.pageTitle,"")}}function Pn(o,c){if(1&o&&(t.ynx(0),t.TgZ(1,"div",20),t.TgZ(2,"div",21),t.TgZ(3,"div",14),t.YNc(4,On,6,9,"ng-container",15),t.qZA(),t.qZA(),t.qZA(),t.BQk()),2&o){const e=t.oxw(3);t.xp6(4),t.Q6J("ngForOf",e.pageOrder)}}function yn(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"a",16),t.NdJ("click",function(){const a=t.CHM(e).index;return t.oxw(4).changePage(a)}),t.TgZ(2,"div",26),t.TgZ(3,"div",27),t._UZ(4,"span"),t.qZA(),t.TgZ(5,"div",28),t.TgZ(6,"div",18),t._uU(7),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=c.$implicit,i=c.index,n=t.oxw(4);t.xp6(2),t.Q6J("ngClass",t.WLB(5,pt,i==n.activePage,i<n.activePage)),t.xp6(2),t.Gre("fa ",e.pageIcon,""),t.xp6(3),t.hij(" ",e.pageTitle,"")}}const qt=function(){return{}};function xn(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"dynamic-form",29,30),t.NdJ("submit",function(n){return t.CHM(e),t.oxw(5).saveTemp(n)}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(5);t.xp6(1),t.Q6J("config",e.formData[e.activePage].controls)("editStage",!1)("tempData",e.tempData[e.formData[e.activePage].tableName+e.formData[e.activePage].id]||t.DdM(3,qt))}}function In(o,c){if(1&o&&(t.ynx(0),t.TgZ(1,"th"),t._uU(2),t.qZA(),t.BQk()),2&o){const e=c.$implicit;t.xp6(2),t.Oqu(e.title)}}function Mn(o,c){if(1&o&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,i=t.oxw().$implicit,n=t.oxw(7);t.xp6(1),t.Oqu(n.getOtherData(e.cols,i))}}function wn(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"td"),t.TgZ(1,"a",40),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw().$implicit;return t.oxw(7).download(n.cols,a)}),t._uU(2),t.qZA(),t.qZA()}if(2&o){const e=t.oxw().$implicit,i=t.oxw().$implicit,n=t.oxw(7);t.xp6(2),t.hij(" ",n.getOtherData(e.cols,i)," ")}}function qn(o,c){if(1&o&&(t.ynx(0),t.YNc(1,Mn,2,1,"td",10),t.YNc(2,wn,3,1,"td",10),t.BQk()),2&o){const e=c.$implicit;t.xp6(1),t.Q6J("ngIf","file"!=e.input),t.xp6(1),t.Q6J("ngIf","file"==e.input)}}function Fn(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.YNc(3,qn,3,2,"ng-container",15),t.TgZ(4,"td",35),t.TgZ(5,"a",36),t.NdJ("click",function(){const n=t.CHM(e),a=n.$implicit,r=n.index;return t.oxw(7).newData(a,r)}),t._UZ(6,"span",37),t.qZA(),t.TgZ(7,"a",38),t.NdJ("click",function(){const n=t.CHM(e),a=n.index,r=n.$implicit;return t.oxw(7).deleteData(a,r)}),t._UZ(8,"span",39),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=c.index,i=t.oxw(7);t.xp6(2),t.Oqu(e+1),t.xp6(1),t.Q6J("ngForOf",i.formData[i.activePage].controls),t.xp6(3),t.Q6J("inlineSVG","./assets/media/svg/icons/Communication/Write.svg")("cacheSVG",!0),t.xp6(2),t.Q6J("inlineSVG","./assets/media/svg/icons/General/Trash.svg")("cacheSVG",!0)}}function kn(o,c){if(1&o&&(t.ynx(0),t.YNc(1,Fn,9,6,"tr",15),t.BQk()),2&o){const e=t.oxw(6);t.xp6(1),t.Q6J("ngForOf",e.tempData[e.formData[e.activePage].tableName+e.formData[e.activePage].id])}}function Sn(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",31),t.TgZ(2,"button",32),t.NdJ("click",function(){return t.CHM(e),t.oxw(5).newData()}),t._uU(3,"Add New Data"),t.qZA(),t.qZA(),t._UZ(4,"hr"),t.TgZ(5,"div",33),t.TgZ(6,"table",34),t.TgZ(7,"thead"),t.TgZ(8,"tr"),t.TgZ(9,"th"),t._uU(10,"NO"),t.qZA(),t.YNc(11,In,3,1,"ng-container",15),t.TgZ(12,"th"),t._uU(13,"Action"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"tbody"),t.YNc(15,kn,2,1,"ng-container",10),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(5);t.xp6(11),t.Q6J("ngForOf",e.tableReform),t.xp6(4),t.Q6J("ngIf",e.tempData[e.formData[e.activePage].tableName+e.formData[e.activePage].id])}}function Nn(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",42),t.NdJ("eventE",function(n){return t.CHM(e),t.oxw(6).clickBtn(n)}),t.qZA()}if(2&o){const e=c.$implicit,i=c.index;t.IyS("col-xs-",e.size," col-sm-",e.size," ",e.position," mt-2"),t.Q6J("config",e)("index",i)("editStage",!1)}}function Un(o,c){if(1&o&&(t.ynx(0),t._UZ(1,"hr"),t.TgZ(2,"div",1),t.YNc(3,Nn,1,8,"div",41),t.qZA(),t.BQk()),2&o){const e=t.oxw(5);t.xp6(3),t.Q6J("ngForOf",e.formData[e.activePage].buttons)}}function zn(o,c){if(1&o){const e=t.EpF();t.ynx(0),t._UZ(1,"hr"),t.TgZ(2,"div",1),t.TgZ(3,"div",43),t.TgZ(4,"button",44),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(5);return n.backPage(n.activePage)}),t._uU(5," Previous "),t.qZA(),t.qZA(),t.TgZ(6,"div",43),t.TgZ(7,"button",45),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(5);return n.nextPage(n.activePage)}),t._uU(8," Save & Next "),t.qZA(),t.qZA(),t.qZA(),t.BQk()}}function Rn(o,c){if(1&o&&(t.ynx(0),t.YNc(1,xn,3,4,"ng-container",10),t.YNc(2,Sn,16,2,"ng-container",10),t.YNc(3,Un,4,1,"ng-container",10),t.YNc(4,zn,9,0,"ng-container",10),t.BQk()),2&o){const e=t.oxw(4);t.xp6(1),t.Q6J("ngIf","table"!=e.formData[e.activePage].pageType),t.xp6(1),t.Q6J("ngIf","table"==e.formData[e.activePage].pageType),t.xp6(1),t.Q6J("ngIf","table"!=e.formData[e.activePage].pageType),t.xp6(1),t.Q6J("ngIf","table"==e.formData[e.activePage].pageType)}}function Jn(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.ynx(1,46),t.NdJ("eventOut",function(n){return t.CHM(e),t.oxw(4).staticEvent(n)}),t.BQk(),t.BQk()}if(2&o){const e=t.oxw(4);t.xp6(1),t.Q6J("compId",e.pageOrder[e.activePage].id)("product",e.item)("editData",e.editData)("resourcesId",e.resourceId)("premiumAmt",e.premiumAmt)}}function En(o,c){if(1&o&&(t.ynx(0),t.TgZ(1,"div",22),t.TgZ(2,"div",23),t.TgZ(3,"div",24),t.YNc(4,yn,8,8,"ng-container",15),t.qZA(),t.qZA(),t.TgZ(5,"div",25),t.YNc(6,Rn,5,4,"ng-container",10),t.YNc(7,Jn,2,5,"ng-container",10),t.qZA(),t.qZA(),t.BQk()),2&o){const e=t.oxw(3);t.xp6(4),t.Q6J("ngForOf",e.pageOrder),t.xp6(2),t.Q6J("ngIf","dyn"==e.pageOrder[e.activePage].type),t.xp6(1),t.Q6J("ngIf","static"==e.pageOrder[e.activePage].type)}}function Bn(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"dynamic-form",49,30),t.NdJ("submit",function(n){return t.CHM(e),t.oxw(5).saveTemp(n)}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(5);t.xp6(1),t.Q6J("tempData",e.tempData[e.formData[e.activePage].tableName+e.formData[e.activePage].id]||t.DdM(3,qt))("config",e.formData[e.activePage].controls)("editStage",!1)}}function Qn(o,c){if(1&o&&(t.ynx(0),t.TgZ(1,"th"),t._uU(2),t.qZA(),t.BQk()),2&o){const e=c.$implicit;t.xp6(2),t.Oqu(e.title)}}function Vn(o,c){if(1&o&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,i=t.oxw().$implicit,n=t.oxw(7);t.xp6(1),t.Oqu(n.getOtherData(e.cols,i))}}function Yn(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"td"),t.TgZ(1,"a",40),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw().$implicit;return t.oxw(7).download(n.cols,a)}),t._uU(2),t.qZA(),t.qZA()}if(2&o){const e=t.oxw().$implicit,i=t.oxw().$implicit,n=t.oxw(7);t.xp6(2),t.hij(" ",n.getOtherData(e.cols,i)," ")}}function Ln(o,c){if(1&o&&(t.ynx(0),t.YNc(1,Vn,2,1,"td",10),t.YNc(2,Yn,3,1,"td",10),t.BQk()),2&o){const e=c.$implicit;t.xp6(1),t.Q6J("ngIf","file"!=e.type),t.xp6(1),t.Q6J("ngIf","file"==e.type)}}function jn(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.YNc(3,Ln,3,2,"ng-container",15),t.TgZ(4,"td",35),t.TgZ(5,"a",36),t.NdJ("click",function(){const n=t.CHM(e),a=n.$implicit,r=n.index;return t.oxw(7).newData(a,r)}),t._UZ(6,"span",37),t.qZA(),t.TgZ(7,"a",50),t.NdJ("click",function(){const n=t.CHM(e),a=n.index,r=n.$implicit;return t.oxw(7).deleteData(a,r)}),t._UZ(8,"span",39),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=c.index,i=t.oxw(7);t.xp6(2),t.Oqu(e+1),t.xp6(1),t.Q6J("ngForOf",i.tableReform),t.xp6(3),t.Q6J("inlineSVG","./assets/media/svg/icons/Communication/Write.svg")("cacheSVG",!0),t.xp6(2),t.Q6J("inlineSVG","./assets/media/svg/icons/General/Trash.svg")("cacheSVG",!0)}}function Hn(o,c){if(1&o&&(t.ynx(0),t.YNc(1,jn,9,6,"tr",15),t.BQk()),2&o){const e=t.oxw(6);t.xp6(1),t.Q6J("ngForOf",e.tempData[e.formData[e.activePage].tableName+e.formData[e.activePage].id])}}function Gn(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",31),t.TgZ(2,"button",32),t.NdJ("click",function(){return t.CHM(e),t.oxw(5).newData()}),t._uU(3,"Add New Data"),t.qZA(),t.qZA(),t._UZ(4,"hr"),t.TgZ(5,"div",33),t.TgZ(6,"table",34),t.TgZ(7,"thead"),t.TgZ(8,"tr"),t.TgZ(9,"th"),t._uU(10,"NO"),t.qZA(),t.YNc(11,Qn,3,1,"ng-container",15),t.TgZ(12,"th"),t._uU(13,"Action"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"tbody"),t.YNc(15,Hn,2,1,"ng-container",10),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(5);t.xp6(11),t.Q6J("ngForOf",e.tableReform),t.xp6(4),t.Q6J("ngIf",e.tempData[e.formData[e.activePage].tableName+e.formData[e.activePage].id])}}function $n(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",42),t.NdJ("eventE",function(n){return t.CHM(e),t.oxw(6).clickBtn(n)}),t.qZA()}if(2&o){const e=c.$implicit,i=c.index;t.IyS("col-xs-",e.size," col-sm-",e.size," ",e.position," mt-2"),t.Q6J("config",e)("index",i)("editStage",!1)}}function Wn(o,c){if(1&o&&(t.ynx(0),t._UZ(1,"hr"),t.TgZ(2,"div",1),t.YNc(3,$n,1,8,"div",41),t.qZA(),t.BQk()),2&o){const e=t.oxw(5);t.xp6(3),t.Q6J("ngForOf",e.formData[e.activePage].buttons)}}function Kn(o,c){if(1&o){const e=t.EpF();t.ynx(0),t._UZ(1,"hr"),t.TgZ(2,"div",1),t.TgZ(3,"div",43),t.TgZ(4,"button",44),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(5);return n.backPage(n.activePage)}),t._uU(5," Previous "),t.qZA(),t.qZA(),t.TgZ(6,"div",43),t.TgZ(7,"button",45),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(5);return n.nextPage(n.activePage)}),t._uU(8," Save & Next "),t.qZA(),t.qZA(),t.qZA(),t.BQk()}}function Xn(o,c){if(1&o&&(t.ynx(0),t.YNc(1,Bn,3,4,"ng-container",10),t.YNc(2,Gn,16,2,"ng-container",10),t.YNc(3,Wn,4,1,"ng-container",10),t.YNc(4,Kn,9,0,"ng-container",10),t.BQk()),2&o){const e=t.oxw(4);t.xp6(1),t.Q6J("ngIf","table"!=e.formData[e.activePage].pageType),t.xp6(1),t.Q6J("ngIf","table"==e.formData[e.activePage].pageType),t.xp6(1),t.Q6J("ngIf","table"!=e.formData[e.activePage].pageType),t.xp6(1),t.Q6J("ngIf","table"==e.formData[e.activePage].pageType)}}function to(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.ynx(1,51),t.NdJ("eventOut",function(n){return t.CHM(e),t.oxw(4).staticEvent(n)}),t.BQk(),t.BQk()}if(2&o){const e=t.oxw(4);t.xp6(1),t.Q6J("compId",e.pageOrder[e.activePage].id)("product",e.item)("editData",e.editData)("resourcesId",e.resourceId)("premiumAmt",e.premiumAmt)("travelForm",e.travelFormss)}}function eo(o,c){if(1&o&&(t.ynx(0),t.TgZ(1,"div",47),t._UZ(2,"div",48),t.YNc(3,Xn,5,4,"ng-container",10),t.YNc(4,to,2,6,"ng-container",10),t.qZA(),t.BQk()),2&o){const e=t.oxw(3);t.xp6(3),t.Q6J("ngIf","dyn"==e.pageOrder[e.activePage].type),t.xp6(1),t.Q6J("ngIf","static"==e.pageOrder[e.activePage].type)}}function io(o,c){if(1&o&&(t.TgZ(0,"div",9),t.YNc(1,An,6,1,"ng-container",10),t.YNc(2,Pn,5,1,"ng-container",10),t.YNc(3,En,8,3,"ng-container",10),t.YNc(4,eo,5,2,"ng-container",10),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf","ui3"==e.viewUI),t.xp6(1),t.Q6J("ngIf","ui1"==e.viewUI),t.xp6(1),t.Q6J("ngIf","ui2"==e.viewUI),t.xp6(1),t.Q6J("ngIf","ui2"!=e.viewUI)}}function no(o,c){if(1&o&&(t.TgZ(0,"div",1),t.TgZ(1,"div",2),t.TgZ(2,"div",3),t.TgZ(3,"div",4),t.TgZ(4,"div",5),t.TgZ(5,"div",6),t._uU(6," PRODUCT "),t._UZ(7,"br"),t.TgZ(8,"span"),t._uU(9),t.qZA(),t.qZA(),t.TgZ(10,"div",7),t._uU(11," PREMIUM "),t._UZ(12,"br"),t.TgZ(13,"span"),t._uU(14),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(15,"div",2),t.TgZ(16,"div",3),t.YNc(17,io,5,4,"div",8),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(9),t.Oqu(e.item.name),t.xp6(5),t.Oqu(e.premiumAmt),t.xp6(3),t.Q6J("ngIf",e.formData.length>0)}}let oo=(()=>{class o{constructor(e,i,n,a,r,s,d,u,m,h,f,D,z,F,co,lo){this.router=e,this.location=i,this.cdRef=n,this.modalService=a,this.prodService=r,this.globalFun=s,this.auth=d,this.pageDataService=u,this.addonQuo=m,this.coverageQuo=h,this.alert=f,this.downloadService=D,this.masterServer=z,this.numberPipe=F,this.datePipe=co,this.ngZone=lo,this.formData=[],this.pageOrder=[],this.tempData={},this.activePage=0,this.premiumAmt="0",this.unsubscribe=[],this.coverage={isSum:!1,isUnit:!1,isPremium:!1},this.addon={isSum:!1,isUnit:!1,isPremium:!1},this.coverageData={},this.addOnData={},this.viewType="view",this.resourceId=null,this.type="",this.referenceID="",this.referenceStatus="",this.tableReform=[],this.detailInput={},this.creatingCustomer={},this.creatingLeadId="",this.travelFormss=[]}ngOnInit(){return(0,v.mG)(this,void 0,void 0,function*(){if("policy"==this.prodService.type&&this.prodService.createingProdRef&&(this.prodService.createingProd=this.prodService.createingProdRef,this.prodService.createingProdRef=null),this.prodService.createingProd){this.item=this.prodService.createingProd,this.viewType=this.prodService.viewType,this.referenceID=this.prodService.referenceID,this.referenceStatus=this.prodService.referenceStatus,this.creatingLeadId=this.prodService.creatingLeadId,this.type=this.prodService.type,this.editData=this.prodService.editData||{},this.creatingCustomer=this.prodService.creatingCustomer,this.premiumAmt=this.editData.premiumView||this.editData.premium||"0";let e=this.globalFun.paPremiumResult.subscribe(i=>{this.premiumAmt=i||"0",this.cdRef.detectChanges()});this.unsubscribe.push(e),this.initProductConfig()}else this.location.back()})}ngOnDestroy(){this.prodService.creatingLeadId="0",this.unsubscribe.forEach(e=>e.unsubscribe())}changePage(e){this.activePage>e&&(this.activePage=e,this.formData[this.activePage].type==I.it.STATIC&&(this.cdRef.detectChanges(),this.staticPage.reCreate()),this.dynForm&&this.formData[this.activePage].controls&&this.dynForm.newFormCreate(this.formData[this.activePage].controls,this.tempData[this.formData[this.activePage].tableName+this.formData[this.activePage].id]))}findPageValue(e,i){let n,a=!!this.referenceID;for(let r=0;r<e.length;r++)if(e[r]&&(n=e[r].fromGroup.find(s=>s.id==i),n)){n.controls.map(s=>(this.detailInput[i]&&"underline"!=s.input&&"label"!=s.input?(s.show=this.detailInput[i][s.name]>=0?this.detailInput[i][s.name]>0:s.show,this.detailInput[i][s.name]>=2&&(s.disabled=!(this.detailInput[i][s.name]>2)||a)):this.detailInput[i]&&"label"==s.input&&(s.show=this.detailInput[i][s.placeholder]>=0?this.detailInput[i][s.placeholder]>0:s.show),s));break}return n}initProductConfig(){if((0,k.cU)(this.item.config)){let e=JSON.parse(this.item.config);if(!e)return this.alert.activate("please setup page group in product configuration.","Creation Error"),this.location.back(),!1;let i=[];if("quotation"==this.prodService.type){if(!this.item.quotation)return this.alert.activate("please setup page group in product configuration.","Creation Error"),this.location.back(),!1;this.pageOrder=e.quotation||[],this.detailInput=e.quotation_input||{},this.viewUI=e.quotation_view||"ui1"}else{if(!this.item.application)return this.alert.activate("please setup page group in product configuration.","Creation Error"),this.location.back(),!1;this.pageOrder=e.application||[],this.detailInput=e.application_input||{},this.viewUI=e.application_view||"ui1"}if(0==this.pageOrder.length)return this.alert.activate("Please Create UI Configuration","Creation Error"),this.location.back(),!1;let n="policy"==this.prodService.type?"application":this.prodService.type;i=this.item.productUIs.map(s=>{if(s.type==n)return JSON.parse(s.dynamicProduct.config)});let a=0,r=this.pageOrder.findIndex(s=>"static_1648784270356"==s.id);if(this.pageOrder.forEach((s,d)=>{if(a+=1,("addon"==s.id&&this.item.addOns.length<1||"coverage"==s.id&&this.item.coverages.length<1)&&this.pageOrder.splice(d,1),s.type==I.it.STATIC)this.formData.push({pageTitle:"",id:(0,Z.Z)(),pageIcon:"",pageType:"form",tableName:"",controls:[],buttons:[],type:s.type});else{let u=this.findPageValue(i,s.id);u.type=s.type,u&&(this.pageOrder[d].pageTitle=u.pageTitle,this.pageOrder[d].pageType=u.pageType,this.pageOrder[d].pageIcon=u.pageIcon,this.pageOrder[d].tableName=u.tableName,this.pageOrder[d].unitCode=u.unitCode,!this.prodService.editData&&!this.referenceID&&"policyholder_1641795142279"==u.unitCode&&this.mapPartyCustomer(u),"policyholder_1641795142279"==u.unitCode&&(u.controls=u.controls.map(m=>(m.disabled=!0,m))),this.formData.push(u))}a==this.pageOrder.length&&this.callback(i)}),r>=0){this.travelFormss=[];let s=this.pageOrder.findIndex(h=>"travel_detail_0001"==h.unitCode);if(s>=0){let h=this.findPageValue(i,this.pageOrder[s].id),f=Object.assign(Object.assign({},this.pageOrder[s]),{function:h.function,controls:h.controls,buttons:h.buttons});this.pageOrder.splice(s,1),this.travelFormss.push(f)}let d=this.pageOrder.findIndex(h=>"traveler_0002"==h.unitCode);if(d>=0){let h=this.findPageValue(i,this.pageOrder[d].id),f=Object.assign(Object.assign({},this.pageOrder[d]),{function:h.function,controls:h.controls,buttons:h.buttons});this.pageOrder.splice(d,1),this.travelFormss.push(f)}let u=this.pageOrder.findIndex(h=>"trave_benefi_0003"==h.unitCode);if(u>=0){let h=this.findPageValue(i,this.pageOrder[u].id),f=Object.assign(Object.assign({},this.pageOrder[u]),{function:h.function,controls:h.controls,buttons:h.buttons});this.pageOrder.splice(u,1),this.travelFormss.push(f)}let m=this.pageOrder.findIndex(h=>"coverage_1634010995936"==h.id);m>=0&&(this.travelFormss.push(this.pageOrder[m]),this.pageOrder.splice(m,1))}}}callback(e){this.prodService.editData?(this.resourceId=this.prodService.editData.id,this.getOldData(this.prodService.editData,e)):this.referenceID&&this.getOldData({id:this.referenceID},e,!0),"table"==this.formData[this.activePage].pageType&&this.reFormatTable(this.formData[this.activePage].controls)}staticEvent(e){e.type==T.V.NEXT?(e.data&&e.data.resourceId&&(this.resourceId=e.data.resourceId),this.nextPage(this.activePage)):e.type==T.V.PREV&&this.backPage(this.activePage)}clickBtn(e){this[e]()}saveTemp(e){let i=this.formData[this.activePage];"view"!=this.viewType?"form"==i.pageType&&this.tempData[i.tableName+i.id]&&this.tempData[i.tableName+i.id].refId?this.updateDataAPI(i,e,this.tempData[i.tableName+i.id].refId):this.saveDataAPI(i,e):"table"==i.pageType?(this.tempData[i.tableName+i.id]?this.tempData[i.tableName+i.id].push(e):this.tempData[i.tableName+i.id]=[e],this.globalFun.tempFormData=this.tempData,this.cdRef.detectChanges()):(this.tempData[i.tableName+i.id]=e,this.globalFun.tempFormData=this.tempData,this.dynForm.newFormCreate(this.formData[this.activePage+1].controls,this.tempData[this.formData[this.activePage+1].tableName+this.formData[this.activePage+1].id]),this.activePage+=1,"table"==this.formData[this.activePage].pageType&&this.reFormatTable(this.formData[this.activePage].controls),this.cdRef.detectChanges())}download(e,i){let n=this.getOtherData(e,i);if(n){let a=n.split("].")[0].replace("[","");this.downloadService.getDownload(a,n)}}reFormatTable(e){this.tableReform=[];let i=[],n=JSON.parse(JSON.stringify(e));for(let a of n){let r=!1;if(a.options=a.options?a.options:[],!a.isHideView)if(a.tableTitle&&(i.findIndex(d=>d==a.tableTitle)<0?i.push(a.tableTitle):r=!0),r){let s=this.tableReform.findIndex(d=>d.parent==a.dependency.parentName);s>=0&&this.tableReform[s].cols.push({name:"true"==a.master?a.name+"Value":a.name,type:a.input,subType:a.type,options:("false"==a.master||0==a.master)&&a.options.length>0?a.options:[]})}else this.tableReform.push({title:a.tableTitle||a.label||a.name,cols:[{name:"true"==a.master?a.name+"Value":a.name,type:a.input,subType:a.type,options:("false"==a.master||0==a.master)&&a.options.length>0?a.options:[]}],type:a.input,subType:a.type,parent:a.dependency?a.dependency.parentName:"",options:("false"==a.master||0==a.master)&&a.options.length>0?a.options:[]})}this.cdRef.detectChanges()}getOtherData(e,i){for(let n of e)if(i[n.name]&&(i[n.name]+"").length>0){if("input"==n.type&&"currency"==n.subType)return this.numberPipe.transform(i[n.name]);if("date"==n.type)return this.datePipe.transform(i[n.name],"dd/MM/yyyy");if(n.options.length>0){let r=n.options.find(s=>s.value==i[n.name]);if(r)return r.text}return i[n.name]}}updateDataAPI(e,i,n,a=-1){this.premiumAmt=this.premiumAmt?this.premiumAmt:"0";let r={productId:this.prodService.createingProd.id,type:this.viewType,tableName:e.tableName,resourceId:this.resourceId,refId:n,customerId:this.creatingCustomer.customerId,quotationId:this.referenceID,agentId:this.auth.currentUserValue.id||1,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,policyNumber:null,pageId:e.id,leadId:this.creatingLeadId||null,party:e.party||!1,data:[]};for(const[s,d]of Object.entries(i)){let u=e.controls.find(h=>h.name==s),m=d;u&&(m="input"==u.input&&"number"==u.type?Number(d):d,Array.isArray(m)&&(m=m.join("#-#"),m.includes("#-#")||(m+="#+#"))),r.data.push({column:s,value:m,party:u&&u.party||!1})}this.pageDataService.updateNoID(r).pipe((0,B.w)(s=>"table"==e.pageType?this.checkMasterValue(i,e.controls,s):(0,b.of)(s))).toPromise().then(s=>{s&&(this.updateDataStatus(),a<0?(this.tempData[e.tableName+e.id]=Object.assign(Object.assign({},i),{refId:s.refId}),"policyholder_1641795142279"==e.unitCode&&(this.tempData.policyholder_1641795142279=Object.assign(Object.assign({},i),{refId:s.refId})),this.pageOrder.length>this.activePage+1?(this.dynForm.newFormCreate(this.formData[this.activePage+1].controls,this.tempData[this.formData[this.activePage+1].tableName+this.formData[this.activePage+1].id]),this.globalFun.tempFormData=this.tempData,this.activePage+=1,this.cdRef.detectChanges(),"table"==this.formData[this.activePage].pageType&&this.reFormatTable(this.formData[this.activePage].controls)):(this.globalFun.tempFormData=this.tempData,this.goReusltPage())):(i=s.formData,this.tempData[e.tableName+e.id][a]=Object.assign(Object.assign({},i),{refId:s.refId}),this.globalFun.tempFormData=this.tempData,this.cdRef.detectChanges()))})}goReusltPage(){this.prodService.previewType=this.type,this.premiumAmt=this.premiumAmt?this.premiumAmt:"0",this.prodService.editData={id:this.resourceId,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,agentFirstName:this.auth.currentUserValue.firstName,agentLastName:this.auth.currentUserValue.lastName,leadId:this.creatingLeadId},this.router.navigateByUrl("/resourse-detail")}saveDataAPI(e,i){this.premiumAmt=this.premiumAmt?this.premiumAmt:"0";let n={productId:this.prodService.createingProd.id,type:this.viewType,tableName:e.tableName,resourceId:this.resourceId,agentId:this.auth.currentUserValue.id||1,quotationId:this.referenceID,pageId:e.id,customerId:this.creatingCustomer.customerId,leadId:this.creatingLeadId||null,premium:(Number(this.premiumAmt.split(" ")[0].split(",").join(""))||0)+"",premiumView:this.premiumAmt,policyNumber:null,party:e.party||!1,pageData:[{data:[]}]};for(const[a,r]of Object.entries(i)){let s=e.controls.find(u=>u.name==a),d=r;s&&(d="input"==s.input&&"number"==s.type?Number(r):r,Array.isArray(d)&&(d=d.join("#-#"),d.includes("#-#")||(d+="#+#"))),n.pageData[0].data.push({column:a,value:d,party:s&&s.party||!1})}this.pageDataService.save(n).pipe((0,B.w)(a=>"table"==e.pageType?this.checkMasterValue(i,e.controls,a):(0,b.of)(a))).toPromise().then(a=>{a&&(this.updateDataStatus(),this.resourceId||(this.resourceId=a[0].resourceId),"table"==e.pageType?(i=a[0].formData,this.tempData[e.tableName+e.id]?this.tempData[e.tableName+e.id].push(Object.assign(Object.assign({},i),{refId:a[0].refId,pageId:e.id})):this.tempData[e.tableName+e.id]=[Object.assign(Object.assign({},i),{refId:a[0].refId})],this.globalFun.tempFormData=this.tempData,this.cdRef.detectChanges()):(this.tempData[e.tableName+e.id]=Object.assign(Object.assign({},i),{refId:a[0].refId,pageId:e.id}),"policyholder_1641795142279"==e.unitCode&&(this.tempData.policyholder_1641795142279=Object.assign(Object.assign({},i),{refId:a[0].refId,pageId:e.id})),this.pageOrder.length>this.activePage+1?(this.formData[this.activePage+1].controls&&this.dynForm.newFormCreate(this.formData[this.activePage+1].controls,this.tempData[this.formData[this.activePage+1].tableName+this.formData[this.activePage+1].id]),this.globalFun.tempFormData=this.tempData,this.activePage+=1,this.cdRef.detectChanges(),"table"==this.formData[this.activePage].pageType&&this.reFormatTable(this.formData[this.activePage].controls)):(this.globalFun.tempFormData=this.tempData,this.goReusltPage())))})}newData(e,i){const n=this.formData[this.activePage],a=this.modalService.open(Y,{size:"xl"});a.componentInstance.controls=n.controls,a.componentInstance.pageName=n.pageTitle,a.componentInstance.activateForm=n,a.componentInstance.oldData=i>=0?e:{},a.result.then(()=>{},r=>{r&&r.data&&"save"==r.type&&(i>=0?this.updateDataAPI(n,r.data,this.tempData[n.tableName+n.id][i].refId,i):this.saveTemp(r.data))})}create(){return(0,v.mG)(this,void 0,void 0,function*(){let e=this.formData[this.activePage];if(e.function&&!(yield this.globalFun[e.function]("",this.dynForm.form.getRawValue(),[],!0))||!this.dynForm.handleSubmit())return!1;this.dynForm.reCreateFrom()})}backPage(e){this.activePage>0?(this.activePage-=1,this.cdRef.detectChanges(),this.formData[this.activePage].type==I.it.STATIC&&this.formData[this.activePage+1].type==I.it.STATIC?this.staticPage.reCreate():this.formData[this.activePage].type==I.it.DYN&&"table"==this.formData[this.activePage].pageType&&this.reFormatTable(this.formData[this.activePage].controls)):this.location.back()}nextPage(e,i){return(0,v.mG)(this,void 0,void 0,function*(){let n=this.formData[this.activePage];if("table"==n.pageType){if(!this.tempData[n.tableName+n.id])return!1;if(0==this.tempData[n.tableName+n.id].length)return!1}this.pageOrder.length>e+1?(this.updateDataStatus(),this.activePage+=1,this.cdRef.detectChanges(),this.formData[this.activePage].type==I.it.STATIC&&this.formData[this.activePage-1].type==I.it.STATIC?this.staticPage.reCreate():this.formData[this.activePage].type==I.it.DYN&&"table"==this.formData[this.activePage].pageType&&this.reFormatTable(this.formData[this.activePage].controls)):this.goReusltPage()})}next(){return(0,v.mG)(this,void 0,void 0,function*(){let e=this.formData[this.activePage];if(e.function&&!(yield this.globalFun[e.function]("",this.dynForm.form.getRawValue(),[],!0))||!this.dynForm.handleSubmit())return!1})}getGlobalFun(e,i,n,a){if(this.globalFun[e+"Result"]){let r=this.globalFun[e+"Result"].subscribe(s=>{this[i][n][a]=s,this.cdRef.detectChanges()});this.unsubscribe.push(r)}else e&&(this[i][n][a]=e)}previous(){this.activePage>0?(this.dynForm.newFormCreate(this.formData[this.activePage-1].controls,this.tempData[this.formData[this.activePage-1].tableName+this.formData[this.activePage-1].id]),this.activePage-=1,this.cdRef.detectChanges()):this.ngZone.run(()=>{this.location.back()})}submit(){this.next()}reset(){this.dynForm.reCreateFrom(),this.cdRef.detectChanges()}deleteData(e,i){this.alert.activate("Are you sure want to delete?","Warning Message").then(n=>{if(n){let a=this.formData[this.activePage];this.pageDataService.deleteData(a.tableName,i.refId,a.id).toPromise().then(r=>{r&&(this.tempData[a.tableName+a.id].splice(e,1),this.cdRef.detectChanges(),this.alert.activate("This record was deleted","Success Message").then(s=>{}))})}})}getOldData(e,i,n){let a=0;this.pageOrder.forEach(r=>{if(a+=1,r.type==I.it.DYN){let s=this.findPageValue(i,r.id),d="table"==s.pageType;this.pageDataService.getDetail(s.tableName,e.id,s.id,d,s.controls,!0).toPromise().then(u=>(0,v.mG)(this,void 0,void 0,function*(){if(u&&u.length>0){let m="form"==s.pageType?{}:[],h=n;0==u.length&&"policy"==this.type&&e.quotationId&&(u=yield this.pageDataService.getDetail(s.tableName,e.quotationId,s.id,d,s.controls,!0).toPromise(),h=!0);for(const D of u){let z={};for(const F of D.data)"id"==F.column&&!h&&(z.refId=F.value),z[F.column]=(F.value+"").includes("#-#")?(F.value+"").split("#-#"):(F.value+"").includes("#+#")?[F.value.replace("#+#","")]:F.value;Array.isArray(m)?m.push(z):m=z}"policyholder_1641795142279"==s.unitCode&&(m.customer_id=this.creatingCustomer.customerId,this.tempData.policyholder_1641795142279=m),this.tempData[s.tableName+s.id]=m,this.globalFun.tempFormData=this.tempData,s.function&&"form"==s.pageType&&this.globalFun[s.function]("",this.tempData[s.tableName+s.id]),r.id==this.formData[this.activePage].id&&"form"==this.formData[this.activePage].pageType&&this.formData[this.activePage].type!=I.it.STATIC&&(this.cdRef.detectChanges(),this.dynForm.reCreateFrom(),this.cdRef.detectChanges())}else"policyholder_1641795142279"==s.unitCode&&this.mapPartyCustomer(s)})).catch(u=>{"policyholder_1641795142279"==s.unitCode&&this.mapPartyCustomer(s)})}})}mapPartyCustomer(e){let i={},n=e.controls.find(a=>"customer_id"==a.name);if(n){for(let a of n.autoFields)i[a.value]=this.creatingCustomer[a.field];this.tempData[e.tableName+e.id]=i,this.tempData[e.tableName+e.id].customer_id=this.creatingCustomer.customerId,this.globalFun.tempFormData=this.tempData,this.cdRef.detectChanges(),e.type==I.it.DYN&&this.dynForm&&(this.dynForm.reCreateFrom(),this.cdRef.detectChanges())}}checkDep(e,i){return(0,Ft.J)(e,{value:i})}checkMasterValue(e,i,n){Array.isArray(n)?n[0].formData=e:n.formData=e;let a=Object.keys(e).filter(r=>(e[r]+"").includes("T-"));if(a.length>0){let s={codeBookRequest:a.map(u=>{let m=i.find(h=>h.name==u);if(m.masterData)return{codeId:e[u],codeType:m.masterData,langCd:"EN"}})},d=e;return this.masterServer.getMasterValue(s).pipe((0,R.U)(u=>(a.forEach(m=>{let h=i.find(D=>D.name==m),f=u.findIndex(D=>D.codeId==d[m]&&h.masterData==D.codeType);f>=0&&(d[m+"Value"]=u[f].codeName)}),Array.isArray(n)?n[0].formData=d:n.formData=d,n)))}return(0,b.of)(n)}updateDataStatus(){this.referenceID&&"in_progress"==this.referenceStatus&&this.pageDataService.updatePremimun({resourceId:this.referenceID,type:"quotation",status:"complete"}).toPromise().then(i=>{i&&(this.referenceStatus="complete",this.prodService.referenceStatus="complete")})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(x.F0),t.Y36(_.Ye),t.Y36(t.sBO),t.Y36(g.FF),t.Y36(M.f),t.Y36(A.Q),t.Y36(U.e8),t.Y36(j.Q),t.Y36(L.D),t.Y36(W.a),t.Y36(w.c),t.Y36(bn.Ys),t.Y36(et.D),t.Y36(_.JJ),t.Y36(_.uU),t.Y36(t.R0b))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-product-form"]],viewQuery:function(e,i){if(1&e&&(t.Gf(P.r,5),t.Gf(wt,5)),2&e){let n;t.iGM(n=t.CRH())&&(i.dynForm=n.first),t.iGM(n=t.CRH())&&(i.staticPage=n.first)}},decls:1,vars:1,consts:[["class","row",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"card","card-custom","gutter-b"],[1,"card-body"],[2,"display","flex"],[1,"top-box",2,"margin-left","0px"],[1,"top-box"],["class","card-body customer-card-body",4,"ngIf"],[1,"card-body","customer-card-body"],[4,"ngIf"],[1,"wizard","wizard-3"],[1,"kt-grid__item"],[1,"wizard-nav","border-bottom","mb-1","mb-lg-5"],[1,"wizard-steps","pt-8"],[4,"ngFor","ngForOf"],["href","javascript:;",1,"wizard-step",3,"click"],[1,"wizard-label",3,"ngClass"],[1,"wizard-title"],[1,"wizard-bar"],["id","kt_wizard_v1",1,"wizard","wizard-1"],[1,"wizard-nav","border-bottom"],["id","kt_wizard_v2",1,"wizard","wizard-2"],[1,"wizard-nav","border-right","pt-8"],[1,"wizard-steps"],[1,"wizard-body","py-8","px-8","py-lg-20","px-lg-10"],[1,"wizard-wrapper",3,"ngClass"],[1,"wizard-icon"],[1,"wizard-label"],[3,"config","editStage","tempData","submit"],["dynForm",""],[1,"form-group"],["type","button",1,"btn","btn-primary","mx-2",3,"click"],[1,"table-responsive","angular-bootstrap-table"],[1,"table","table-head-custom","table-vertical-center"],[2,"white-space","nowrap"],["title","Edit Data",1,"btn","btn-icon","btn-light","btn-hover-danger","btn-sm","mx-1",3,"click"],[1,"svg-icon","svg-icon-md","svg-icon-primary",3,"inlineSVG","cacheSVG"],["title","Delete Data",1,"btn","btn-icon","btn-light","btn-hover-danger","btn-sm",3,"click"],[1,"svg-icon","svg-icon-md","svg-icon-danger",3,"inlineSVG","cacheSVG"],["href","javascript:;",3,"click"],["app-button-box","",3,"config","index","editStage","class","eventE",4,"ngFor","ngForOf"],["app-button-box","",3,"config","index","editStage","eventE"],[1,"col-sm-6","mx-auto"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"],["staticPage","",3,"compId","product","editData","resourcesId","premiumAmt","eventOut"],[1,"pb-5"],[1,"mt-5"],[3,"tempData","config","editStage","submit"],["title","Delete UI",1,"btn","btn-icon","btn-light","btn-hover-danger","btn-sm",3,"click"],["staticPage","",3,"compId","product","editData","resourcesId","premiumAmt","travelForm","eventOut"]],template:function(e,i){1&e&&t.YNc(0,no,18,3,"div",0),2&e&&t.Q6J("ngIf",i.item)},directives:[_.O5,_.sg,_.mk,P.r,ut.d$,Tn.P,wt],styles:['.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:center}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]{margin-left:3.5rem;margin-right:3.5rem}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]{color:#3f4254;font-size:3.75rem}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%]{transition:fill .3s ease;fill:#3f4254}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%]{transition:fill .3s ease}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-title[_ngcontent-%COMP%]{color:#7e8299;font-size:1.1rem;font-weight:500;margin-top:.75rem}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-arrow[_ngcontent-%COMP%]{color:#7e8299;font-size:1.15rem}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-arrow.last[_ngcontent-%COMP%]{display:none}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=done][_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%], .wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]{color:#005f99}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=done][_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%], .wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%]{transition:fill .3s ease;fill:#005f99}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=done][_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%], .wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%]{transition:fill .3s ease}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=done][_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-title[_ngcontent-%COMP%], .wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-title[_ngcontent-%COMP%]{color:#005f99}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=done][_ngcontent-%COMP%]   .wizard-arrow[_ngcontent-%COMP%], .wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-arrow[_ngcontent-%COMP%]{color:#005f99}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=done][_ngcontent-%COMP%]   .wizard-arrow[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%], .wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-arrow[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%]{transition:fill .3s ease;fill:#005f99}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=done][_ngcontent-%COMP%]   .wizard-arrow[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%], .wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-arrow[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%]{transition:fill .3s ease}@media (min-width: 768px) and (max-width: 1199.98px){.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]{margin-left:1.5rem;margin-right:1.5rem}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]{font-size:3.75rem}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-title[_ngcontent-%COMP%]{margin-top:.75rem}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-arrow[_ngcontent-%COMP%]{font-size:1.1rem}}@media (max-width: 767.98px){.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]{flex-direction:column}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]{width:100%;flex-direction:row;justify-content:space-between;margin-bottom:.5rem;margin-top:.5rem}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]{flex-direction:row;display:flex;align-items:center;margin-left:0;margin-right:0}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]{font-size:1.5rem;margin-right:1.25rem}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-arrow[_ngcontent-%COMP%]{font-size:.9rem}.wizard.wizard-1[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-arrow.last[_ngcontent-%COMP%]{display:block}}.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]{display:flex;align-items:flex-end}.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;flex-grow:1;margin-right:1rem}.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]:last-child{margin-right:0}.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;color:#3f4254;padding:2rem .5rem}.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;margin-bottom:.5rem;flex-wrap:wrap}.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:2rem;margin-right:.5rem}.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-bar[_ngcontent-%COMP%]{height:4px;width:100%;background-color:#ebedf3;position:relative}.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-bar[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:0;left:0;height:4px;width:0;background-color:transparent;transition:color .15s ease,background-color .15s ease,border-color .15s ease,box-shadow .15s ease}.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]{color:#005f99}.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-bar[_ngcontent-%COMP%]:after{width:100%;background-color:#005f99}@media (max-width: 999.98px){.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]{flex:0 0 100%;position:relative;width:100%}.wizard.wizard-3[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]{justify-content:flex-start;flex:0 0 100%;padding:1rem 0}}.wizard.wizard-2[_ngcontent-%COMP%]{display:flex}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]{padding:0;flex:0 0 400px;width:400px;max-width:100%}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]{padding:.75rem 1.5rem;position:relative;border-radius:.5rem;transition:color .15s ease,background-color .15s ease,border-color .15s ease,box-shadow .15s ease}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-wrapper[_ngcontent-%COMP%]{display:flex}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]{font-size:2.5rem;margin-right:1.1rem;transition:color .15s ease,background-color .15s ease,border-color .15s ease,box-shadow .15s ease}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#3f4254}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]   .svg-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%]{transition:fill .3s ease;fill:#3f4254}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]   .svg-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%]{transition:fill .3s ease}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-title[_ngcontent-%COMP%]{color:#181c32;font-weight:500;font-size:1.1rem}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]   .wizard-desc[_ngcontent-%COMP%]{color:#7e8299}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-arrow[_ngcontent-%COMP%]{color:#7e8299;font-size:1.15rem}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[_ngcontent-%COMP%]   .wizard-arrow.last[_ngcontent-%COMP%]{display:none}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]{background-color:#f3f6f9;transition:color .15s ease,background-color .15s ease,border-color .15s ease,box-shadow .15s ease}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]{transition:color .15s ease,background-color .15s ease,border-color .15s ease,box-shadow .15s ease}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#005f99!important}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]   .svg-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%]{transition:fill .3s ease;fill:#005f99!important}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]   .svg-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:hover   g[_ngcontent-%COMP%]   [fill][_ngcontent-%COMP%]{transition:fill .3s ease}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]:after{left:100%;top:50%;transform:translateY(-50%);content:" ";height:0;width:0;border:solid transparent;position:absolute;border-left-color:#f3f6f9;border-width:1rem}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-body[_ngcontent-%COMP%]{width:100%}@media (min-width: 1000px) and (max-width: 1399.98px){.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]{flex:0 0 325px;width:325px}}@media (max-width: 999.98px){.wizard.wizard-2[_ngcontent-%COMP%]{display:block}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]{width:100%;border-bottom:1px solid #EBEDF3}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-nav[_ngcontent-%COMP%]   .wizard-steps[_ngcontent-%COMP%]   .wizard-step[data-wizard-state=current][_ngcontent-%COMP%]:after{content:none}.wizard.wizard-2[_ngcontent-%COMP%]   .wizard-body[_ngcontent-%COMP%]{width:100%}}.active[_ngcontent-%COMP%]   .wizard-title[_ngcontent-%COMP%], .wizard-label.active[_ngcontent-%COMP%], .done[_ngcontent-%COMP%]   .wizard-title[_ngcontent-%COMP%], .done[_ngcontent-%COMP%]{color:#3699ff!important}.active[_ngcontent-%COMP%]   .wizard-title[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%], .wizard-label.active[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%], .done[_ngcontent-%COMP%]   .wizard-title[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%], .done[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%]{color:#3699ff!important}.wizard-title[_ngcontent-%COMP%], .wizard-label[_ngcontent-%COMP%]{max-width:145px}.wizard-steps[_ngcontent-%COMP%]{align-items:flex-start!important}.wizard-wrapper.active[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%], .wizard-wrapper.active[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%], .wizard-wrapper.done[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%], .wizard-wrapper.done[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]{color:#3699ff!important}.wizard-wrapper[_ngcontent-%COMP%]   .wizard-icon[_ngcontent-%COMP%], .wizard-wrapper[_ngcontent-%COMP%]   .wizard-label[_ngcontent-%COMP%]{color:#3f4254}.wizard-step[_ngcontent-%COMP%] > .wizard-label[_ngcontent-%COMP%]{margin-left:1rem!important;margin-right:1rem!important}.wizard-step[_ngcontent-%COMP%]{align-items:flex-start!important}.wizard-icon[_ngcontent-%COMP%]{font-size:2rem!important}.active[_ngcontent-%COMP%]   .wizard-bar[_ngcontent-%COMP%], .done[_ngcontent-%COMP%]   .wizard-bar[_ngcontent-%COMP%]{background-color:#3699ff!important}.top-box[_ngcontent-%COMP%]{color:#b5b5c3;margin-left:50px}.top-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#000}']}),o})();var ao=p(70933),ro=p(59472);let so=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[_.uU,_.JJ],imports:[[_.ez,ut.vi,l.u5,l.UX,g.bz,ao.Q,ro.Q,x.Bz.forChild([{path:"",component:oo}])]]}),o})()},43329:(V,y,p)=>{p.d(y,{D:()=>P});var _=p(18260),x=p(91691),v=p(83668),b=p(44522);const Z=`${_.N.apiUrl}/quotationAddon`;let P=(()=>{class t extends x.i{constructor(g){super(g,Z),this.httpClient=g}getOne(g,A,Y){return this.httpClient.get(Z+"/"+g+"/"+A+"/"+Y)}deleteAll(g,A){return this.httpClient.delete(Z+"/quotation/"+g+"/"+A)}getAllById(g){return this.httpClient.post(Z+"s",g)}}return t.\u0275fac=function(g){return new(g||t)(v.LFG(b.eN))},t.\u0275prov=v.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},45570:(V,y,p)=>{p.d(y,{a:()=>P});var _=p(18260),x=p(91691),v=p(83668),b=p(44522);const Z=`${_.N.apiUrl}/quotationCoverage`;let P=(()=>{class t extends x.i{constructor(g){super(g,Z),this.httpClient=g}getOne(g,A,Y){return this.httpClient.get(Z+"/"+g+"/"+A+"/"+Y)}deleteAll(g,A){return this.httpClient.delete(Z+"/quotation/"+g+"/"+A)}getAllById(g){return this.httpClient.post(Z+"s",g)}}return t.\u0275fac=function(g){return new(g||t)(v.LFG(b.eN))},t.\u0275prov=v.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},61438:(V,y,p)=>{p.d(y,{F:()=>P});var _=p(18260),x=p(91691),v=p(83668),b=p(44522);const Z=`${_.N.apiUrl}/endowment`;let P=(()=>{class t extends x.i{constructor(g){super(g,Z),this.httpClient=g}deleteMany(g){return this.httpClient.delete(Z+"/resource/"+g)}getMany(g){return this.httpClient.get(Z+"/resource/"+g)}saveMany(g){return this.httpClient.post(Z+"s",g)}}return t.\u0275fac=function(g){return new(g||t)(v.LFG(b.eN))},t.\u0275prov=v.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},66977:(V,y,p)=>{p.d(y,{U:()=>P});var _=p(18260),x=p(91691),v=p(83668),b=p(44522);const Z=`${_.N.apiUrl}/fire-policy/risk`;let P=(()=>{class t extends x.i{constructor(g){super(g,Z),this.httpClient=g}deleteMany(g){return this.httpClient.delete(Z+"/resource/"+g)}getMany(g){return this.httpClient.get(Z+"/resource/"+g)}getStock(g){return this.httpClient.get(Z+"/"+g+"/stock")}getPlant(g){return this.httpClient.get(Z+"/"+g+"/plant-machinery")}getContent(g){return this.httpClient.get(Z+"/"+g+"/content")}}return t.\u0275fac=function(g){return new(g||t)(v.LFG(b.eN))},t.\u0275prov=v.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},75103:(V,y,p)=>{p.d(y,{V:()=>P});var _=p(18260),x=p(91691),v=p(83668),b=p(44522);const Z=`${_.N.apiUrl}/fire-policy`;let P=(()=>{class t extends x.i{constructor(g){super(g,Z),this.httpClient=g}getOne(g){return console.log(g,"data"),this.httpClient.get(Z+"/resource?resourceId="+g)}}return t.\u0275fac=function(g){return new(g||t)(v.LFG(b.eN))},t.\u0275prov=v.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},93931:(V,y,p)=>{p.d(y,{q:()=>P});var _=p(18260),x=p(91691),v=p(83668),b=p(44522);const Z=`${_.N.apiUrl}/health/payment-schedule`;let P=(()=>{class t extends x.i{constructor(g){super(g,Z),this.httpClient=g}deleteMany(g){return this.httpClient.delete(Z+"/resource/"+g)}getMany(g){return this.httpClient.get(Z+"/resource/"+g)}saveAll(g){return this.httpClient.post(Z+"s",g)}}return t.\u0275fac=function(g){return new(g||t)(v.LFG(b.eN))},t.\u0275prov=v.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},75291:(V,y,p)=>{p.d(y,{e:()=>P});var _=p(18260),x=p(91691),v=p(83668),b=p(44522);const Z=`${_.N.apiUrl}/health/product-detail`;let P=(()=>{class t extends x.i{constructor(g){super(g,Z),this.httpClient=g}getOne(g){return this.httpClient.get(Z+"/resource/"+g)}}return t.\u0275fac=function(g){return new(g||t)(v.LFG(b.eN))},t.\u0275prov=v.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);