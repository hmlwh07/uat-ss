"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6747],{27738:(C,l,i)=>{i.d(l,{v:()=>h});var r=i(18260),s=i(91691),u=i(83668),p=i(44522);const v=`${r.N.apiUrl}/customer`;let h=(()=>{class c extends s.i{constructor(m){super(m,v),this.httpClient=m}}return c.\u0275fac=function(m){return new(m||c)(u.LFG(p.eN))},c.\u0275prov=u.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},17318:(C,l,i)=>{i.d(l,{J:()=>s,L:()=>u});var r=i(18510);const s=[{title:"Quotation ID",type:r.Y.FEILD,field:"id"},{title:"Product Name",type:r.Y.FEILD,field:"productName"},{title:"Product Code",type:r.Y.FEILD,field:"productCode"},{title:"Agent Name",type:r.Y.FEILD,field:"agentFirstName"},{title:"Premium",type:r.Y.FEILD,field:"premium",amtFormat:!0},{title:"Status",type:r.Y.FEILD,field:"status",isStatus:!0},{title:"Date",type:r.Y.FEILD,field:"createdAt",isDate:!0},{title:"Application",type:r.Y.TEXT,field:"create application",isDate:!0},{title:"Actions",type:r.Y.ACTION,field:"actions",btn:{view:!0,edit:!0}}],u=["id","productName","productCode","agentFirstName","premium","status","createdAt","create application","actions"]},6747:(C,l,i)=>{i.r(l),i.d(l,{QuotationsModule:()=>J});var r=i(86019),s=i(49133),u=i(92070),p=i(28100),v=i(82997),h=i(72835),c=i(37632),f=i(90949),m=i(11918),D=i(9939),T=i(17318),t=i(83668),Z=i(85993),A=i(35618),g=i(4205),L=i(80842),I=i(27738),O=i(15470),E=i(85472),M=i(15346);const S=function(a){return{activated:a}};let P=(()=>{class a{constructor(e,o,n,y,R,U,B){this.modalService=e,this.prodctService=o,this.router=n,this.quoService=y,this.cdRef=R,this.customerService=U,this.menuService=B,this.quoList=[],this.quoAccess=c.w,this.policyAccess=c.w,this.isTeam=!1,this.ELEMENT_COL=JSON.parse(JSON.stringify(T.J)),this.displayedColumns=JSON.parse(JSON.stringify(T.L)),this.loadForm()}ngOnInit(){this.checkPremission(),this.getQuoList()}loadForm(){let e=new Date,o=new Date(e.setMonth(e.getMonth()-1)),n=new Date(e.setMonth(e.getMonth()+1));this.quotationForm=new s.cw({startDate:new s.NI(o),endDate:new s.NI(n),isTeam:new s.NI(this.isTeam)})}checkPremission(){this.menuService.dataAccess.subscribe(e=>{e&&(this.quoAccess=e.quotation,this.policyAccess=e.application,this.quoAccess.edit||(this.ELEMENT_COL[8].btn.edit=!1),this.policyAccess.create||(this.ELEMENT_COL.splice(7,1),this.displayedColumns.splice(7,1)))})}ngOnDestroy(){}cancel(){}changeView(e){this.isTeam="team"==e,this.quotationForm.controls.isTeam.setValue(this.isTeam),this.cdRef.detectChanges(),this.getQuoList()}createOrEdit(){const e=this.modalService.open(D.P,{size:"xl",backdrop:!1});e.componentInstance.type="modal",e.result.then(()=>{},o=>{o&&"save"==o.type&&this.chooseCustomer(o)})}chooseCustomer(e){const o=this.modalService.open(m.b,{size:"xl",backdrop:!1});o.componentInstance.isPopup=!0,o.result.then(()=>{},n=>{n&&"save"==n.type&&(this.prodctService.createingProd=e.data,this.prodctService.creatingCustomer=n.data,this.prodctService.viewType="quotation",this.prodctService.editData=null,this.prodctService.referenceID=null,this.prodctService.type="quotation",this.router.navigateByUrl("/product-form"))})}getQuoList(){this.quoService.getQuoList(this.quotationForm.getRawValue()).toPromise().then(e=>{e&&(this.quoList=e,this.cdRef.detectChanges(),this.matTable.reChangeData())})}editLayout(e){(0,p.D)([this.prodctService.findOne(e.productId),this.customerService.findOne(e.customerId||1).pipe((0,h.K)(o=>(0,v.of)(void 0)))]).toPromise().then(o=>{o&&(this.prodctService.createingProd=o[0],this.prodctService.creatingCustomer=o[1],this.prodctService.type="quotation",this.prodctService.viewType="quotation",this.prodctService.editData=e,this.prodctService.referenceID=null,this.prodctService.creatingLeadId=e.leadId,this.router.navigateByUrl("/product-form"))})}FormatedDate(e){return u(e,"YYYYMMDD").format("MM/DD/YYYY")}actionBtn(e){"view"==e.cmd?this.goViewDetail(e.data):"edit"==e.cmd?this.editLayout(e.data):"create"==e.cmd&&this.createPolicy(e.data)}goViewDetail(e){this.prodctService.findOne(e.productId).toPromise().then(o=>{o&&(this.prodctService.createingProd=o,this.prodctService.editData=e,this.prodctService.previewType="quotation",this.router.navigateByUrl("/resourse-detail"))})}createPolicy(e){(0,p.D)([this.prodctService.findOne(e.productId),this.customerService.findOne(e.customerId||1).pipe((0,h.K)(o=>(0,v.of)(void 0)))]).toPromise().then(o=>{o&&(this.prodctService.createingProdRef=o[0],this.prodctService.creatingCustomer=o[1],this.prodctService.viewType="policy",this.prodctService.type="policy",this.prodctService.referenceID=e.id,this.prodctService.editData=null,this.prodctService.creatingLeadId=e.leadId,this.router.navigateByUrl("/product-form"))})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.FF),t.Y36(A.f),t.Y36(g.F0),t.Y36(L.G),t.Y36(t.sBO),t.Y36(I.v),t.Y36(c.q))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-quotations"]],viewQuery:function(e,o){if(1&e&&t.Gf(f.I,5),2&e){let n;t.iGM(n=t.CRH())&&(o.matTable=n.first)}},decls:30,vars:24,consts:[[1,"row"],[1,"col-12","text-right","pb-5"],[1,"btn","btn-light-dark","new-btn-dark-gray","mr-2","btn-round",3,"ngClass","click"],[1,"btn","btn-light-dark","new-btn-dark-gray","btn-round",3,"ngClass","click"],[1,"col-12"],[1,"card","card-custom","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label","left-border-image"],[1,"card-toolbar"],[1,"flaticon2-magnifier-tool","search-tool",3,"click"],["type","button",1,"btn","btn-primary","ml-2",2,"min-width","50px",3,"click"],[1,""],[1,"card-body","px-10","py-3"],["action","#",1,"form",3,"formGroup"],[1,"row",2,"align-items","center"],["remove-host","",3,"formInput","colClass"],[1,"card-body","customer-card-body"],[3,"data","colum","displayedColumns","emitter"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"button",2),t.NdJ("click",function(){return o.changeView("myview")}),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",3),t.NdJ("click",function(){return o.changeView("team")}),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.qZA(),t.TgZ(8,"div",4),t.TgZ(9,"div",5),t.TgZ(10,"div",6),t.TgZ(11,"div",7),t.TgZ(12,"h3",8),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.qZA(),t.TgZ(15,"div",9),t.TgZ(16,"span",10),t.NdJ("click",function(){return o.getQuoList()}),t.qZA(),t.TgZ(17,"button",11),t.NdJ("click",function(){return o.cancel()}),t.TgZ(18,"span",12),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(21,"div",13),t.TgZ(22,"form",14),t.TgZ(23,"div",15),t._UZ(24,"app-start-end-date",16),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"div",0),t.TgZ(26,"div",4),t.TgZ(27,"div",5),t.TgZ(28,"div",17),t.TgZ(29,"app-material-table-view",18),t.NdJ("emitter",function(y){return o.actionBtn(y)}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngClass",t.VKq(20,S,!o.isTeam)),t.xp6(1),t.Oqu(t.lcZ(4,12,"FORM.my_view")),t.xp6(2),t.Q6J("ngClass",t.VKq(22,S,o.isTeam)),t.xp6(1),t.Oqu(t.lcZ(7,14,"FORM.team_veiw")),t.xp6(7),t.Oqu(t.lcZ(14,16,"FORM.quotation_list")),t.xp6(6),t.Oqu(t.lcZ(20,18,"FORM.btn_cancel")),t.xp6(3),t.Q6J("formGroup",o.quotationForm),t.xp6(2),t.Q6J("formInput",o.quotationForm)("colClass","col-md-6"),t.xp6(5),t.Q6J("data",o.quoList)("colum",o.ELEMENT_COL)("displayedColumns",o.displayedColumns))},directives:[r.mk,s._Y,s.JL,s.sg,O.Q,E.Z,f.I],pipes:[M.X],styles:[".activated[_ngcontent-%COMP%]{background-color:#ff8100!important;color:#fff!important}"]}),a})(),Q=(()=>{class a{ngOnInit(){}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-quotation-page"]],decls:1,vars:0,template:function(e,o){1&e&&t._UZ(0,"router-outlet")},directives:[g.lC],encapsulation:2}),a})();var F=i(87626),Y=i(96152),N=i(45598),q=i(90860),b=i(63699);let J=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[r.ez,F.vi,s.u5,s.UX,Z.bz,N.fA,b.j,g.Bz.forChild([{path:"quotation",component:Q,children:[{path:"list",component:P}]}]),Y.ProductsModule,q.m]]}),a})()}}]);