"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7464,8757],{6517:(C,v,i)=>{i.d(v,{t7:()=>T});var d=i(5e3),u=i(19775),A=i(15439);const m=i.n(A)()||A,M=new d.OlP("MAT_MOMENT_DATE_ADAPTER_OPTIONS",{providedIn:"root",factory:function e(){return{useUtc:!1}}});function D(l,f){const a=Array(l);for(let r=0;r<l;r++)a[r]=f(r);return a}let T=(()=>{class l extends u._A{constructor(a,r){super(),this._options=r,this.setLocale(a||m.locale())}setLocale(a){super.setLocale(a);let r=m.localeData(a);this._localeData={firstDayOfWeek:r.firstDayOfWeek(),longMonths:r.months(),shortMonths:r.monthsShort(),dates:D(31,h=>this.createDate(2017,0,h+1).format("D")),longDaysOfWeek:r.weekdays(),shortDaysOfWeek:r.weekdaysShort(),narrowDaysOfWeek:r.weekdaysMin()}}getYear(a){return this.clone(a).year()}getMonth(a){return this.clone(a).month()}getDate(a){return this.clone(a).date()}getDayOfWeek(a){return this.clone(a).day()}getMonthNames(a){return"long"==a?this._localeData.longMonths:this._localeData.shortMonths}getDateNames(){return this._localeData.dates}getDayOfWeekNames(a){return"long"==a?this._localeData.longDaysOfWeek:"short"==a?this._localeData.shortDaysOfWeek:this._localeData.narrowDaysOfWeek}getYearName(a){return this.clone(a).format("YYYY")}getFirstDayOfWeek(){return this._localeData.firstDayOfWeek}getNumDaysInMonth(a){return this.clone(a).daysInMonth()}clone(a){return a.clone().locale(this.locale)}createDate(a,r,h){const g=this._createMoment({year:a,month:r,date:h}).locale(this.locale);return g.isValid(),g}today(){return this._createMoment().locale(this.locale)}parse(a,r){return a&&"string"==typeof a?this._createMoment(a,r,this.locale):a?this._createMoment(a).locale(this.locale):null}format(a,r){return a=this.clone(a),this.isValid(a),a.format(r)}addCalendarYears(a,r){return this.clone(a).add({years:r})}addCalendarMonths(a,r){return this.clone(a).add({months:r})}addCalendarDays(a,r){return this.clone(a).add({days:r})}toIso8601(a){return this.clone(a).format()}deserialize(a){let r;if(a instanceof Date)r=this._createMoment(a).locale(this.locale);else if(this.isDateInstance(a))return this.clone(a);if("string"==typeof a){if(!a)return null;r=this._createMoment(a,m.ISO_8601).locale(this.locale)}return r&&this.isValid(r)?this._createMoment(r).locale(this.locale):super.deserialize(a)}isDateInstance(a){return m.isMoment(a)}isValid(a){return this.clone(a).isValid()}invalid(){return m.invalid()}_createMoment(a,r,h){const{strict:g,useUtc:R}=this._options||{};return R?m.utc(a,r,h,g):m(a,r,h,g)}}return l.\u0275fac=function(a){return new(a||l)(d.LFG(u.Ad,8),d.LFG(M,8))},l.\u0275prov=d.Yz7({token:l,factory:l.\u0275fac}),l})()},88757:(C,v,i)=>{function d(m){try{JSON.parse(m)}catch(M){return!1}return!0}i.d(v,{Gs:()=>u,Ny:()=>y,cU:()=>d});const u={parse:{dateInput:"DD-MM-YYYY"},display:{dateInput:"DD-MM-YYYY",monthYearLabel:"MMMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}},y={parse:{dateInput:"MM-YYYY"},display:{dateInput:"MM-YYYY",monthYearLabel:"MM-YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MM-YYYY"}}},72873:(C,v,i)=>{i.r(v),i.d(v,{ReRerunJobPageModule:()=>V});var d=i(69808),u=i(93075),A=i(83950),y=i(96592),m=i(70655),M=i(93230),e=i(5e3),D=i(63272),T=i(98807);function b(n,c){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=c.$implicit;e.xp6(1),e.Oqu(t)}}function Y(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){return e.CHM(t),e.oxw().reRun()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"FORM.rerun_list")))}let _=(()=>{class n{constructor(t){this.ngModal=t}ngOnInit(){this.data.errorDescription=(this.data.logMsg+"").split(",")}closeModal(){this.ngModal.dismiss()}reRun(){this.ngModal.dismiss({type:"rerun"})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(D.Kz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-error-details"]],inputs:{data:"data"},decls:38,vars:17,consts:[[1,"modal-content"],[1,"modal-header"],["id","example-modal-sizes-title-lg",1,"modal-title","h4","left-border-image"],[1,"overlay","overlay-block","cursor-default","modal-body"],[1,"row",2,"align-items","center"],[1,"col-md-12"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8"],["type","text","name","name","autocomplete","off",1,"form-control","form-control-sm"],[1,"error-list"],[4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-2",3,"click"],["type","button","class","btn btn-primary btn-elevate mr-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-elevate","mr-2",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e.TgZ(8,"label",7),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div",8),e.TgZ(12,"div",9),e._uU(13),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",4),e.TgZ(15,"div",5),e.TgZ(16,"div",6),e.TgZ(17,"label",7),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"div",8),e.TgZ(21,"div",9),e._uU(22),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(23,"div",4),e.TgZ(24,"div",5),e.TgZ(25,"div",6),e.TgZ(26,"label",7),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"div",8),e.TgZ(30,"div",9),e.TgZ(31,"ul",10),e.YNc(32,b,2,1,"li",11),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(33,"div",12),e.TgZ(34,"button",13),e.NdJ("click",function(){return o.closeModal()}),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.YNc(37,Y,3,3,"button",14),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.hij(" ","CRM"==o.data.jobType?"Management Portal ":o.data.jobType," "),e.xp6(6),e.Oqu(e.lcZ(10,9,"FORM.job_type")),e.xp6(4),e.Oqu("CRM"==o.data.jobType?"Management Portal ":o.data.jobType),e.xp6(5),e.Oqu(e.lcZ(19,11,"FORM.job_name")),e.xp6(4),e.Oqu("RunTCSAPIByScheduler"==o.data.jobName?"Create / Update Party":o.data.jobName),e.xp6(5),e.Oqu(e.lcZ(28,13,"FORM.description")),e.xp6(5),e.Q6J("ngForOf",o.data.errorDescription),e.xp6(3),e.Oqu(e.lcZ(36,15,"FORM.btn_close")),e.xp6(2),e.Q6J("ngIf","FAIL"==o.data.status))},directives:[d.sg,d.O5],pipes:[T.X],styles:[".form-group.row[_ngcontent-%COMP%]{align-items:flex-start}.error-list[_ngcontent-%COMP%]{padding:5px}.form-control-sm[_ngcontent-%COMP%]{padding:.55rem .75rem;font-size:.925rem;line-height:1.8;border-radius:.28rem;background-color:#e4e6ef;height:auto}"]}),n})();var p=i(34436);const l=[{title:"Job Type",type:p.Y.FEILD,field:"jobType"},{title:"Job Name",type:p.Y.FEILD,field:"jobNameValue"},{title:"Date",type:p.Y.FEILD,field:"jobDateTime"},{title:"Status",type:p.Y.FEILD,field:"statusValue",isTitle:!0},{title:"Actions",type:p.Y.ACTION,field:"actions",btn:{view:!0,rerun:!0}}],f=["jobType","jobNameValue","jobDateTime","statusValue","actions"],a=[{title:"Job Type",type:p.Y.FEILD,field:"jobType"},{title:"Job Name",type:p.Y.FEILD,field:"jobName"},{title:"Date",type:p.Y.FEILD,field:"runDate",isFromatDate:!0},{title:"Status",type:p.Y.FEILD,field:"status",isTitle:!0},{title:"Actions",type:p.Y.ACTION,field:"actions",btn:{view:!0,rerun:!0}}],r=["jobType","jobName","runDate","status","actions"];var h=i(54004),g=i(15439),R=i(92340),L=i(40520);const E=`${R.N.apiUrl}/scheduler-log/search`,I=`${R.N.apiUrl}/scheduler/status/run`,S=`${R.N.apiUrl}/scheduler/renewal/run`,P=`${R.N.apiUrl}/scheduler/crm/customer/run`;let N=(()=>{class n{constructor(t){this.httpClient=t}getReRunListByType(t={}){let o=E,s={endDate:"",startDate:"",jobName:"",jobType:"",status:""};return t.startDate&&(s.startDate=g(t.startDate).format("YYYY-MM-DD")),t.endDate&&(s.endDate=g(t.endDate).format("YYYY-MM-DD")),t.name&&(s.jobName=t.name),t.typeCode&&(s.jobType=t.typeCode),t.status&&(s.status=t.status),this.httpClient.post(o,s)}reRunRenewal(){return this.httpClient.post(S,{})}reRunPolicyStatus(t){let o=g(t).format("YYYY-MM-DD");return this.httpClient.post(I+"?date="+o,{})}reRunCRM(t){let o=g(t).format("YYYY-MM-DD");return this.httpClient.post(P+"?date="+o,{})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(L.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var F=i(25492),J=i(32157),U=i(65435),O=i(64537);function q(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",26),e.TgZ(1,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().reRunRenewal()}),e.TgZ(2,"span",9),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.qZA(),e.qZA()}2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"CARD.renewalRerun")))}const j=[{path:"",component:(()=>{class n{constructor(t,o,s,Z){this.reRunService=t,this.modalService=o,this.cdf=s,this.alertService=Z,this.typeOption=[{code:"",value:"All"},{code:"CRM",value:"Management Portal"},{code:"SALE",value:"Sale Portal"}],this.nameOption=[{code:"",value:"All"},{code:"Create Update Party",value:"Create / Update Party"},{code:"Renewal Policy",value:"Renewal Policy"},{code:"Update Policy Status",value:"Update Policy Status"}],this.statusOption=[{code:"",value:"All"},{code:"FAIL",value:"Failed"},{code:"SUCCESS",value:"Success"}],this.listFromCRM=[],this.listFromSale=[],this.isCRM=!1,this.ELEMENT_COL=JSON.parse(JSON.stringify(l)),this.displayedColumns=JSON.parse(JSON.stringify(f)),this.ELEMENT_COL_SALE=JSON.parse(JSON.stringify(a)),this.displayedColumnsSale=JSON.parse(JSON.stringify(r))}ngOnInit(){this.loadForm()}ngAfterViewInit(){this.getList()}loadForm(){this.reRunForm=new u.cw({startDate:new u.NI(null),endDate:new u.NI(null),typeCode:new u.NI(""),name:new u.NI(""),status:new u.NI("")})}getList(){this.reRunService.getReRunListByType(this.reRunForm.value).pipe((0,h.U)(t=>t.map(o=>(o.statusValue="FAIL"==o.status?"FAILED":o.status,o.jobNameValue="RunTCSAPIByScheduler"==o.jobName?"Create / Update Party":o.jobName,o.jobDateTime=o.date&&o.time?o.date+"-"+o.time:o.runDate,o)))).toPromise().then(t=>{t&&(console.log("res",t),this.listFromCRM=t,this.cdf.detectChanges(),this.matTableCRM.reChangeData(),this.isCRM="CRM"==this.reRunForm.controls.typeCode.value)})}actionBtn(t){if(console.log(t),"view"==t.cmd&&this.viewErrorDetail(t.data),"rerun"==t.cmd){if("FAIL"!=t.data.status)return this.alertService.activate("This job was already successful!","Warning Message"),!1;this.alertService.activate("Are you sure want to re-run?","Warning Message").then(o=>(0,m.mG)(this,void 0,void 0,function*(){o&&("CRM"==t.data.jobType?this.reRunCRM(t.data):"Renewal Policy"==t.data.jobName?this.reRunRenewal():this.reRunPolicyStatus(t.data))}))}}reRunRenewal(){this.reRunService.reRunRenewal().toPromise().then(t=>{console.log(t),t&&(this.alertService.activate("This job was re-run successful","Success Message"),this.getList())})}reRunPolicyStatus(t){this.reRunService.reRunPolicyStatus(t.runDate).toPromise().then(o=>{o&&(this.alertService.activate("This job was re-run successful","Success Message"),this.getList())})}reRunCRM(t){this.reRunService.reRunCRM(t.runDate).toPromise().then(o=>{o&&(this.alertService.activate("This job was re-run successful","Success Message"),this.getList())})}viewErrorDetail(t){let o;o=this.modalService.open(_,{size:"lg",backdrop:!0,centered:!0,scrollable:!0}),o.componentInstance.data=t,o.result.then(()=>{},s=>{if(s){if("FAIL"!=t.status)return this.alertService.activate("This job was already successful!","Warning Message"),!1;this.alertService.activate("Are you sure want to re-run?","Warning Message").then(Z=>(0,m.mG)(this,void 0,void 0,function*(){Z&&("CRM"==t.jobType?this.reRunCRM(t):"Renewal Policy"==t.jobName?this.reRunRenewal():this.reRunPolicyStatus(t))}))}})}isControlValid(t){const o=this.reRunForm.controls[t];return o.valid&&(o.dirty||o.touched)}isControlInvalid(t){const o=this.reRunForm.controls[t];return o.invalid&&(o.dirty||o.touched)}controlHasError(t,o){const s=this.reRunForm.controls[o];return s.hasError(t)&&(s.dirty||s.touched)}isControlTouched(t){const o=this.reRunForm.controls[t];return o.dirty||o.touched}cancel(){this.reRunForm.reset(),this.getList()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(N),e.Y36(D.FF),e.Y36(e.sBO),e.Y36(F.c))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-re-rerun-job"]],viewQuery:function(t,o){if(1&t&&(e.Gf(M.I,5),e.Gf(M.I,5)),2&t){let s;e.iGM(s=e.CRH())&&(o.matTableCRM=s.first),e.iGM(s=e.CRH())&&(o.matTableSale=s.first)}},decls:47,vars:40,consts:[[1,"row"],[1,"col-12"],[1,"card","card-custom","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label","left-border-image"],[1,"card-toolbar"],[1,"flaticon2-magnifier-tool","search-tool",3,"click"],["type","button",1,"btn","btn-primary","ml-2",2,"min-width","50px",3,"click"],[1,""],[1,"card-body","px-10","py-3"],["action","#",1,"form",3,"formGroup"],[1,"row",2,"align-items","center"],["remove-host","",3,"formInput","colClass"],[1,"col-xl-4","col-sm-6"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8"],["bindLabel","value","bindValue","code","formControlName","typeCode",1,"ng-custom-select",3,"items","clearable"],["bindLabel","value","bindValue","code","formControlName","name",1,"ng-custom-select",3,"items","clearable"],["bindLabel","value","bindValue","code","formControlName","status",1,"ng-custom-select",3,"items","clearable"],[1,"card","card-custom","gutter-b","data"],[1,"card-body","customer-card-body"],["style","float:right ; margin-top:15px",4,"ngIf"],[3,"data","colum","displayedColumns","emitter"],["matTableCRM",""],[2,"float","right","margin-top","15px"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"h3",5),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.qZA(),e.TgZ(8,"div",6),e.TgZ(9,"span",7),e.NdJ("click",function(){return o.getList()}),e.qZA(),e.TgZ(10,"button",8),e.NdJ("click",function(){return o.cancel()}),e.TgZ(11,"span",9),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",10),e.TgZ(15,"form",11),e.TgZ(16,"div",12),e._UZ(17,"app-start-end-date",13),e.TgZ(18,"div",14),e.TgZ(19,"div",15),e.TgZ(20,"label",16),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"div",17),e._UZ(24,"ng-select",18),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(25,"div",12),e.TgZ(26,"div",14),e.TgZ(27,"div",15),e.TgZ(28,"label",16),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"div",17),e._UZ(32,"ng-select",19),e.qZA(),e.qZA(),e.qZA(),e.TgZ(33,"div",14),e.TgZ(34,"div",15),e.TgZ(35,"label",16),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"div",17),e._UZ(39,"ng-select",20),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(40,"div",0),e.TgZ(41,"div",1),e.TgZ(42,"div",21),e.TgZ(43,"div",22),e.YNc(44,q,5,3,"div",23),e.TgZ(45,"app-material-table-view",24,25),e.NdJ("emitter",function(Z){return o.actionBtn(Z)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(6),e.hij(" ",e.lcZ(7,30,"FORM.rerun_list"),""),e.xp6(6),e.Oqu(e.lcZ(13,32,"CARD.cancel")),e.xp6(3),e.Q6J("formGroup",o.reRunForm),e.xp6(2),e.Q6J("formInput",o.reRunForm)("colClass","col-xl-4 col-sm-6"),e.xp6(4),e.Oqu(e.lcZ(22,34,"FORM.type")),e.xp6(3),e.ekj("is-invalid",o.isControlInvalid("typeCode"))("is-valid",o.isControlValid("typeCode")),e.Q6J("items",o.typeOption)("clearable",!1),e.xp6(5),e.Oqu(e.lcZ(30,36,"FORM.name")),e.xp6(3),e.ekj("is-invalid",o.isControlInvalid("name"))("is-valid",o.isControlValid("name")),e.Q6J("items",o.nameOption)("clearable",!1),e.xp6(4),e.Oqu(e.lcZ(37,38,"FORM.status")),e.xp6(3),e.ekj("is-invalid",o.isControlInvalid("status"))("is-valid",o.isControlValid("status")),e.Q6J("items",o.statusOption)("clearable",!1),e.xp6(5),e.Q6J("ngIf",!o.isCRM&&o.listFromSale.length>0),e.xp6(1),e.Q6J("data",o.listFromCRM)("colum",o.ELEMENT_COL)("displayedColumns",o.displayedColumns))},directives:[u._Y,u.JL,u.sg,J.Q,U.Z,O.w9,u.JJ,u.u,d.O5,M.I],pipes:[T.X],styles:[""]}),n})()}];let w=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[y.Bz.forChild(j)],y.Bz]}),n})();var W=i(50282),k=i(7181);let V=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[],imports:[[d.ez,u.u5,A.Pc,u.UX,O.A0,W.fA,k.j,w]]}),n})()}}]);