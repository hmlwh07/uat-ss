"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6394],{55410:(J,b,s)=>{s.d(b,{Ys:()=>v,ou:()=>M,p3:()=>G});var l=s(70655),h=s(92340),T=s(38313),e=s(47423),Z=(()=>{return(n=Z||(Z={})).Documents="DOCUMENTS",n.Data="DATA",n.Library="LIBRARY",n.Cache="CACHE",n.External="EXTERNAL",n.ExternalStorage="EXTERNAL_STORAGE",Z;var n})();const _=(0,e.fo)("Filesystem",{web:()=>s.e(6364).then(s.bind(s,96364)).then(n=>new n.FilesystemWeb)}),I=(0,e.fo)("BlobWriter");function q(n){const m=new Uint8Array(n);let r="",c=0;for(;!(c>=m.byteLength);)r+=String.fromCharCode(m[c]),c+=1;return window.btoa(r)}function U(n,m,r){if(0===r.size)return Promise.resolve();const c=393216,u=r.slice(0,c);return new window.Response(u).arrayBuffer().then(function(g){return _.appendFile({directory:n,path:m,data:q(g)})}).then(function(){return U(n,m,r.slice(c))})}function N({path:n,directory:m,blob:r,recursive:c}){return _.writeFile({directory:m,path:n,recursive:c,data:""}).then(function({uri:u}){return U(m,n,r).then(function(){return u})})}const F=Object.freeze(function L(n){const{path:m,directory:r,blob:c,recursive:u,on_fallback:y}=n;return"ios"!==e.dV.platform&&"android"!==e.dV.platform?N(n):Promise.all([I.get_config(),_.getUri({path:m,directory:r})]).then(function([a,p]){const{base_url:t,auth_token:o}=a,i=p.uri.replace("file://","");return Promise.all([fetch(t+i+(u?"?recursive=true":""),{headers:{authorization:o},method:"put",body:c}),Promise.resolve(p)])}).then(function([g,a]){if(204!==g.status)throw new Error("Bad HTTP status: "+g.status);return a.uri}).catch(function(a){return void 0!==y&&y(a),N(n)})});var f=s(5e3),D=s(40520),w=s(94320),S=s(16164),x=s(43632),R=s(25492);const O=`${h.N.apiUrl}/attachment-uploader`;let G=(()=>{class n extends T.i{constructor(r){super(r,O),this.httpClient=r}}return n.\u0275fac=function(r){return new(r||n)(f.LFG(D.eN))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const P=`${h.N.apiUrl}/attachment-downloader`;let v=(()=>{class n extends T.i{constructor(r,c,u,y,g){super(r,P),this.httpClient=r,this.file=c,this.loadingService=u,this.toastService=y,this.alertService=g}getDownload(r,c){this.httpClient.get(P+"/"+r,{responseType:"blob"}).toPromise().then(u=>{u&&(e.dV.isNativePlatform()?this.mobileDownload(c,u):this.downloadFile(u,c))})}downloadFile(r,c){var u=document.createElement("a");u.href=URL.createObjectURL(r),u.download=c,u.click(),u.remove()}mobileDownload(r,c){return(0,l.mG)(this,void 0,void 0,function*(){try{yield _.mkdir({path:"kbzsale_downloads",directory:Z.Documents,recursive:!1}),this.createFile(r,c)}catch(u){this.createFile(r,c)}})}createFile(r,c){return(0,l.mG)(this,void 0,void 0,function*(){try{yield F({path:"kbzsale_downloads/"+r,directory:Z.Documents,blob:c}),yield this.loadingService.deactivate(),this.alertService.activate('"Download File',"Success Message")}catch(u){yield this.loadingService.deactivate(),this.alertService.activate('"Download Fail',"Error Message")}})}}return n.\u0275fac=function(r){return new(r||n)(f.LFG(D.eN),f.LFG(w.$),f.LFG(S.b),f.LFG(x.T),f.LFG(R.c))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const E=`${h.N.apiUrl}/attachment-ref`;let M=(()=>{class n extends T.i{constructor(r){super(r,E),this.httpClient=r}getAttachmentListRef(r,c){return this.httpClient.get(E+"?refDocNo="+r+"&refDocType="+c)}}return n.\u0275fac=function(r){return new(r||n)(f.LFG(D.eN))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},55213:(J,b,s)=>{function l(){const h=new FileReader;return h.__zone_symbol__originalInstance||h}s.d(b,{y:()=>l})},76394:(J,b,s)=>{s.d(b,{P:()=>g});var l=s(93075),h=s(92340),T=s(55213),e=s(5e3),Z=s(63272),k=s(78680),B=s(55410),Q=s(16164),_=s(25492),I=s(84095),q=s(69808),U=s(64537),N=s(98807);const L=["selectedFile1"],F=["selectedFile2"],f=["selectedFile3"];function D(a,p){1&a&&(e.TgZ(0,"div",5),e.TgZ(1,"div",36),e.TgZ(2,"div",7),e.TgZ(3,"label",8),e._uU(4,"Rule Days"),e.qZA(),e._UZ(5,"input",49),e.qZA(),e.qZA(),e.qZA())}function w(a,p){if(1&a&&e._UZ(0,"img",50),2&a){const t=e.oxw();e.Q6J("src",t.Default_DOWNLOAD_URL+"/"+t.formGroup.value.icon,e.LSH)}}function S(a,p){1&a&&(e.ynx(0),e._UZ(1,"i",51),e.TgZ(2,"label"),e._uU(3,"Icon"),e.qZA(),e.BQk())}function x(a,p){if(1&a&&e._UZ(0,"img",50),2&a){const t=e.oxw();e.Q6J("src",t.Default_DOWNLOAD_URL+"/"+t.formGroup.value.smallIcon,e.LSH)}}function R(a,p){1&a&&(e.ynx(0),e._UZ(1,"i",51),e.TgZ(2,"label"),e._uU(3,"Small Icon"),e.qZA(),e.BQk())}function O(a,p){if(1&a&&e._UZ(0,"img",50),2&a){const t=e.oxw();e.Q6J("src",t.Default_DOWNLOAD_URL+"/"+t.formGroup.value.coverIcon,e.LSH)}}function G(a,p){1&a&&(e.ynx(0),e._UZ(1,"i",51),e.TgZ(2,"label"),e._uU(3,"Cover Icon"),e.qZA(),e.BQk())}let P=(()=>{class a{constructor(t,o,i,d,C,Y,A){this.fb=t,this.modal=o,this.productService=i,this.fileUpload=d,this.loading=C,this.alertService=Y,this.cdf=A,this.prodId="",this.prodName="",this.lump=!1,this.annually=!1,this.subscriptions=[],this.oldData={},this.Default_DOWNLOAD_URL=`${h.N.apiUrl}/attachment-downloader`,this.statusCdOption=[{code:"01",value:"Draft"},{code:"02",value:"Active"}]}ngOnInit(){this.loadForm()}loadForm(){this.formGroup=this.fb.group({productName:[this.oldData.name||null,l.kI.compose([l.kI.required,l.kI.nullValidator])],productCode:[this.oldData.code||null,l.kI.compose([l.kI.required,l.kI.nullValidator])],coverName:[this.oldData.coverName||null,l.kI.compose([l.kI.required,l.kI.nullValidator])],type:[this.oldData.type||"GENERAL",l.kI.compose([l.kI.required,l.kI.nullValidator])],stamDuty:[this.oldData.stamDuty||!1,l.kI.compose([l.kI.required,l.kI.nullValidator])],isAllowBackDate:[this.oldData.isAllowBackDate||null,l.kI.compose([l.kI.required,l.kI.nullValidator])],allowDays:[this.oldData.allowDays||null],ruleDate:[this.oldData.quotationDay||null,l.kI.compose([l.kI.required,l.kI.nullValidator])],ruleType:[this.oldData.quotationRule||null,l.kI.compose([l.kI.required,l.kI.nullValidator])],policyDay:[this.oldData.policyDay||null,l.kI.compose([l.kI.required,l.kI.nullValidator])],policyRule:[this.oldData.policyRule||null,l.kI.compose([l.kI.required,l.kI.nullValidator])],statusCd:[this.oldData.statusCd||"02",l.kI.compose([l.kI.required,l.kI.nullValidator])],paymentFrequency:[this.oldData.paymentFrequencyType?this.oldData.paymentFrequencyType.split(","):null],icon:[this.oldData.icon?this.oldData.icon:null],smallIcon:[this.oldData.smallIcon?this.oldData.smallIcon:null],coverIcon:[this.oldData.coverIcon?this.oldData.coverIcon:null]})}save(){if(this.formGroup.valid){let t=this.formGroup.value;this.productService.save({name:t.productName,code:t.productCode,coverName:t.coverName,type:t.type,quotationDay:t.ruleDate,quotationRule:t.ruleType,policyDay:t.policyDay,policyRule:t.policyRule,paymentFrequencyType:"",application:!1,quotation:!1,isAllowBackDate:t.isAllowBackDate,allowDays:t.isAllowDays,stamDuty:t.stamDuty,statusCd:t.statusCd}).toPromise().then(i=>{i&&this.modal.dismiss({data:this.formGroup.value,type:"save"})})}}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}isControlValid(t){const o=this.formGroup.controls[t];return o.valid&&(o.dirty||o.touched)}isControlInvalid(t){const o=this.formGroup.controls[t];return o.invalid&&(o.dirty||o.touched)}controlHasError(t,o){const i=this.formGroup.controls[o];return i.hasError(t)&&(i.dirty||i.touched)}isControlTouched(t){const o=this.formGroup.controls[t];return o.dirty||o.touched}changePayment(t){let i=this.formGroup.value.paymentFrequency||[];if(this[t])i.push(t);else{let d=i.findIndex(C=>C==t);i.splice(d,1)}this.formGroup.controls.paymentFrequency.setValue(i)}openFile(t){"cover"==t?this.selectedFileEl3.nativeElement.click():"small"==t?this.selectedFileEl2.nativeElement.click():this.selectedFileEl1.nativeElement.click()}handleUpload(t,o){if(t){const i=t.target.files[0],d=(0,T.y)();d.readAsDataURL(i),d.onload=()=>{if(d.result){let Y={fileStr:d.result.toString().split(",")[1],fileName:i.name,fileType:i.type,fileSize:i.size,contentType:i.type,fileExtension:i.name.split(".").pop()};this.loading.activate(),this.fileUpload.save(Y).toPromise().then(A=>{A&&("cover"==o?this.formGroup.controls.coverIcon.setValue(A):"small"==o?this.formGroup.controls.smallIcon.setValue(A):this.formGroup.controls.icon.setValue(A)),this.cdf.detectChanges(),this.loading.deactivate()}).catch(A=>{this.loading.deactivate()})}}}}deleteEditModal(){this.alertService.activate("Are you sure want to delete?","Warning Message").then(t=>{t&&this.modal.dismiss({type:"delete"})})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(l.qu),e.Y36(Z.Kz),e.Y36(k.f),e.Y36(B.p3),e.Y36(Q.b),e.Y36(_.c),e.Y36(e.sBO))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-products-modal"]],viewQuery:function(t,o){if(1&t&&(e.Gf(L,5),e.Gf(F,5),e.Gf(f,5)),2&t){let i;e.iGM(i=e.CRH())&&(o.selectedFileEl1=i.first),e.iGM(i=e.CRH())&&(o.selectedFileEl2=i.first),e.iGM(i=e.CRH())&&(o.selectedFileEl3=i.first)}},decls:147,vars:69,consts:[[1,"modal-content"],[1,"modal-header"],["id","example-modal-sizes-title-lg",1,"modal-title","h4","left-border-image"],[1,"overlay","overlay-block","cursor-default","modal-body"],["action","#",1,"form","form-label-right",3,"formGroup"],[1,"row"],[1,"col-12"],[1,"form-group"],[1,"form-label"],["type","text","name","productName","autocomplete","off","formControlName","productName",1,"form-control","form-control-sm",3,"placeholder"],["type","text","name","productCode","autocomplete","off","formControlName","productCode",1,"form-control","form-control-sm",3,"placeholder"],["type","text","name","coverName","placeholder","Cover Name","autocomplete","off","formControlName","coverName",1,"form-control","form-control-sm"],["name","type","placeholder","Product code","autocomplete","off","formControlName","type",1,"form-control","form-control-sm"],["value","GENERAL"],["value","LIFE"],[1,"col-sm-6"],[1,"example-margin","form-label"],["formControlName","isAllowBackDate"],["value","no",1,"example-margin"],["value","yes",1,"example-margin"],[1,"form-group","row"],[1,"col-md-6","col-form-label","text-md-right"],[1,"col-md-6","col-xl-4"],[1,"switch","switch-icon"],["type","checkbox","name","stamDuty","formControlName","stamDuty"],["class","row",4,"ngIf"],[1,"col-sm-4"],["type","number","name","ruleDate","placeholder","Dates","autocomplete","off","formControlName","ruleDate",1,"form-control","form-control-sm"],[1,"feedback"],["name","ruleType","formControlName","ruleType",1,"form-control","form-control-sm"],["value",""],["value","DAY"],["value","MONTH"],["type","text","name","ruleDate","autocomplete","off","value","after creation dates","readonly","",1,"form-control","form-control-sm"],["type","number","name","policyDay","placeholder","Dates","autocomplete","off","formControlName","policyDay",1,"form-control","form-control-sm"],["name","policyRule","formControlName","policyRule",1,"form-control","form-control-sm"],[1,"col-sm-12"],["bindLabel","value","bindValue","code","formControlName","statusCd",1,"ng-custom-select",3,"items"],[1,"upload-icon-group"],[1,"upload-icon",3,"click"],["alt","",3,"src",4,"ngIf"],[4,"ngIf"],["type","file",2,"display","none",3,"change"],["selectedFile1",""],["selectedFile2",""],["selectedFile3",""],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-2",3,"click"],["type","submit",1,"btn","btn-primary","btn-elevate",3,"disabled","click"],["type","number","name","allowDays","placeholder","Days","autocomplete","off","formControlName","allowDays",1,"form-control","form-control-sm"],["alt","",3,"src"],[1,"flaticon-upload-1","icon-lg"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"form",4),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e.TgZ(8,"div",7),e.TgZ(9,"label",8),e._uU(10),e.ALo(11,"translate"),e.qZA(),e._UZ(12,"input",9),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div",7),e.TgZ(15,"label",8),e._uU(16),e.ALo(17,"translate"),e.qZA(),e._UZ(18,"input",10),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"div",7),e.TgZ(21,"label",8),e._uU(22,"Cover Name"),e.qZA(),e._UZ(23,"input",11),e.qZA(),e.TgZ(24,"div",7),e.TgZ(25,"label",8),e._uU(26,"Product Type"),e.qZA(),e.TgZ(27,"select",12),e.TgZ(28,"option",13),e._uU(29,"General Insurance"),e.qZA(),e.TgZ(30,"option",14),e._uU(31,"Life Insurance"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(32,"div",5),e.TgZ(33,"div",15),e.TgZ(34,"div",7),e.TgZ(35,"label",16),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"mat-radio-group",17),e.TgZ(39,"mat-radio-button",18),e._uU(40,"No"),e.qZA(),e.TgZ(41,"mat-radio-button",19),e._uU(42,"Yes"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(43,"div",15),e.TgZ(44,"div",20),e.TgZ(45,"label",21),e._uU(46,"Stamp Duty"),e.qZA(),e.TgZ(47,"div",22),e.TgZ(48,"span",23),e.TgZ(49,"label"),e._UZ(50,"input",24),e._UZ(51,"span"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(52,D,6,0,"div",25),e.TgZ(53,"div",5),e.TgZ(54,"div",26),e.TgZ(55,"div",7),e.TgZ(56,"label",8),e._uU(57),e.ALo(58,"translate"),e.qZA(),e._UZ(59,"input",27),e.TgZ(60,"div",28),e._uU(61,"Enter Rule"),e.TgZ(62,"b"),e._uU(63," Period"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(64,"div",26),e.TgZ(65,"div",7),e.TgZ(66,"label",8),e._uU(67,"Period Type"),e.qZA(),e.TgZ(68,"select",29),e.TgZ(69,"option",30),e._uU(70,"Please Select"),e.qZA(),e.TgZ(71,"option",31),e._uU(72,"Days"),e.qZA(),e.TgZ(73,"option",32),e._uU(74,"Months"),e.qZA(),e.qZA(),e.TgZ(75,"div",28),e._uU(76,"Select Rule "),e.TgZ(77,"b"),e._uU(78,"Period Type"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(79,"div",26),e.TgZ(80,"div",7),e.TgZ(81,"label",8),e._uU(82," \xa0"),e.qZA(),e._UZ(83,"input",33),e.qZA(),e.qZA(),e.qZA(),e.TgZ(84,"div",5),e.TgZ(85,"div",26),e.TgZ(86,"div",7),e.TgZ(87,"label",8),e._uU(88),e.ALo(89,"translate"),e.qZA(),e._UZ(90,"input",34),e.TgZ(91,"div",28),e._uU(92,"Enter Rule"),e.TgZ(93,"b"),e._uU(94," Period"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(95,"div",26),e.TgZ(96,"div",7),e.TgZ(97,"label",8),e._uU(98,"Period Type"),e.qZA(),e.TgZ(99,"select",35),e.TgZ(100,"option",30),e._uU(101,"Please Select"),e.qZA(),e.TgZ(102,"option",31),e._uU(103,"Days"),e.qZA(),e.TgZ(104,"option",32),e._uU(105,"Months"),e.qZA(),e.qZA(),e.TgZ(106,"div",28),e._uU(107,"Select Rule "),e.TgZ(108,"b"),e._uU(109,"Period Type"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(110,"div",26),e.TgZ(111,"div",7),e.TgZ(112,"label",8),e._uU(113," \xa0"),e.qZA(),e._UZ(114,"input",33),e.qZA(),e.qZA(),e.qZA(),e.TgZ(115,"div",5),e.TgZ(116,"div",36),e.TgZ(117,"div",7),e.TgZ(118,"label",8),e._uU(119,"Product Status"),e.qZA(),e._UZ(120,"ng-select",37),e.qZA(),e.qZA(),e.qZA(),e.TgZ(121,"div",5),e.TgZ(122,"div",6),e.TgZ(123,"div",7),e.TgZ(124,"label",8),e._uU(125,"Upload Product Icon"),e.qZA(),e.TgZ(126,"div",38),e.TgZ(127,"div",39),e.NdJ("click",function(){return o.openFile("icon")}),e.YNc(128,w,1,1,"img",40),e.YNc(129,S,4,0,"ng-container",41),e.TgZ(130,"input",42,43),e.NdJ("change",function(d){return o.handleUpload(d,"icon")}),e.qZA(),e.qZA(),e.TgZ(132,"div",39),e.NdJ("click",function(){return o.openFile("small")}),e.YNc(133,x,1,1,"img",40),e.YNc(134,R,4,0,"ng-container",41),e.TgZ(135,"input",42,44),e.NdJ("change",function(d){return o.handleUpload(d,"small")}),e.qZA(),e.qZA(),e.TgZ(137,"div",39),e.NdJ("click",function(){return o.openFile("cover")}),e.YNc(138,O,1,1,"img",40),e.YNc(139,G,4,0,"ng-container",41),e.TgZ(140,"input",42,45),e.NdJ("change",function(d){return o.handleUpload(d,"cover")}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(142,"div",46),e.TgZ(143,"button",47),e.NdJ("click",function(){return o.modal.dismiss()}),e._uU(144,"Cancel"),e.qZA(),e.TgZ(145,"button",48),e.NdJ("click",function(){return o.save()}),e._uU(146,"Save"),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.AsE(" ",o.prodId?"Edit":"Create a new product"," ",o.prodName," "),e.xp6(2),e.Q6J("formGroup",o.formGroup),e.xp6(5),e.Oqu(e.lcZ(11,55,"TABLE.Product Name")),e.xp6(2),e.ekj("is-invalid",o.isControlInvalid("productName"))("is-valid",o.isControlValid("productName")),e.s9C("placeholder",e.lcZ(13,57,"TABLE.Product Name")),e.xp6(4),e.Oqu(e.lcZ(17,59,"TABLE.Product Code")),e.xp6(2),e.ekj("is-invalid",o.isControlInvalid("productCode"))("is-valid",o.isControlValid("productCode")),e.s9C("placeholder",e.lcZ(19,61,"TABLE.Product Code")),e.xp6(5),e.ekj("is-invalid",o.isControlInvalid("coverName"))("is-valid",o.isControlValid("coverName")),e.xp6(4),e.ekj("is-invalid",o.isControlInvalid("type"))("is-valid",o.isControlValid("type")),e.xp6(9),e.Oqu(e.lcZ(37,63,"TABLE.Allow Back Date")),e.xp6(16),e.Q6J("ngIf","yes"==o.formGroup.value.isAllowBackDate),e.xp6(5),e.Oqu(e.lcZ(58,65,"TABLE.Quotation Auto Lapse Rule")),e.xp6(2),e.ekj("is-invalid",o.isControlInvalid("ruleDate"))("is-valid",o.isControlValid("ruleDate")),e.xp6(9),e.ekj("is-invalid",o.isControlInvalid("ruleType"))("is-valid",o.isControlValid("ruleType")),e.xp6(20),e.Oqu(e.lcZ(89,67,"TABLE.Application Auto Lapse Rule")),e.xp6(2),e.ekj("is-invalid",o.isControlInvalid("policyDay"))("is-valid",o.isControlValid("policyDay")),e.xp6(9),e.ekj("is-invalid",o.isControlInvalid("policyRule"))("is-valid",o.isControlValid("policyRule")),e.xp6(21),e.ekj("is-invalid",o.isControlInvalid("statusCd"))("is-valid",o.isControlValid("statusCd")),e.Q6J("items",o.statusCdOption),e.xp6(8),e.Q6J("ngIf",o.formGroup.value.icon),e.xp6(1),e.Q6J("ngIf",!o.formGroup.value.icon),e.xp6(4),e.Q6J("ngIf",o.formGroup.value.smallIcon),e.xp6(1),e.Q6J("ngIf",!o.formGroup.value.smallIcon),e.xp6(4),e.Q6J("ngIf",o.formGroup.value.coverIcon),e.xp6(1),e.Q6J("ngIf",!o.formGroup.value.coverIcon),e.xp6(6),e.Q6J("disabled",o.formGroup.invalid))},directives:[l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,l.EJ,l.YN,l.Kr,I.VQ,I.U0,l.Wl,q.O5,l.wV,U.w9],pipes:[N.X],styles:[".upload-icon-group[_ngcontent-%COMP%]{display:flex;gap:10px}.upload-icon[_ngcontent-%COMP%]{display:flex;align-items:center;width:100px;height:100px;border:1px dashed #333;flex-direction:column;justify-content:center;gap:5px;border-radius:10px;overflow:hidden}.upload-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px;height:100px}"]}),a})();var v=s(34436);const E=[{title:"Small Icon",type:v.Y.FEILD,field:"smallIcon",isImg:!0},{title:"Product Name",type:v.Y.FEILD,field:"name"},{title:"Product Code",type:v.Y.FEILD,field:"code"},{title:"Type",type:v.Y.FEILD,field:"type",isTitle:!0},{title:"Allow Back Date",type:v.Y.FEILD,field:"isAllowBackDate",isAllowBackDate:!0},{title:"Quotation Auto Lapse Rule",type:v.Y.FEILD,field:"quotationDay",isQuotationDay:!0},{title:"Application Auto Lapse Rule",type:v.Y.FEILD,field:"policyDay",isPolicyDay:!0},{title:"Status",type:v.Y.FEILD,field:"statusCd",isProdStatus:!0},{title:"Actions",type:v.Y.ACTION,field:"actions",btn:{edit:!0}}],M=["smallIcon","name","code","type","isAllowBackDate","quotationDay","policyDay","statusCd","actions"];var n=s(93230),m=s(17606),r=s(96592);function c(a,p){if(1&a){const t=e.EpF();e.TgZ(0,"div",9),e.TgZ(1,"button",10),e.NdJ("click",function(){return e.CHM(t),e.oxw().createOrEdit()}),e._UZ(2,"span",11),e.qZA(),e.qZA()}}function u(a,p){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-material-table-view",12),e.NdJ("emitter",function(i){return e.CHM(t),e.oxw().actionBtn(i)}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("selectable","page"!=t.type)("data",t.products)("colum",t.ELEMENT_COL)("displayedColumns",t.displayedColumns)}}function y(a,p){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",13),e.TgZ(2,"button",14),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeModal()}),e._uU(3,"Cancel"),e.qZA(),e.TgZ(4,"button",15),e.NdJ("click",function(){return e.CHM(t),e.oxw().nextProd()}),e._uU(5,"Next"),e.qZA(),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(4),e.Q6J("disabled",!t.selected.id)}}let g=(()=>{class a{constructor(t,o,i,d,C){this.modalService=t,this.itemService=o,this.router=i,this.cdRef=d,this.menuService=C,this.type="page",this.products=[],this.ELEMENT_COL=JSON.parse(JSON.stringify(E)),this.displayedColumns=JSON.parse(JSON.stringify(M)),this.unsubscribe=[],this.show=!1,this.prodAccess=m.w}ngOnInit(){"page"!=this.type&&(this.ELEMENT_COL.splice(8,1),this.displayedColumns.splice(8,1)),this.show=!0,this.getProducts()}checkPremission(){this.menuService.dataAccess.subscribe(t=>{t&&(this.prodAccess=t.product_definition,this.prodAccess.edit&&(this.ELEMENT_COL[8].btn.edit=!1))})}ngOnDestroy(){this.unsubscribe.forEach(t=>t.unsubscribe())}editLayout(t){this.itemService.findOne(t.id).toPromise().then(o=>{o&&(this.itemService.createingProd=o,this.itemService.type=t.application?"application":"quotation",this.router.navigateByUrl("/product-form"))})}get selected(){let t;return this.matTable&&(t=this.matTable.selection.selected[0]),t||{id:0}}createOrEdit(t,o){const i=this.modalService.open(P,{size:"xl",backdrop:!1});i.componentInstance.prodId=o,i.componentInstance.oldData=t||{},i.result.then(()=>{},d=>{d&&"save"==d.type&&(this.getProducts(),this.cdRef.detectChanges())})}closeModal(){this.modalService.dismissAll()}nextProd(){this.selected.id&&this.itemService.findOne(this.selected.id).toPromise().then(t=>{t&&this.modalService.dismissAll({data:t,type:"save"})})}getProducts(){this.itemService.getAll().toPromise().then(t=>{t&&(this.products=t,this.cdRef.detectChanges(),this.matTable.reChangeData())})}viewDetail(t){this.itemService.selectedProd=t,this.itemService.viewType="view",this.router.navigateByUrl("/product/products-config/detail")}getFreq(t){let o="",i=t.split(", ");for(const d of i)"lump"==d?o=o.length>2?o+", Lump Sum":"Lump Sum":"annually"==d&&(o=o.length>2?o+", Semi Annually":"Semi Annually");return o}actionBtn(t){"edit"==t.cmd?this.viewDetail(t.data):"view"==t.cmd&&this.editLayout(t.data)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Z.FF),e.Y36(k.f),e.Y36(r.F0),e.Y36(e.sBO),e.Y36(m.q))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-products"]],viewQuery:function(t,o){if(1&t&&e.Gf(n.I,5),2&t){let i;e.iGM(i=e.CRH())&&(o.matTable=i.first)}},decls:11,vars:3,consts:[[1,"row"],[1,"col-12"],[1,"card","card-custom"],[1,"card-header"],[1,"card-title"],[1,"card-label","left-border-image"],["class","card-toolbar",4,"ngIf"],[1,"card-body","customer-card-body"],[4,"ngIf"],[1,"card-toolbar"],["type","button",1,"btn","btn-primary","btn-circle",3,"click"],[1,"flaticon2-plus"],[3,"selectable","data","colum","displayedColumns","emitter"],[1,"card-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-2",3,"click"],["type","button",1,"btn","btn-primary","btn-elevate",3,"disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"h3",5),e._uU(6,"List of Products"),e.qZA(),e.qZA(),e.YNc(7,c,3,0,"div",6),e.qZA(),e.TgZ(8,"div",7),e.YNc(9,u,2,4,"ng-container",8),e.qZA(),e.YNc(10,y,6,1,"ng-container",8),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(7),e.Q6J("ngIf","page"==o.type),e.xp6(2),e.Q6J("ngIf",o.show),e.xp6(1),e.Q6J("ngIf","page"!=o.type))},directives:[q.O5,n.I],styles:[""]}),a})()}}]);