"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4589,7975],{92118:(Z,M,s)=>{s.d(M,{t7:()=>A});var d=s(83668),u=s(44290),f=s(92070);const c=s.n(f)()||f,t=new d.OlP("MAT_MOMENT_DATE_ADAPTER_OPTIONS",{providedIn:"root",factory:function(){return{useUtc:!1}}});function R(a,m){const n=Array(a);for(let i=0;i<a;i++)n[i]=m(i);return n}let A=(()=>{class a extends u._A{constructor(n,i){super(),this._options=i,this.setLocale(n||c.locale())}setLocale(n){super.setLocale(n);let i=c.localeData(n);this._localeData={firstDayOfWeek:i.firstDayOfWeek(),longMonths:i.months(),shortMonths:i.monthsShort(),dates:R(31,v=>this.createDate(2017,0,v+1).format("D")),longDaysOfWeek:i.weekdays(),shortDaysOfWeek:i.weekdaysShort(),narrowDaysOfWeek:i.weekdaysMin()}}getYear(n){return this.clone(n).year()}getMonth(n){return this.clone(n).month()}getDate(n){return this.clone(n).date()}getDayOfWeek(n){return this.clone(n).day()}getMonthNames(n){return"long"==n?this._localeData.longMonths:this._localeData.shortMonths}getDateNames(){return this._localeData.dates}getDayOfWeekNames(n){return"long"==n?this._localeData.longDaysOfWeek:"short"==n?this._localeData.shortDaysOfWeek:this._localeData.narrowDaysOfWeek}getYearName(n){return this.clone(n).format("YYYY")}getFirstDayOfWeek(){return this._localeData.firstDayOfWeek}getNumDaysInMonth(n){return this.clone(n).daysInMonth()}clone(n){return n.clone().locale(this.locale)}createDate(n,i,v){const y=this._createMoment({year:n,month:i,date:v}).locale(this.locale);return y.isValid(),y}today(){return this._createMoment().locale(this.locale)}parse(n,i){return n&&"string"==typeof n?this._createMoment(n,i,this.locale):n?this._createMoment(n).locale(this.locale):null}format(n,i){return n=this.clone(n),this.isValid(n),n.format(i)}addCalendarYears(n,i){return this.clone(n).add({years:i})}addCalendarMonths(n,i){return this.clone(n).add({months:i})}addCalendarDays(n,i){return this.clone(n).add({days:i})}toIso8601(n){return this.clone(n).format()}deserialize(n){let i;if(n instanceof Date)i=this._createMoment(n).locale(this.locale);else if(this.isDateInstance(n))return this.clone(n);if("string"==typeof n){if(!n)return null;i=this._createMoment(n,c.ISO_8601).locale(this.locale)}return i&&this.isValid(i)?this._createMoment(i).locale(this.locale):super.deserialize(n)}isDateInstance(n){return c.isMoment(n)}isValid(n){return this.clone(n).isValid()}invalid(){return c.invalid()}_createMoment(n,i,v){const{strict:y,useUtc:O}=this._options||{};return O?c.utc(n,i,v,y):c(n,i,v,y)}}return a.\u0275fac=function(n){return new(n||a)(d.LFG(u.Ad,8),d.LFG(t,8))},a.\u0275prov=d.Yz7({token:a,factory:a.\u0275fac}),a})()},85472:(Z,M,s)=>{s.d(M,{Z:()=>u});var d=s(83668);let u=(()=>{class f{constructor(c){this.el=c}ngOnInit(){for(var c=this.el.nativeElement,t=c.parentElement;c.firstChild;)t.insertBefore(c.firstChild,c);t.removeChild(c)}}return f.\u0275fac=function(c){return new(c||f)(d.Y36(d.SBq))},f.\u0275dir=d.lG2({type:f,selectors:[["","remove-host",""]]}),f})()},15470:(Z,M,s)=>{s.d(M,{Q:()=>h});var d=s(92118),u=s(44290),f=s(47975),e=s(83668),c=s(86019),t=s(49133),D=s(78480),R=s(15346);function A(_,T){if(1&_){const a=e.EpF();e.TgZ(0,"div",2),e.TgZ(1,"div",3),e.TgZ(2,"label",4),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",5),e.TgZ(6,"div",6),e._UZ(7,"input",7),e._UZ(8,"mat-datepicker-toggle",8),e._UZ(9,"mat-datepicker",9,10),e.TgZ(11,"span",11),e.NdJ("click",function(){return e.CHM(a),e.oxw().clearDate("startDate")}),e.TgZ(12,"span",12),e._uU(13,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&_){const a=e.MAs(10),m=e.oxw();e.Q6J("ngClass",m.colClass)("formGroup",m.formInput),e.xp6(3),e.Oqu(e.lcZ(4,5,"FORM.start_date")),e.xp6(4),e.Q6J("matDatepicker",a),e.xp6(1),e.Q6J("for",a)}}function C(_,T){if(1&_){const a=e.EpF();e.TgZ(0,"div",13),e.TgZ(1,"div",3),e.TgZ(2,"label",4),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",5),e.TgZ(6,"div",6),e._UZ(7,"input",14),e._UZ(8,"mat-datepicker-toggle",8),e._UZ(9,"mat-datepicker",9,15),e.TgZ(11,"span",11),e.NdJ("click",function(){return e.CHM(a),e.oxw().clearDate("endDate")}),e.TgZ(12,"span",12),e._uU(13,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&_){const a=e.MAs(10),m=e.oxw();e.Q6J("ngClass",m.colClass)("formGroup",m.formInput),e.xp6(3),e.Oqu(e.lcZ(4,5,"FORM.end_date")),e.xp6(4),e.Q6J("matDatepicker",a),e.xp6(1),e.Q6J("for",a)}}let h=(()=>{class _{constructor(){}ngOnInit(){this.getoneMonth()}clearDate(a){this.formInput.controls[a].setValue(null)}getoneMonth(){let a=new Date,m=new Date(a.setMonth(a.getMonth()-1)),n=new Date(a.setMonth(a.getMonth()+1));this.formInput.controls.startDate.setValue(m.toISOString()),this.formInput.controls.endDate.setValue(n.toISOString())}}return _.\u0275fac=function(a){return new(a||_)},_.\u0275cmp=e.Xpm({type:_,selectors:[["app-start-end-date"]],inputs:{formInput:"formInput",colClass:"colClass"},features:[e._Bn([{provide:u._A,useClass:d.t7,deps:[u.Ad]},{provide:u.sG,useValue:f.Gs}])],decls:2,vars:2,consts:[["ng","",3,"ngClass","formGroup",4,"ngIf"],[3,"ngClass","formGroup",4,"ngIf"],["ng","",3,"ngClass","formGroup"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8"],[1,"input-group"],["matInput","","formControlName","startDate","readonly","",1,"form-control-sm","date-input",3,"matDatepicker"],["matSuffix","",3,"for"],["disabled","false"],["startDate",""],["title","Clear all",1,"ng-clear-wrapper",3,"click"],["aria-hidden","true",1,"ng-clear"],[3,"ngClass","formGroup"],["matInput","","formControlName","endDate","readonly","",1,"form-control-sm","date-input",3,"matDatepicker"],["endDate",""]],template:function(a,m){1&a&&(e.YNc(0,A,14,7,"div",0),e.YNc(1,C,14,7,"div",1)),2&a&&(e.Q6J("ngIf",m.formInput),e.xp6(1),e.Q6J("ngIf",m.formInput))},directives:[c.O5,c.mk,t.JL,t.sg,t.Fj,D.hl,t.JJ,t.u,D.nW,D.Mq],pipes:[R.X],styles:[".input-group[_ngcontent-%COMP%]   .form-control-sm[_ngcontent-%COMP%]{background-color:#fff;background-clip:padding-box;border:1px solid #E4E6EF;padding:0 .75rem;width:100%}.input-group[_ngcontent-%COMP%]   .mat-datepicker-toggle[_ngcontent-%COMP%]{position:absolute;right:5px;top:-2px}.remove-p[_ngcontent-%COMP%]{margin-bottom:0}.col-form-label[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}.form-group.row[_ngcontent-%COMP%]{align-items:center}.ng-clear-wrapper[_ngcontent-%COMP%]   .ng-clear[_ngcontent-%COMP%]{cursor:pointer;position:absolute;right:3rem;top:.3rem;font-size:1.2rem;color:#999}.ng-clear-wrapper[_ngcontent-%COMP%]   .ng-clear[_ngcontent-%COMP%]:hover{color:#d0021b}"]}),_})()},47975:(Z,M,s)=>{function d(c){try{JSON.parse(c)}catch(t){return!1}return!0}s.d(M,{cU:()=>d,Gs:()=>u,Ny:()=>e});const u={parse:{dateInput:"DD-MM-YYYY"},display:{dateInput:"DD-MM-YYYY",monthYearLabel:"MMMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}},e={parse:{dateInput:"MM-YYYY"},display:{dateInput:"MM-YYYY",monthYearLabel:"MM-YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MM-YYYY"}}},15346:(Z,M,s)=>{s.d(M,{X:()=>f});var d=s(83668),u=s(59832);let f=(()=>{class e{constructor(t){this._languageService=t}transform(t){if(t){let D=this._languageService.getSelectedLanguage(),R=t.split(".");if(2==R.length)try{return this._languageService.langs[D][R[0]][R[1]]}catch(A){return"Can't Translate Data"}}return t}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(u.K,16))},e.\u0275pipe=d.Yjl({name:"translate",type:e,pure:!1}),e})()},94589:(Z,M,s)=>{s.r(M),s.d(M,{ReRerunJobPageModule:()=>W});var d=s(86019),u=s(49133),f=s(71704),e=s(4205),c=s(90949),t=s(83668),D=s(85993);function R(l,g){if(1&l&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&l){const o=g.$implicit;t.xp6(1),t.Oqu(o)}}function A(l,g){if(1&l){const o=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){return t.CHM(o),t.oxw().reRun()}),t._uU(1,"Re-Run"),t.qZA()}}let C=(()=>{class l{constructor(o){this.ngModal=o}ngOnInit(){this.data.errorDescription=(this.data.logMsg+"").split(",")}closeModal(){this.ngModal.dismiss()}reRun(){this.ngModal.dismiss({type:"rerun"})}}return l.\u0275fac=function(o){return new(o||l)(t.Y36(D.Kz))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-error-details"]],inputs:{data:"data"},decls:31,vars:5,consts:[[1,"modal-content"],[1,"modal-header"],["id","example-modal-sizes-title-lg",1,"modal-title","h4","left-border-image"],[1,"overlay","overlay-block","cursor-default","modal-body"],[1,"row",2,"align-items","center"],[1,"col-sm-12"],[1,"form-group","row"],[1,"col-sm-4","col-form-label","text-bold"],[1,"col-sm-8"],[1,"error-list"],[4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-2",3,"click"],["type","button","class","btn btn-primary btn-elevate mr-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-elevate","mr-2",3,"click"]],template:function(o,r){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.qZA(),t.TgZ(4,"div",3),t.TgZ(5,"div",4),t.TgZ(6,"div",5),t.TgZ(7,"div",6),t.TgZ(8,"label",7),t._uU(9,"Job Type -"),t.qZA(),t.TgZ(10,"div",8),t._uU(11),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",4),t.TgZ(13,"div",5),t.TgZ(14,"div",6),t.TgZ(15,"label",7),t._uU(16,"Job Name -"),t.qZA(),t.TgZ(17,"div",8),t._uU(18),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(19,"div",4),t.TgZ(20,"div",5),t.TgZ(21,"div",6),t.TgZ(22,"label",7),t._uU(23,"Description -"),t.qZA(),t.TgZ(24,"div",8),t.TgZ(25,"ul",9),t.YNc(26,R,2,1,"li",10),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",11),t.TgZ(28,"button",12),t.NdJ("click",function(){return r.closeModal()}),t._uU(29,"Close"),t.qZA(),t.YNc(30,A,2,0,"button",13),t.qZA(),t.qZA()),2&o&&(t.xp6(3),t.hij(" ",r.data.jobType," "),t.xp6(8),t.hij(" ",r.data.jobType," "),t.xp6(7),t.hij(" ",r.data.jobName," "),t.xp6(8),t.Q6J("ngForOf",r.data.errorDescription),t.xp6(4),t.Q6J("ngIf","FAIL"==r.data.status))},directives:[d.sg,d.O5],styles:[".form-group.row[_ngcontent-%COMP%]{align-items:flex-start}.error-list[_ngcontent-%COMP%]{padding:0}"]}),l})();var h=s(18510);const _=[{title:"Job Type",type:h.Y.FEILD,field:"jobType"},{title:"Job Name",type:h.Y.FEILD,field:"jobName"},{title:"Date",type:h.Y.FEILD,field:"runDate",isFromatDate:!0},{title:"status",type:h.Y.FEILD,field:"status",isTitle:!0},{title:"Actions",type:h.Y.ACTION,field:"actions",btn:{view:!0,rerun:!0}}],T=["jobType","jobName","runDate","status","actions"],a=[{title:"Job Type",type:h.Y.FEILD,field:"jobType"},{title:"Job Name",type:h.Y.FEILD,field:"jobName"},{title:"Date",type:h.Y.FEILD,field:"runDate",isFromatDate:!0},{title:"status",type:h.Y.FEILD,field:"status",isTitle:!0},{title:"Actions",type:h.Y.ACTION,field:"actions",btn:{view:!0,rerun:!0}}],m=["jobType","jobName","runDate","status","actions"];var n=s(92070),i=s(18260),v=s(44522);const y=`${i.N.apiUrl}/scheduler-log/`,b=`${i.N.apiUrl}/scheduler/status/run`,I=`${i.N.apiUrl}/scheduler/renewal/run`,L=`${i.N.apiUrl}/scheduler/crm/customer/run`;let P=(()=>{class l{constructor(o){this.httpClient=o}getReRunListByType(o={}){let r=y;return o.typeCode&&(r=r+"type/"+o.typeCode),this.httpClient.get(r)}reRunRenewal(){return this.httpClient.post(I,{})}reRunPolicyStatus(o){let r=n(o).format("YYYY-MM-DD");return this.httpClient.post(b+"?date="+r,{})}reRunCRM(o){let r=n(o).format("YYYY-MM-DD");return this.httpClient.post(L+"?date="+r,{})}}return l.\u0275fac=function(o){return new(o||l)(t.LFG(v.eN))},l.\u0275prov=t.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})();var S=s(60940),J=s(15470),N=s(85472),Y=s(57842),F=s(15346);function U(l,g){if(1&l){const o=t.EpF();t.TgZ(0,"div",24),t.TgZ(1,"button",8),t.NdJ("click",function(){return t.CHM(o),t.oxw().reRunRenewal()}),t.TgZ(2,"span",9),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.qZA(),t.qZA()}2&l&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"CARD.renewalRerun")))}const w=[{path:"",component:(()=>{class l{constructor(o,r,p,E){this.reRunService=o,this.modalService=r,this.cdf=p,this.alertService=E,this.typeOption=[{code:"",value:"All"},{code:"CRM",value:"CRM"},{code:"SALE",value:"Sale Portal"}],this.listFromCRM=[],this.listFromSale=[],this.isCRM=!1,this.ELEMENT_COL=JSON.parse(JSON.stringify(_)),this.displayedColumns=JSON.parse(JSON.stringify(T)),this.ELEMENT_COL_SALE=JSON.parse(JSON.stringify(a)),this.displayedColumnsSale=JSON.parse(JSON.stringify(m))}ngOnInit(){this.loadForm()}ngAfterViewInit(){this.getList()}loadForm(){this.reRunForm=new u.cw({startDate:new u.NI(null),endDate:new u.NI(null),typeCode:new u.NI("")})}getList(){this.reRunService.getReRunListByType(this.reRunForm.value).toPromise().then(o=>{o&&(console.log("res",o),this.listFromCRM=o,this.cdf.detectChanges(),this.matTableCRM.reChangeData(),this.isCRM="CRM"==this.reRunForm.controls.typeCode.value)})}actionBtn(o){if(console.log(o),"view"==o.cmd&&this.viewErrorDetail(o.data),"rerun"==o.cmd){if("FAIL"!=o.data.status)return this.alertService.activate("This job was already successful!","Warining Message"),!1;"CRM"==o.data.jobType?this.reRunCRM(o.data):"Renewal Policy"==o.data.jobName?this.reRunRenewal():this.reRunPolicyStatus(o.data)}}reRunRenewal(){this.reRunService.reRunRenewal().toPromise().then(o=>{console.log(o),o&&(this.alertService.activate("This job was re-run successful","Success Message"),this.getList())})}reRunPolicyStatus(o){this.reRunService.reRunPolicyStatus(o.runDate).toPromise().then(r=>{r&&(this.alertService.activate("This job was re-run successful","Success Message"),this.getList())})}reRunCRM(o){this.reRunService.reRunCRM(o.runDate).toPromise().then(r=>{r&&(this.alertService.activate("This job was re-run successful","Success Message"),this.getList())})}viewErrorDetail(o){let r;r=this.modalService.open(C,{size:"lg",backdrop:!0,centered:!0,scrollable:!0}),r.componentInstance.data=o,r.result.then(()=>{},p=>{if(p){if("FAIL"!=o.status)return this.alertService.activate("This job was already successful!","Warining Message"),!1;"CRM"==o.jobType?this.reRunCRM(o):"Renewal Policy"==o.jobName?this.reRunRenewal():this.reRunPolicyStatus(o)}})}isControlValid(o){const r=this.reRunForm.controls[o];return r.valid&&(r.dirty||r.touched)}isControlInvalid(o){const r=this.reRunForm.controls[o];return r.invalid&&(r.dirty||r.touched)}controlHasError(o,r){const p=this.reRunForm.controls[r];return p.hasError(o)&&(p.dirty||p.touched)}isControlTouched(o){const r=this.reRunForm.controls[o];return r.dirty||r.touched}cancel(){this.reRunForm.reset(),this.getList()}}return l.\u0275fac=function(o){return new(o||l)(t.Y36(P),t.Y36(D.FF),t.Y36(t.sBO),t.Y36(S.c))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-re-rerun-job"]],viewQuery:function(o,r){if(1&o&&(t.Gf(c.I,5),t.Gf(c.I,5)),2&o){let p;t.iGM(p=t.CRH())&&(r.matTableCRM=p.first),t.iGM(p=t.CRH())&&(r.matTableSale=p.first)}},decls:32,vars:22,consts:[[1,"row"],[1,"col-12"],[1,"card","card-custom","gutter-b"],[1,"card-header"],[1,"card-title"],[1,"card-label","left-border-image"],[1,"card-toolbar"],[1,"flaticon2-magnifier-tool","search-tool",3,"click"],["type","button",1,"btn","btn-primary","ml-2",2,"min-width","50px",3,"click"],[1,""],[1,"card-body","px-10","py-3"],["action","#",1,"form",3,"formGroup"],[1,"row",2,"align-items","center"],["remove-host","",3,"formInput","colClass"],[1,"col-xl-4","col-sm-6"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8"],["bindLabel","value","bindValue","code","formControlName","typeCode",1,"ng-custom-select",3,"items","clearable"],[1,"card","card-custom","gutter-b","data"],[1,"card-body","customer-card-body"],["style","float:right ; margin-top:15px",4,"ngIf"],[3,"data","colum","displayedColumns","emitter"],["matTableCRM",""],[2,"float","right","margin-top","15px"]],template:function(o,r){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"h3",5),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.qZA(),t.TgZ(8,"div",6),t.TgZ(9,"span",7),t.NdJ("click",function(){return r.getList()}),t.qZA(),t.TgZ(10,"button",8),t.NdJ("click",function(){return r.cancel()}),t.TgZ(11,"span",9),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",10),t.TgZ(15,"form",11),t.TgZ(16,"div",12),t._UZ(17,"app-start-end-date",13),t.TgZ(18,"div",14),t.TgZ(19,"div",15),t.TgZ(20,"label",16),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"div",17),t._UZ(24,"ng-select",18),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"div",0),t.TgZ(26,"div",1),t.TgZ(27,"div",19),t.TgZ(28,"div",20),t.YNc(29,U,5,3,"div",21),t.TgZ(30,"app-material-table-view",22,23),t.NdJ("emitter",function(E){return r.actionBtn(E)}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o&&(t.xp6(6),t.hij(" ",t.lcZ(7,16,"FORM.rerun_list"),""),t.xp6(6),t.Oqu(t.lcZ(13,18,"CARD.cancel")),t.xp6(3),t.Q6J("formGroup",r.reRunForm),t.xp6(2),t.Q6J("formInput",r.reRunForm)("colClass","col-xl-4 col-sm-6"),t.xp6(4),t.Oqu(t.lcZ(22,20,"FORM.type")),t.xp6(3),t.ekj("is-invalid",r.isControlInvalid("typeCode"))("is-valid",r.isControlValid("typeCode")),t.Q6J("items",r.typeOption)("clearable",!1),t.xp6(5),t.Q6J("ngIf",!r.isCRM&&r.listFromSale.length>0),t.xp6(1),t.Q6J("data",r.listFromCRM)("colum",r.ELEMENT_COL)("displayedColumns",r.displayedColumns))},directives:[u._Y,u.JL,u.sg,J.Q,N.Z,Y.w9,u.JJ,u.u,d.O5,c.I],pipes:[F.X],styles:[""]}),l})()}];let x=(()=>{class l{}return l.\u0275fac=function(o){return new(o||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[[e.Bz.forChild(w)],e.Bz]}),l})();var q=s(45598),j=s(63699);let W=(()=>{class l{}return l.\u0275fac=function(o){return new(o||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({providers:[],imports:[[d.ez,u.u5,f.Pc,u.UX,Y.A0,q.fA,j.j,x]]}),l})()}}]);