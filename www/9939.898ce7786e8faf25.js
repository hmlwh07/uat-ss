"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9939],{49875:(E,Z,s)=>{s.d(Z,{Ys:()=>R,ou:()=>O,p3:()=>I});var n=s(64762),f=s(18260),v=s(91691),t=s(91278),p=(()=>{return(r=p||(p={})).Documents="DOCUMENTS",r.Data="DATA",r.Library="LIBRARY",r.Cache="CACHE",r.External="EXTERNAL",r.ExternalStorage="EXTERNAL_STORAGE",p;var r})();const d=(0,t.fo)("Filesystem",{web:()=>s.e(2571).then(s.bind(s,52571)).then(r=>new r.FilesystemWeb)}),D=(0,t.fo)("BlobWriter");function k(r){const a=new Uint8Array(r);let l="",e=0;for(;!(e>=a.byteLength);)l+=String.fromCharCode(a[e]),e+=1;return window.btoa(l)}function b(r,a,l){if(0===l.size)return Promise.resolve();const e=393216,o=l.slice(0,e);return new window.Response(o).arrayBuffer().then(function(c){return d.appendFile({directory:r,path:a,data:k(c)})}).then(function(){return b(r,a,l.slice(e))})}function C({path:r,directory:a,blob:l,recursive:e}){return d.writeFile({directory:a,path:r,recursive:e,data:""}).then(function({uri:o}){return b(a,r,l).then(function(){return o})})}const F=Object.freeze(function(r){const{path:a,directory:l,blob:e,recursive:o,on_fallback:i}=r;return"ios"!==t.dV.platform&&"android"!==t.dV.platform?C(r):Promise.all([D.get_config(),d.getUri({path:a,directory:l})]).then(function([g,U]){const{base_url:y,auth_token:M}=g,G=U.uri.replace("file://","");return Promise.all([fetch(y+G+(o?"?recursive=true":""),{headers:{authorization:M},method:"put",body:e}),Promise.resolve(U)])}).then(function([c,g]){if(204!==c.status)throw new Error("Bad HTTP status: "+c.status);return g.uri}).catch(function(g){return void 0!==i&&i(g),C(r)})});var u=s(83668),A=s(44522),w=s(96360),L=s(60807),m=s(18829),S=s(60940);const x=`${f.N.apiUrl}/attachment-uploader`;let I=(()=>{class r extends v.i{constructor(l){super(l,x),this.httpClient=l}}return r.\u0275fac=function(l){return new(l||r)(u.LFG(A.eN))},r.\u0275prov=u.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const q=`${f.N.apiUrl}/attachment-downloader`;let R=(()=>{class r extends v.i{constructor(l,e,o,i,c){super(l,q),this.httpClient=l,this.file=e,this.loadingService=o,this.toastService=i,this.alertService=c}getDownload(l,e){this.httpClient.get(q+"/"+l,{responseType:"blob"}).toPromise().then(o=>{o&&(t.dV.isNativePlatform()?this.mobileDownload(e,o):this.downloadFile(o,e))})}downloadFile(l,e){var o=document.createElement("a");o.href=URL.createObjectURL(l),o.download=e,o.click(),o.remove()}mobileDownload(l,e){return(0,n.mG)(this,void 0,void 0,function*(){try{let o=yield d.mkdir({path:"kbzsale_downloads",directory:p.Documents,recursive:!1});console.log("folder ",o),this.createFile(l,e)}catch(o){this.createFile(l,e)}})}createFile(l,e){return(0,n.mG)(this,void 0,void 0,function*(){try{yield F({path:"kbzsale_downloads/"+l,directory:p.Documents,blob:e}),yield this.loadingService.deactivate(),this.alertService.activate('"Download File',"Success Message")}catch(o){yield this.loadingService.deactivate(),this.alertService.activate('"Download Fail',"Error Message")}})}}return r.\u0275fac=function(l){return new(l||r)(u.LFG(A.eN),u.LFG(w.$),u.LFG(L.b),u.LFG(m.T),u.LFG(S.c))},r.\u0275prov=u.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const P=`${f.N.apiUrl}/attachment-ref`;let O=(()=>{class r extends v.i{constructor(l){super(l,P),this.httpClient=l}getAttachmentListRef(l,e){return this.httpClient.get(P+"?refDocNo="+l+"&refDocType="+e)}}return r.\u0275fac=function(l){return new(l||r)(u.LFG(A.eN))},r.\u0275prov=u.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},31248:(E,Z,s)=>{function n(){const f=new FileReader;return f.__zone_symbol__originalInstance||f}s.d(Z,{y:()=>n})},9939:(E,Z,s)=>{s.d(Z,{P:()=>r});var n=s(49133),f=s(18260),v=s(31248),t=s(83668),p=s(85378),T=s(35618),h=s(49875),_=s(60807),d=s(55167),D=s(86019),k=s(57842);const b=["selectedFile"],C=["selectedFile2"];function N(a,l){1&a&&(t.TgZ(0,"div",5),t.TgZ(1,"div",35),t.TgZ(2,"div",7),t.TgZ(3,"label",8),t._uU(4,"Rule Days"),t.qZA(),t._UZ(5,"input",47),t.qZA(),t.qZA(),t.qZA())}function F(a,l){if(1&a&&t._UZ(0,"img",48),2&a){const e=t.oxw();t.Q6J("src",e.Default_DOWNLOAD_URL+"/"+e.formGroup.value.icon,t.LSH)}}function u(a,l){1&a&&(t.ynx(0),t._UZ(1,"i",49),t.TgZ(2,"label"),t._uU(3,"Icon"),t.qZA(),t.BQk())}function A(a,l){if(1&a&&t._UZ(0,"img",48),2&a){const e=t.oxw();t.Q6J("src",e.Default_DOWNLOAD_URL+"/"+e.formGroup.value.icon,t.LSH)}}function w(a,l){1&a&&(t.ynx(0),t._UZ(1,"i",49),t.TgZ(2,"label"),t._uU(3,"Small Icon"),t.qZA(),t.BQk())}let L=(()=>{class a{constructor(e,o,i,c,g){this.fb=e,this.modal=o,this.productService=i,this.fileUpload=c,this.loading=g,this.prodId="",this.prodName="",this.lump=!1,this.annually=!1,this.subscriptions=[],this.oldData={},this.Default_DOWNLOAD_URL=`${f.N.apiUrl}/attachment-downloader`,this.statusCdOption=[{code:"01",value:"Draft"},{code:"02",value:"Active"}]}ngOnInit(){this.loadForm()}loadForm(){this.formGroup=this.fb.group({productName:[this.oldData.name||null,n.kI.compose([n.kI.required,n.kI.nullValidator])],productCode:[this.oldData.code||null,n.kI.compose([n.kI.required,n.kI.nullValidator])],type:[this.oldData.type||"GENERAL",n.kI.compose([n.kI.required,n.kI.nullValidator])],stamDuty:[this.oldData.stamDuty||!1,n.kI.compose([n.kI.required,n.kI.nullValidator])],isAllowBackDate:[this.oldData.isAllowBackDate||null,n.kI.compose([n.kI.required,n.kI.nullValidator])],allowDays:[this.oldData.allowDays||null],ruleDate:[this.oldData.quotationDay||null,n.kI.compose([n.kI.required,n.kI.nullValidator])],ruleType:[this.oldData.quotationRule||null,n.kI.compose([n.kI.required,n.kI.nullValidator])],policyDay:[this.oldData.policyDay||null,n.kI.compose([n.kI.required,n.kI.nullValidator])],policyRule:[this.oldData.policyRule||null,n.kI.compose([n.kI.required,n.kI.nullValidator])],statusCd:[this.oldData.statusCd||"02",n.kI.compose([n.kI.required,n.kI.nullValidator])],paymentFrequency:[this.oldData.paymentFrequencyType?this.oldData.paymentFrequencyType.split(","):null],icon:[this.oldData.icon?this.oldData.icon:null],smallIcon:[this.oldData.smallIcon?this.oldData.smallIcon:null]})}save(){if(this.formGroup.valid){let e=this.formGroup.value;this.productService.save({name:e.productName,code:e.productCode,type:e.type,quotationDay:e.ruleDate,quotationRule:e.ruleType,policyDay:e.policyDay,policyRule:e.policyRule,paymentFrequencyType:"",application:!1,quotation:!1,isAllowBackDate:e.isAllowBackDate,allowDays:e.isAllowDays,stamDuty:e.stamDuty,statusCd:e.statusCd}).toPromise().then(i=>{i&&this.modal.dismiss({data:this.formGroup.value,type:"save"})})}}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}isControlValid(e){const o=this.formGroup.controls[e];return o.valid&&(o.dirty||o.touched)}isControlInvalid(e){const o=this.formGroup.controls[e];return o.invalid&&(o.dirty||o.touched)}controlHasError(e,o){const i=this.formGroup.controls[o];return i.hasError(e)&&(i.dirty||i.touched)}isControlTouched(e){const o=this.formGroup.controls[e];return o.dirty||o.touched}changePayment(e){let i=this.formGroup.value.paymentFrequency||[];if(this[e])i.push(e);else{let c=i.findIndex(g=>g==e);i.splice(c,1)}this.formGroup.controls.paymentFrequency.setValue(i)}openFile(e=!1){e?this.selectedFileEl2.nativeElement.click():this.selectedFileEl.nativeElement.click()}handleUpload(e,o=!1){if(e){const i=e.target.files[0];console.log(i);const c=(0,v.y)();c.readAsDataURL(i),c.onload=()=>{if(c.result){let U={fileStr:c.result.toString().split(",")[1],fileName:i.name,fileType:i.type,fileSize:i.size,contentType:i.type,fileExtension:i.name.split(".").pop()};this.loading.activate(),this.fileUpload.save(U).toPromise().then(y=>{y&&(o?this.formGroup.controls.smallIcon.setValue(y):this.formGroup.controls.icon.setValue(y)),this.loading.deactivate()}).catch(y=>{this.loading.deactivate()})}}}}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(n.qu),t.Y36(p.Kz),t.Y36(T.f),t.Y36(h.p3),t.Y36(_.b))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-products-modal"]],viewQuery:function(e,o){if(1&e&&(t.Gf(b,5),t.Gf(C,5)),2&e){let i;t.iGM(i=t.CRH())&&(o.selectedFileEl=i.first),t.iGM(i=t.CRH())&&(o.selectedFileEl2=i.first)}},decls:131,vars:42,consts:[[1,"modal-content"],[1,"modal-header"],["id","example-modal-sizes-title-lg",1,"modal-title","h4","left-border-image"],[1,"overlay","overlay-block","cursor-default","modal-body"],["action","#",1,"form","form-label-right",3,"formGroup"],[1,"row"],[1,"col-12"],[1,"form-group"],[1,"form-label"],["type","text","name","productName","placeholder","Product name","autocomplete","off","formControlName","productName",1,"form-control","form-control-sm"],["type","text","name","productCode","placeholder","Product code","autocomplete","off","formControlName","productCode",1,"form-control","form-control-sm"],["name","type","placeholder","Product code","autocomplete","off","formControlName","type",1,"form-control","form-control-sm"],["value","GENERAL"],["value","LIFE"],[1,"col-sm-6"],[1,"example-margin","form-label"],["formControlName","isAllowBackDate"],["value","no",1,"example-margin"],["value","yes",1,"example-margin"],[1,"form-group","row"],[1,"col-md-6","col-form-label","text-md-right"],[1,"col-md-6","col-xl-4"],[1,"switch","switch-icon"],["type","checkbox","name","stamDuty","formControlName","stamDuty"],["class","row",4,"ngIf"],[1,"col-sm-4"],["type","number","name","ruleDate","placeholder","Dates","autocomplete","off","formControlName","ruleDate",1,"form-control","form-control-sm"],[1,"feedback"],["name","ruleType","formControlName","ruleType",1,"form-control","form-control-sm"],["value",""],["value","DAY"],["value","MONTH"],["type","text","name","ruleDate","autocomplete","off","value","after creation dates","readonly","",1,"form-control","form-control-sm"],["type","number","name","policyDay","placeholder","Dates","autocomplete","off","formControlName","policyDay",1,"form-control","form-control-sm"],["name","policyRule","formControlName","policyRule",1,"form-control","form-control-sm"],[1,"col-sm-12"],["bindLabel","value","bindValue","code","formControlName","statusCd",1,"ng-custom-select",3,"items"],[1,"upload-icon-group"],[1,"upload-icon",3,"click"],["alt","",3,"src",4,"ngIf"],[4,"ngIf"],["type","file",2,"display","none",3,"change"],["selectedFile",""],["selectedFile2",""],[1,"modal-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-2",3,"click"],["type","submit",1,"btn","btn-primary","btn-elevate",3,"disabled","click"],["type","number","name","allowDays","placeholder","Days","autocomplete","off","formControlName","allowDays",1,"form-control","form-control-sm"],["alt","",3,"src"],[1,"flaticon-upload-1","icon-lg"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.qZA(),t.TgZ(4,"div",3),t.TgZ(5,"form",4),t.TgZ(6,"div",5),t.TgZ(7,"div",6),t.TgZ(8,"div",7),t.TgZ(9,"label",8),t._uU(10,"Product Name"),t.qZA(),t._UZ(11,"input",9),t.qZA(),t.TgZ(12,"div",7),t.TgZ(13,"label",8),t._uU(14,"Product Code"),t.qZA(),t._UZ(15,"input",10),t.qZA(),t.TgZ(16,"div",7),t.TgZ(17,"label",8),t._uU(18,"Product Type"),t.qZA(),t.TgZ(19,"select",11),t.TgZ(20,"option",12),t._uU(21,"General Insurance"),t.qZA(),t.TgZ(22,"option",13),t._uU(23,"Life Insurance"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(24,"div",5),t.TgZ(25,"div",14),t.TgZ(26,"div",7),t.TgZ(27,"label",15),t._uU(28,"Allow Back Date"),t.qZA(),t.TgZ(29,"mat-radio-group",16),t.TgZ(30,"mat-radio-button",17),t._uU(31,"No"),t.qZA(),t.TgZ(32,"mat-radio-button",18),t._uU(33,"Yes"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(34,"div",14),t.TgZ(35,"div",19),t.TgZ(36,"label",20),t._uU(37,"Stamp Duty"),t.qZA(),t.TgZ(38,"div",21),t.TgZ(39,"span",22),t.TgZ(40,"label"),t._UZ(41,"input",23),t._UZ(42,"span"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(43,N,6,0,"div",24),t.TgZ(44,"div",5),t.TgZ(45,"div",25),t.TgZ(46,"div",7),t.TgZ(47,"label",8),t._uU(48,"Quotation Auto Lapse Rule"),t.qZA(),t._UZ(49,"input",26),t.TgZ(50,"div",27),t._uU(51,"Enter Rule"),t.TgZ(52,"b"),t._uU(53," Period"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(54,"div",25),t.TgZ(55,"div",7),t.TgZ(56,"label",8),t._uU(57,"Period Type"),t.qZA(),t.TgZ(58,"select",28),t.TgZ(59,"option",29),t._uU(60,"Please Select"),t.qZA(),t.TgZ(61,"option",30),t._uU(62,"Days"),t.qZA(),t.TgZ(63,"option",31),t._uU(64,"Months"),t.qZA(),t.qZA(),t.TgZ(65,"div",27),t._uU(66,"Select Rule "),t.TgZ(67,"b"),t._uU(68,"Period Type"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(69,"div",25),t.TgZ(70,"div",7),t.TgZ(71,"label",8),t._uU(72," \xa0"),t.qZA(),t._UZ(73,"input",32),t.qZA(),t.qZA(),t.qZA(),t.TgZ(74,"div",5),t.TgZ(75,"div",25),t.TgZ(76,"div",7),t.TgZ(77,"label",8),t._uU(78,"Application Auto Lapse Rule"),t.qZA(),t._UZ(79,"input",33),t.TgZ(80,"div",27),t._uU(81,"Enter Rule"),t.TgZ(82,"b"),t._uU(83," Period"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(84,"div",25),t.TgZ(85,"div",7),t.TgZ(86,"label",8),t._uU(87,"Period Type"),t.qZA(),t.TgZ(88,"select",34),t.TgZ(89,"option",29),t._uU(90,"Please Select"),t.qZA(),t.TgZ(91,"option",30),t._uU(92,"Days"),t.qZA(),t.TgZ(93,"option",31),t._uU(94,"Months"),t.qZA(),t.qZA(),t.TgZ(95,"div",27),t._uU(96,"Select Rule "),t.TgZ(97,"b"),t._uU(98,"Period Type"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(99,"div",25),t.TgZ(100,"div",7),t.TgZ(101,"label",8),t._uU(102," \xa0"),t.qZA(),t._UZ(103,"input",32),t.qZA(),t.qZA(),t.qZA(),t.TgZ(104,"div",5),t.TgZ(105,"div",35),t.TgZ(106,"div",7),t.TgZ(107,"label",8),t._uU(108,"Product Status"),t.qZA(),t._UZ(109,"ng-select",36),t.qZA(),t.qZA(),t.qZA(),t.TgZ(110,"div",5),t.TgZ(111,"div",6),t.TgZ(112,"div",7),t.TgZ(113,"label",8),t._uU(114,"Upload Product Icon"),t.qZA(),t.TgZ(115,"div",37),t.TgZ(116,"div",38),t.NdJ("click",function(){return o.openFile()}),t.YNc(117,F,1,1,"img",39),t.YNc(118,u,4,0,"ng-container",40),t.TgZ(119,"input",41,42),t.NdJ("change",function(c){return o.handleUpload(c)}),t.qZA(),t.qZA(),t.TgZ(121,"div",38),t.NdJ("click",function(){return o.openFile(!0)}),t.YNc(122,A,1,1,"img",39),t.YNc(123,w,4,0,"ng-container",40),t.TgZ(124,"input",41,43),t.NdJ("change",function(c){return o.handleUpload(c,!0)}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(126,"div",44),t.TgZ(127,"button",45),t.NdJ("click",function(){return o.modal.dismiss()}),t._uU(128,"Cancel"),t.qZA(),t.TgZ(129,"button",46),t.NdJ("click",function(){return o.save()}),t._uU(130,"Save"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(3),t.AsE(" ",o.prodId?"Edit":"Create a new product"," ",o.prodName," "),t.xp6(2),t.Q6J("formGroup",o.formGroup),t.xp6(6),t.ekj("is-invalid",o.isControlInvalid("productName"))("is-valid",o.isControlValid("productName")),t.xp6(4),t.ekj("is-invalid",o.isControlInvalid("productCode"))("is-valid",o.isControlValid("productCode")),t.xp6(4),t.ekj("is-invalid",o.isControlInvalid("type"))("is-valid",o.isControlValid("type")),t.xp6(24),t.Q6J("ngIf","yes"==o.formGroup.value.isAllowBackDate),t.xp6(6),t.ekj("is-invalid",o.isControlInvalid("ruleDate"))("is-valid",o.isControlValid("ruleDate")),t.xp6(9),t.ekj("is-invalid",o.isControlInvalid("ruleType"))("is-valid",o.isControlValid("ruleType")),t.xp6(21),t.ekj("is-invalid",o.isControlInvalid("policyDay"))("is-valid",o.isControlValid("policyDay")),t.xp6(9),t.ekj("is-invalid",o.isControlInvalid("policyRule"))("is-valid",o.isControlValid("policyRule")),t.xp6(21),t.ekj("is-invalid",o.isControlInvalid("statusCd"))("is-valid",o.isControlValid("statusCd")),t.Q6J("items",o.statusCdOption),t.xp6(8),t.Q6J("ngIf",o.formGroup.value.icon),t.xp6(1),t.Q6J("ngIf",!o.formGroup.value.icon),t.xp6(4),t.Q6J("ngIf",o.formGroup.value.smallIcon),t.xp6(1),t.Q6J("ngIf",!o.formGroup.value.smallIcon),t.xp6(6),t.Q6J("disabled",o.formGroup.invalid))},directives:[n._Y,n.JL,n.sg,n.Fj,n.JJ,n.u,n.EJ,n.YN,n.Kr,d.VQ,d.U0,n.Wl,D.O5,n.wV,k.w9],styles:[".upload-icon-group[_ngcontent-%COMP%]{display:flex;grid-gap:10px;gap:10px}.upload-icon[_ngcontent-%COMP%]{display:flex;align-items:center;width:100px;height:100px;border:1px dashed #333;flex-direction:column;justify-content:center;grid-gap:5px;gap:5px;border-radius:10px;overflow:hidden}.upload-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px;height:100px}"]}),a})();var m=s(18510);const S=[{title:"Small Icon",type:m.Y.FEILD,field:"smallIcon",isImg:!0},{title:"Product Name",type:m.Y.FEILD,field:"name"},{title:"Product Code",type:m.Y.FEILD,field:"code"},{title:"Type",type:m.Y.FEILD,field:"type",isTitle:!0},{title:"Allow Back Date",type:m.Y.FEILD,field:"isAllowBackDate",isAllowBackDate:!0},{title:"Quotation Auto Lapse Rule",type:m.Y.FEILD,field:"quotationDay",isQuotationDay:!0},{title:"Application Auto Lapse Rule",type:m.Y.FEILD,field:"policyDay",isPolicyDay:!0},{title:"Status",type:m.Y.FEILD,field:"statusCd",isProdStatus:!0},{title:"Actions",type:m.Y.ACTION,field:"actions",btn:{view:!0,edit:!0}}],x=["smallIcon","name","code","type","isAllowBackDate","quotationDay","policyDay","statusCd","actions"];var I=s(90949),q=s(29018);function R(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"div",9),t.TgZ(1,"button",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().createOrEdit()}),t._UZ(2,"span",11),t.qZA(),t.qZA()}}function P(a,l){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-material-table-view",12),t.NdJ("emitter",function(i){return t.CHM(e),t.oxw().actionBtn(i)}),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("selectable","page"!=e.type)("data",e.products)("colum",e.ELEMENT_COL)("displayedColumns",e.displayedColumns)}}function O(a,l){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",13),t.TgZ(2,"button",14),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeModal()}),t._uU(3,"Cancel"),t.qZA(),t.TgZ(4,"button",15),t.NdJ("click",function(){return t.CHM(e),t.oxw().nextProd()}),t._uU(5,"Next"),t.qZA(),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(4),t.Q6J("disabled",!e.selected.id)}}let r=(()=>{class a{constructor(e,o,i,c){this.modalService=e,this.itemService=o,this.router=i,this.cdRef=c,this.type="page",this.products=[],this.ELEMENT_COL=JSON.parse(JSON.stringify(S)),this.displayedColumns=JSON.parse(JSON.stringify(x)),this.unsubscribe=[],this.show=!1}ngOnInit(){"page"!=this.type&&(this.ELEMENT_COL.splice(8,1),this.displayedColumns.splice(8,1)),this.show=!0,this.getProducts()}ngOnDestroy(){this.unsubscribe.forEach(e=>e.unsubscribe())}editLayout(e){this.itemService.findOne(e.id).toPromise().then(o=>{o&&(this.itemService.createingProd=o,this.itemService.type=e.application?"application":"quotation",this.router.navigateByUrl("/product-form"))})}get selected(){let e;return this.matTable&&(e=this.matTable.selection.selected[0]),e||{id:0}}createOrEdit(e,o){const i=this.modalService.open(L,{size:"xl",backdrop:!1});i.componentInstance.prodId=o,i.componentInstance.oldData=e||{},i.result.then(()=>{},c=>{c&&"save"==c.type&&(this.getProducts(),this.cdRef.detectChanges())})}closeModal(){this.modalService.dismissAll()}nextProd(){this.selected.id&&this.itemService.findOne(this.selected.id).toPromise().then(e=>{e&&this.modalService.dismissAll({data:e,type:"save"})})}getProducts(){this.itemService.getAll().toPromise().then(e=>{e&&(this.products=e,this.cdRef.detectChanges(),this.matTable.reChangeData())})}viewDetail(e){this.itemService.selectedProd=e,this.itemService.viewType="view",this.router.navigateByUrl("/product/products-config/detail")}getFreq(e){let o="",i=e.split(", ");for(const c of i)"lump"==c?o=o.length>2?o+", Lump Sum":"Lump Sum":"annually"==c&&(o=o.length>2?o+", Semi Annually":"Semi Annually");return o}actionBtn(e){"edit"==e.cmd?this.viewDetail(e.data):"view"==e.cmd&&this.editLayout(e.data)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(p.FF),t.Y36(T.f),t.Y36(q.F0),t.Y36(t.sBO))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-products"]],viewQuery:function(e,o){if(1&e&&t.Gf(I.I,5),2&e){let i;t.iGM(i=t.CRH())&&(o.matTable=i.first)}},decls:11,vars:3,consts:[[1,"row"],[1,"col-12"],[1,"card","card-custom"],[1,"card-header"],[1,"card-title"],[1,"card-label","left-border-image"],["class","card-toolbar",4,"ngIf"],[1,"card-body","customer-card-body"],[4,"ngIf"],[1,"card-toolbar"],["type","button",1,"btn","btn-primary","btn-circle",3,"click"],[1,"flaticon2-plus"],[3,"selectable","data","colum","displayedColumns","emitter"],[1,"card-footer"],["type","button",1,"btn","btn-light","btn-elevate","mr-2",3,"click"],["type","button",1,"btn","btn-primary","btn-elevate",3,"disabled","click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"h3",5),t._uU(6,"List of Products"),t.qZA(),t.qZA(),t.YNc(7,R,3,0,"div",6),t.qZA(),t.TgZ(8,"div",7),t.YNc(9,P,2,4,"ng-container",8),t.qZA(),t.YNc(10,O,6,1,"ng-container",8),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(7),t.Q6J("ngIf","page"==o.type),t.xp6(2),t.Q6J("ngIf",o.show),t.xp6(1),t.Q6J("ngIf","page"!=o.type))},directives:[D.O5,I.I],styles:[""]}),a})()},35618:(E,Z,s)=>{s.d(Z,{f:()=>T});var n=s(18260),f=s(91691),v=s(83668),t=s(44522);const p=`${n.N.apiUrl}/product`;let T=(()=>{class h extends f.i{constructor(d){super(d,p),this.httpClient=d,this.referenceID=null,this.creatingLeadId=0,this.referenceStatus=null}getAll(){return this.httpClient.get(p+"-view")}}return h.\u0275fac=function(d){return new(d||h)(v.LFG(t.eN))},h.\u0275prov=v.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()}}]);